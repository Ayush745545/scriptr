import{j as a,u as El,a as ir,m as B,b as Pe,c as xe,d as Na,A as Qt,e as Dl,Q as Al,f as Ml}from"./ui-CclYzoiL.js";import{a as Pl,r as k,g as Fl,R as Ta,N as Ll,u as Oa,O as Ea,L as te,b as Ft,c as Da,d as Rl,e as Il,f as oe,h as Aa,B as Bl}from"./vendor-tC_kDCnY.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();var gi={},hn=Pl;gi.createRoot=hn.createRoot,gi.hydrateRoot=hn.hydrateRoot;let Hl={data:""},zl=i=>{if(typeof window=="object"){let e=(i?i.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(i||document.head).appendChild(e),e.firstChild}return i||Hl},Wl=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Vl=/\/\*[^]*?\*\/|  +/g,dn=/\n+/g,yt=(i,e)=>{let t="",s="",r="";for(let n in i){let o=i[n];n[0]=="@"?n[1]=="i"?t=n+" "+o+";":s+=n[1]=="f"?yt(o,n):n+"{"+yt(o,n[1]=="k"?"":e)+"}":typeof o=="object"?s+=yt(o,e?e.replace(/([^,])+/g,l=>n.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):n):o!=null&&(n=/^--/.test(n)?n:n.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=yt.p?yt.p(n,o):n+":"+o+";")}return t+(e&&r?e+"{"+r+"}":r)+s},et={},Ma=i=>{if(typeof i=="object"){let e="";for(let t in i)e+=t+Ma(i[t]);return e}return i},Ul=(i,e,t,s,r)=>{let n=Ma(i),o=et[n]||(et[n]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(n));if(!et[o]){let c=n!==i?i:(d=>{let h,u,g=[{}];for(;h=Wl.exec(d.replace(Vl,""));)h[4]?g.shift():h[3]?(u=h[3].replace(dn," ").trim(),g.unshift(g[0][u]=g[0][u]||{})):g[0][h[1]]=h[2].replace(dn," ").trim();return g[0]})(i);et[o]=yt(r?{["@keyframes "+o]:c}:c,t?"":"."+o)}let l=t&&et.g?et.g:null;return t&&(et.g=et[o]),((c,d,h,u)=>{u?d.data=d.data.replace(u,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(et[o],e,s,l),o},$l=(i,e,t)=>i.reduce((s,r,n)=>{let o=e[n];if(o&&o.call){let l=o(t),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":yt(l,""):l===!1?"":l}return s+r+(o??"")},"");function Tr(i){let e=this||{},t=i.call?i(e.p):i;return Ul(t.unshift?t.raw?$l(t,[].slice.call(arguments,1),e.p):t.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):t,zl(e.target),e.g,e.o,e.k)}let Pa,mi,pi;Tr.bind({g:1});let lt=Tr.bind({k:1});function Yl(i,e,t,s){yt.p=e,Pa=i,mi=t,pi=s}function wt(i,e){let t=this||{};return function(){let s=arguments;function r(n,o){let l=Object.assign({},n),c=l.className||r.className;t.p=Object.assign({theme:mi&&mi()},l),t.o=/ *go\d+/.test(c),l.className=Tr.apply(t,s)+(c?" "+c:"");let d=i;return i[0]&&(d=l.as||i,delete l.as),pi&&d[0]&&pi(l),Pa(d,l)}return r}}var Xl=i=>typeof i=="function",mr=(i,e)=>Xl(i)?i(e):i,Gl=(()=>{let i=0;return()=>(++i).toString()})(),Fa=(()=>{let i;return()=>{if(i===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");i=!e||e.matches}return i}})(),ql=20,Fi="default",La=(i,e)=>{let{toastLimit:t}=i.settings;switch(e.type){case 0:return{...i,toasts:[e.toast,...i.toasts].slice(0,t)};case 1:return{...i,toasts:i.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:s}=e;return La(i,{type:i.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=e;return{...i,toasts:i.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...i,toasts:[]}:{...i,toasts:i.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...i,pausedAt:e.time};case 6:let n=e.time-(i.pausedAt||0);return{...i,pausedAt:void 0,toasts:i.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+n}))}}},nr=[],Ra={toasts:[],pausedAt:void 0,settings:{toastLimit:ql}},qe={},Ia=(i,e=Fi)=>{qe[e]=La(qe[e]||Ra,i),nr.forEach(([t,s])=>{t===e&&s(qe[e])})},Ba=i=>Object.keys(qe).forEach(e=>Ia(i,e)),Kl=i=>Object.keys(qe).find(e=>qe[e].toasts.some(t=>t.id===i)),Or=(i=Fi)=>e=>{Ia(e,i)},Jl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Ql=(i={},e=Fi)=>{let[t,s]=k.useState(qe[e]||Ra),r=k.useRef(qe[e]);k.useEffect(()=>(r.current!==qe[e]&&s(qe[e]),nr.push([e,s]),()=>{let o=nr.findIndex(([l])=>l===e);o>-1&&nr.splice(o,1)}),[e]);let n=t.toasts.map(o=>{var l,c,d;return{...i,...i[o.type],...o,removeDelay:o.removeDelay||((l=i[o.type])==null?void 0:l.removeDelay)||(i==null?void 0:i.removeDelay),duration:o.duration||((c=i[o.type])==null?void 0:c.duration)||(i==null?void 0:i.duration)||Jl[o.type],style:{...i.style,...(d=i[o.type])==null?void 0:d.style,...o.style}}});return{...t,toasts:n}},Zl=(i,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:i,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Gl()}),bs=i=>(e,t)=>{let s=Zl(e,i,t);return Or(s.toasterId||Kl(s.id))({type:2,toast:s}),s.id},ne=(i,e)=>bs("blank")(i,e);ne.error=bs("error");ne.success=bs("success");ne.loading=bs("loading");ne.custom=bs("custom");ne.dismiss=(i,e)=>{let t={type:3,toastId:i};e?Or(e)(t):Ba(t)};ne.dismissAll=i=>ne.dismiss(void 0,i);ne.remove=(i,e)=>{let t={type:4,toastId:i};e?Or(e)(t):Ba(t)};ne.removeAll=i=>ne.remove(void 0,i);ne.promise=(i,e,t)=>{let s=ne.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof i=="function"&&(i=i()),i.then(r=>{let n=e.success?mr(e.success,r):void 0;return n?ne.success(n,{id:s,...t,...t==null?void 0:t.success}):ne.dismiss(s),r}).catch(r=>{let n=e.error?mr(e.error,r):void 0;n?ne.error(n,{id:s,...t,...t==null?void 0:t.error}):ne.dismiss(s)}),i};var ec=1e3,tc=(i,e="default")=>{let{toasts:t,pausedAt:s}=Ql(i,e),r=k.useRef(new Map).current,n=k.useCallback((u,g=ec)=>{if(r.has(u))return;let p=setTimeout(()=>{r.delete(u),o({type:4,toastId:u})},g);r.set(u,p)},[]);k.useEffect(()=>{if(s)return;let u=Date.now(),g=t.map(p=>{if(p.duration===1/0)return;let m=(p.duration||0)+p.pauseDuration-(u-p.createdAt);if(m<0){p.visible&&ne.dismiss(p.id);return}return setTimeout(()=>ne.dismiss(p.id,e),m)});return()=>{g.forEach(p=>p&&clearTimeout(p))}},[t,s,e]);let o=k.useCallback(Or(e),[e]),l=k.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=k.useCallback((u,g)=>{o({type:1,toast:{id:u,height:g}})},[o]),d=k.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),h=k.useCallback((u,g)=>{let{reverseOrder:p=!1,gutter:m=8,defaultPosition:x}=g||{},f=t.filter(j=>(j.position||x)===(u.position||x)&&j.height),y=f.findIndex(j=>j.id===u.id),w=f.filter((j,T)=>T<y&&j.visible).length;return f.filter(j=>j.visible).slice(...p?[w+1]:[0,w]).reduce((j,T)=>j+(T.height||0)+m,0)},[t]);return k.useEffect(()=>{t.forEach(u=>{if(u.dismissed)n(u.id,u.removeDelay);else{let g=r.get(u.id);g&&(clearTimeout(g),r.delete(u.id))}})},[t,n]),{toasts:t,handlers:{updateHeight:c,startPause:l,endPause:d,calculateOffset:h}}},sc=lt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,rc=lt`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ic=lt`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,nc=wt("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${rc} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${i=>i.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ic} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ac=lt`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,oc=wt("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${i=>i.secondary||"#e0e0e0"};
  border-right-color: ${i=>i.primary||"#616161"};
  animation: ${ac} 1s linear infinite;
`,lc=lt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,cc=lt`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,hc=wt("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${lc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${cc} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${i=>i.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,dc=wt("div")`
  position: absolute;
`,uc=wt("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,gc=lt`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mc=wt("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${gc} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,pc=({toast:i})=>{let{icon:e,type:t,iconTheme:s}=i;return e!==void 0?typeof e=="string"?k.createElement(mc,null,e):e:t==="blank"?null:k.createElement(uc,null,k.createElement(oc,{...s}),t!=="loading"&&k.createElement(dc,null,t==="error"?k.createElement(nc,{...s}):k.createElement(hc,{...s})))},fc=i=>`
0% {transform: translate3d(0,${i*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,xc=i=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${i*-150}%,-1px) scale(.6); opacity:0;}
`,yc="0%{opacity:0;} 100%{opacity:1;}",bc="0%{opacity:1;} 100%{opacity:0;}",vc=wt("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,wc=wt("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,jc=(i,e)=>{let t=i.includes("top")?1:-1,[s,r]=Fa()?[yc,bc]:[fc(t),xc(t)];return{animation:e?`${lt(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${lt(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_c=k.memo(({toast:i,position:e,style:t,children:s})=>{let r=i.height?jc(i.position||e||"top-center",i.visible):{opacity:0},n=k.createElement(pc,{toast:i}),o=k.createElement(wc,{...i.ariaProps},mr(i.message,i));return k.createElement(vc,{className:i.className,style:{...r,...t,...i.style}},typeof s=="function"?s({icon:n,message:o}):k.createElement(k.Fragment,null,n,o))});Yl(k.createElement);var Cc=({id:i,className:e,style:t,onHeightUpdate:s,children:r})=>{let n=k.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(i,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[i,s]);return k.createElement("div",{ref:n,className:e,style:t},r)},Sc=(i,e)=>{let t=i.includes("top"),s=t?{top:0}:{bottom:0},r=i.includes("center")?{justifyContent:"center"}:i.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Fa()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...r}},kc=Tr`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Os=16,Nc=({reverseOrder:i,position:e="top-center",toastOptions:t,gutter:s,children:r,toasterId:n,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:d}=tc(t,n);return k.createElement("div",{"data-rht-toaster":n||"",style:{position:"fixed",zIndex:9999,top:Os,left:Os,right:Os,bottom:Os,pointerEvents:"none",...o},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let u=h.position||e,g=d.calculateOffset(h,{reverseOrder:i,gutter:s,defaultPosition:e}),p=Sc(u,g);return k.createElement(Cc,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?kc:"",style:p},h.type==="custom"?mr(h.message,h):r?r(h):k.createElement(_c,{toast:h,position:u}))}))},X=ne;const Tc={},un=i=>{let e;const t=new Set,s=(h,u)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const p=e;e=u??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(m=>m(e,p))}},r=()=>e,c={setState:s,getState:r,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Tc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=i(s,r,c);return c},Oc=i=>i?un(i):un;var Ha={exports:{}},za={},Wa={exports:{}},Va={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xt=k;function Ec(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Dc=typeof Object.is=="function"?Object.is:Ec,Ac=Xt.useState,Mc=Xt.useEffect,Pc=Xt.useLayoutEffect,Fc=Xt.useDebugValue;function Lc(i,e){var t=e(),s=Ac({inst:{value:t,getSnapshot:e}}),r=s[0].inst,n=s[1];return Pc(function(){r.value=t,r.getSnapshot=e,Xr(r)&&n({inst:r})},[i,t,e]),Mc(function(){return Xr(r)&&n({inst:r}),i(function(){Xr(r)&&n({inst:r})})},[i]),Fc(t),t}function Xr(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Dc(i,t)}catch{return!0}}function Rc(i,e){return e()}var Ic=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Rc:Lc;Va.useSyncExternalStore=Xt.useSyncExternalStore!==void 0?Xt.useSyncExternalStore:Ic;Wa.exports=Va;var Bc=Wa.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Er=k,Hc=Bc;function zc(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Wc=typeof Object.is=="function"?Object.is:zc,Vc=Hc.useSyncExternalStore,Uc=Er.useRef,$c=Er.useEffect,Yc=Er.useMemo,Xc=Er.useDebugValue;za.useSyncExternalStoreWithSelector=function(i,e,t,s,r){var n=Uc(null);if(n.current===null){var o={hasValue:!1,value:null};n.current=o}else o=n.current;n=Yc(function(){function c(p){if(!d){if(d=!0,h=p,p=s(p),r!==void 0&&o.hasValue){var m=o.value;if(r(m,p))return u=m}return u=p}if(m=u,Wc(h,p))return m;var x=s(p);return r!==void 0&&r(m,x)?(h=p,m):(h=p,u=x)}var d=!1,h,u,g=t===void 0?null:t;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,t,s,r]);var l=Vc(i,n[0],n[1]);return $c(function(){o.hasValue=!0,o.value=l},[l]),Xc(l),l};Ha.exports=za;var Gc=Ha.exports;const qc=Fl(Gc),Ua={},{useDebugValue:Kc}=Ta,{useSyncExternalStoreWithSelector:Jc}=qc;let gn=!1;const Qc=i=>i;function Zc(i,e=Qc,t){(Ua?"production":void 0)!=="production"&&t&&!gn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),gn=!0);const s=Jc(i.subscribe,i.getState,i.getServerState||i.getInitialState,e,t);return Kc(s),s}const mn=i=>{(Ua?"production":void 0)!=="production"&&typeof i!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof i=="function"?Oc(i):i,t=(s,r)=>Zc(e,s,r);return Object.assign(t,e),t},eh=i=>i?mn(i):mn,th={};function sh(i,e){let t;try{t=i()}catch{return}return{getItem:r=>{var n;const o=c=>c===null?null:JSON.parse(c,void 0),l=(n=t.getItem(r))!=null?n:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,n)=>t.setItem(r,JSON.stringify(n,void 0)),removeItem:r=>t.removeItem(r)}}const gs=i=>e=>{try{const t=i(e);return t instanceof Promise?t:{then(s){return gs(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return gs(s)(t)}}}},rh=(i,e)=>(t,s,r)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:f=>f,version:0,merge:(f,y)=>({...y,...f}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=n.getStorage()}catch{}if(!d)return i((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),t(...f)},s,r);const h=gs(n.serialize),u=()=>{const f=n.partialize({...s()});let y;const w=h({state:f,version:n.version}).then(j=>d.setItem(n.name,j)).catch(j=>{y=j});if(y)throw y;return w},g=r.setState;r.setState=(f,y)=>{g(f,y),u()};const p=i((...f)=>{t(...f),u()},s,r);let m;const x=()=>{var f;if(!d)return;o=!1,l.forEach(w=>w(s()));const y=((f=n.onRehydrateStorage)==null?void 0:f.call(n,s()))||void 0;return gs(d.getItem.bind(d))(n.name).then(w=>{if(w)return n.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==n.version){if(n.migrate)return n.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var j;return m=n.merge(w,(j=s())!=null?j:p),t(m,!0),u()}).then(()=>{y==null||y(m,void 0),o=!0,c.forEach(w=>w(m))}).catch(w=>{y==null||y(void 0,w)})};return r.persist={setOptions:f=>{n={...n,...f},f.getStorage&&(d=f.getStorage())},clearStorage:()=>{d==null||d.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(c.add(f),()=>{c.delete(f)})},x(),m||p},ih=(i,e)=>(t,s,r)=>{let n={storage:sh(()=>localStorage),partialize:x=>x,version:0,merge:(x,f)=>({...f,...x}),...e},o=!1;const l=new Set,c=new Set;let d=n.storage;if(!d)return i((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),t(...x)},s,r);const h=()=>{const x=n.partialize({...s()});return d.setItem(n.name,{state:x,version:n.version})},u=r.setState;r.setState=(x,f)=>{u(x,f),h()};const g=i((...x)=>{t(...x),h()},s,r);r.getInitialState=()=>g;let p;const m=()=>{var x,f;if(!d)return;o=!1,l.forEach(w=>{var j;return w((j=s())!=null?j:g)});const y=((f=n.onRehydrateStorage)==null?void 0:f.call(n,(x=s())!=null?x:g))||void 0;return gs(d.getItem.bind(d))(n.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==n.version){if(n.migrate)return[!0,n.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var j;const[T,A]=w;if(p=n.merge(A,(j=s())!=null?j:g),t(p,!0),T)return h()}).then(()=>{y==null||y(p,void 0),p=s(),o=!0,c.forEach(w=>w(p))}).catch(w=>{y==null||y(void 0,w)})};return r.persist={setOptions:x=>{n={...n,...x},x.storage&&(d=x.storage)},clearStorage:()=>{d==null||d.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(c.add(x),()=>{c.delete(x)})},n.skipHydration||m(),p||g},nh=(i,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((th?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),rh(i,e)):ih(i,e),ah=nh;function $a(i,e){return function(){return i.apply(e,arguments)}}const{toString:oh}=Object.prototype,{getPrototypeOf:Li}=Object,{iterator:Dr,toStringTag:Ya}=Symbol,Ar=(i=>e=>{const t=oh.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ue=i=>(i=i.toLowerCase(),e=>Ar(e)===i),Mr=i=>e=>typeof e===i,{isArray:Zt}=Array,Gt=Mr("undefined");function vs(i){return i!==null&&!Gt(i)&&i.constructor!==null&&!Gt(i.constructor)&&Se(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const Xa=Ue("ArrayBuffer");function lh(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&Xa(i.buffer),e}const ch=Mr("string"),Se=Mr("function"),Ga=Mr("number"),ws=i=>i!==null&&typeof i=="object",hh=i=>i===!0||i===!1,ar=i=>{if(Ar(i)!=="object")return!1;const e=Li(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Ya in i)&&!(Dr in i)},dh=i=>{if(!ws(i)||vs(i))return!1;try{return Object.keys(i).length===0&&Object.getPrototypeOf(i)===Object.prototype}catch{return!1}},uh=Ue("Date"),gh=Ue("File"),mh=Ue("Blob"),ph=Ue("FileList"),fh=i=>ws(i)&&Se(i.pipe),xh=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||Se(i.append)&&((e=Ar(i))==="formdata"||e==="object"&&Se(i.toString)&&i.toString()==="[object FormData]"))},yh=Ue("URLSearchParams"),[bh,vh,wh,jh]=["ReadableStream","Request","Response","Headers"].map(Ue),_h=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function js(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let s,r;if(typeof i!="object"&&(i=[i]),Zt(i))for(s=0,r=i.length;s<r;s++)e.call(null,i[s],s,i);else{if(vs(i))return;const n=t?Object.getOwnPropertyNames(i):Object.keys(i),o=n.length;let l;for(s=0;s<o;s++)l=n[s],e.call(null,i[l],l,i)}}function qa(i,e){if(vs(i))return null;e=e.toLowerCase();const t=Object.keys(i);let s=t.length,r;for(;s-- >0;)if(r=t[s],e===r.toLowerCase())return r;return null}const Nt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ka=i=>!Gt(i)&&i!==Nt;function fi(){const{caseless:i,skipUndefined:e}=Ka(this)&&this||{},t={},s=(r,n)=>{const o=i&&qa(t,n)||n;ar(t[o])&&ar(r)?t[o]=fi(t[o],r):ar(r)?t[o]=fi({},r):Zt(r)?t[o]=r.slice():(!e||!Gt(r))&&(t[o]=r)};for(let r=0,n=arguments.length;r<n;r++)arguments[r]&&js(arguments[r],s);return t}const Ch=(i,e,t,{allOwnKeys:s}={})=>(js(e,(r,n)=>{t&&Se(r)?Object.defineProperty(i,n,{value:$a(r,t),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(i,n,{value:r,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:s}),i),Sh=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),kh=(i,e,t,s)=>{i.prototype=Object.create(e.prototype,s),Object.defineProperty(i.prototype,"constructor",{value:i,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},Nh=(i,e,t,s)=>{let r,n,o;const l={};if(e=e||{},i==null)return e;do{for(r=Object.getOwnPropertyNames(i),n=r.length;n-- >0;)o=r[n],(!s||s(o,i,e))&&!l[o]&&(e[o]=i[o],l[o]=!0);i=t!==!1&&Li(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},Th=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;const s=i.indexOf(e,t);return s!==-1&&s===t},Oh=i=>{if(!i)return null;if(Zt(i))return i;let e=i.length;if(!Ga(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},Eh=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&Li(Uint8Array)),Dh=(i,e)=>{const s=(i&&i[Dr]).call(i);let r;for(;(r=s.next())&&!r.done;){const n=r.value;e.call(i,n[0],n[1])}},Ah=(i,e)=>{let t;const s=[];for(;(t=i.exec(e))!==null;)s.push(t);return s},Mh=Ue("HTMLFormElement"),Ph=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,r){return s.toUpperCase()+r}),pn=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),Fh=Ue("RegExp"),Ja=(i,e)=>{const t=Object.getOwnPropertyDescriptors(i),s={};js(t,(r,n)=>{let o;(o=e(r,n,i))!==!1&&(s[n]=o||r)}),Object.defineProperties(i,s)},Lh=i=>{Ja(i,(e,t)=>{if(Se(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=i[t];if(Se(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Rh=(i,e)=>{const t={},s=r=>{r.forEach(n=>{t[n]=!0})};return Zt(i)?s(i):s(String(i).split(e)),t},Ih=()=>{},Bh=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e;function Hh(i){return!!(i&&Se(i.append)&&i[Ya]==="FormData"&&i[Dr])}const zh=i=>{const e=new Array(10),t=(s,r)=>{if(ws(s)){if(e.indexOf(s)>=0)return;if(vs(s))return s;if(!("toJSON"in s)){e[r]=s;const n=Zt(s)?[]:{};return js(s,(o,l)=>{const c=t(o,r+1);!Gt(c)&&(n[l]=c)}),e[r]=void 0,n}}return s};return t(i,0)},Wh=Ue("AsyncFunction"),Vh=i=>i&&(ws(i)||Se(i))&&Se(i.then)&&Se(i.catch),Qa=((i,e)=>i?setImmediate:e?((t,s)=>(Nt.addEventListener("message",({source:r,data:n})=>{r===Nt&&n===t&&s.length&&s.shift()()},!1),r=>{s.push(r),Nt.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Se(Nt.postMessage)),Uh=typeof queueMicrotask<"u"?queueMicrotask.bind(Nt):typeof process<"u"&&process.nextTick||Qa,$h=i=>i!=null&&Se(i[Dr]),S={isArray:Zt,isArrayBuffer:Xa,isBuffer:vs,isFormData:xh,isArrayBufferView:lh,isString:ch,isNumber:Ga,isBoolean:hh,isObject:ws,isPlainObject:ar,isEmptyObject:dh,isReadableStream:bh,isRequest:vh,isResponse:wh,isHeaders:jh,isUndefined:Gt,isDate:uh,isFile:gh,isBlob:mh,isRegExp:Fh,isFunction:Se,isStream:fh,isURLSearchParams:yh,isTypedArray:Eh,isFileList:ph,forEach:js,merge:fi,extend:Ch,trim:_h,stripBOM:Sh,inherits:kh,toFlatObject:Nh,kindOf:Ar,kindOfTest:Ue,endsWith:Th,toArray:Oh,forEachEntry:Dh,matchAll:Ah,isHTMLForm:Mh,hasOwnProperty:pn,hasOwnProp:pn,reduceDescriptors:Ja,freezeMethods:Lh,toObjectSet:Rh,toCamelCase:Ph,noop:Ih,toFiniteNumber:Bh,findKey:qa,global:Nt,isContextDefined:Ka,isSpecCompliantForm:Hh,toJSONObject:zh,isAsyncFn:Wh,isThenable:Vh,setImmediate:Qa,asap:Uh,isIterable:$h};let z=class Za extends Error{static from(e,t,s,r,n,o){const l=new Za(e.message,t||e.code,s,r,n);return l.cause=e,l.name=e.name,o&&Object.assign(l,o),l}constructor(e,t,s,r,n){super(e),this.name="AxiosError",this.isAxiosError=!0,t&&(this.code=t),s&&(this.config=s),r&&(this.request=r),n&&(this.response=n,this.status=n.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:S.toJSONObject(this.config),code:this.code,status:this.status}}};z.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";z.ERR_BAD_OPTION="ERR_BAD_OPTION";z.ECONNABORTED="ECONNABORTED";z.ETIMEDOUT="ETIMEDOUT";z.ERR_NETWORK="ERR_NETWORK";z.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";z.ERR_DEPRECATED="ERR_DEPRECATED";z.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";z.ERR_BAD_REQUEST="ERR_BAD_REQUEST";z.ERR_CANCELED="ERR_CANCELED";z.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";z.ERR_INVALID_URL="ERR_INVALID_URL";const Yh=null;function xi(i){return S.isPlainObject(i)||S.isArray(i)}function eo(i){return S.endsWith(i,"[]")?i.slice(0,-2):i}function fn(i,e,t){return i?i.concat(e).map(function(r,n){return r=eo(r),!t&&n?"["+r+"]":r}).join(t?".":""):e}function Xh(i){return S.isArray(i)&&!i.some(xi)}const Gh=S.toFlatObject(S,{},null,function(e){return/^is[A-Z]/.test(e)});function Pr(i,e,t){if(!S.isObject(i))throw new TypeError("target must be an object");e=e||new FormData,t=S.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,f){return!S.isUndefined(f[x])});const s=t.metaTokens,r=t.visitor||h,n=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&S.isSpecCompliantForm(e);if(!S.isFunction(r))throw new TypeError("visitor must be a function");function d(m){if(m===null)return"";if(S.isDate(m))return m.toISOString();if(S.isBoolean(m))return m.toString();if(!c&&S.isBlob(m))throw new z("Blob is not supported. Use a Buffer instead.");return S.isArrayBuffer(m)||S.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function h(m,x,f){let y=m;if(m&&!f&&typeof m=="object"){if(S.endsWith(x,"{}"))x=s?x:x.slice(0,-2),m=JSON.stringify(m);else if(S.isArray(m)&&Xh(m)||(S.isFileList(m)||S.endsWith(x,"[]"))&&(y=S.toArray(m)))return x=eo(x),y.forEach(function(j,T){!(S.isUndefined(j)||j===null)&&e.append(o===!0?fn([x],T,n):o===null?x:x+"[]",d(j))}),!1}return xi(m)?!0:(e.append(fn(f,x,n),d(m)),!1)}const u=[],g=Object.assign(Gh,{defaultVisitor:h,convertValue:d,isVisitable:xi});function p(m,x){if(!S.isUndefined(m)){if(u.indexOf(m)!==-1)throw Error("Circular reference detected in "+x.join("."));u.push(m),S.forEach(m,function(y,w){(!(S.isUndefined(y)||y===null)&&r.call(e,y,S.isString(w)?w.trim():w,x,g))===!0&&p(y,x?x.concat(w):[w])}),u.pop()}}if(!S.isObject(i))throw new TypeError("data must be an object");return p(i),e}function xn(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Ri(i,e){this._pairs=[],i&&Pr(i,this,e)}const to=Ri.prototype;to.append=function(e,t){this._pairs.push([e,t])};to.toString=function(e){const t=e?function(s){return e.call(this,s,xn)}:xn;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function qh(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function so(i,e,t){if(!e)return i;const s=t&&t.encode||qh,r=S.isFunction(t)?{serialize:t}:t,n=r&&r.serialize;let o;if(n?o=n(e,r):o=S.isURLSearchParams(e)?e.toString():new Ri(e,r).toString(s),o){const l=i.indexOf("#");l!==-1&&(i=i.slice(0,l)),i+=(i.indexOf("?")===-1?"?":"&")+o}return i}class yn{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){S.forEach(this.handlers,function(s){s!==null&&e(s)})}}const ro={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Kh=typeof URLSearchParams<"u"?URLSearchParams:Ri,Jh=typeof FormData<"u"?FormData:null,Qh=typeof Blob<"u"?Blob:null,Zh={isBrowser:!0,classes:{URLSearchParams:Kh,FormData:Jh,Blob:Qh},protocols:["http","https","file","blob","url","data"]},Ii=typeof window<"u"&&typeof document<"u",yi=typeof navigator=="object"&&navigator||void 0,ed=Ii&&(!yi||["ReactNative","NativeScript","NS"].indexOf(yi.product)<0),td=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",sd=Ii&&window.location.href||"http://localhost",rd=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ii,hasStandardBrowserEnv:ed,hasStandardBrowserWebWorkerEnv:td,navigator:yi,origin:sd},Symbol.toStringTag,{value:"Module"})),be={...rd,...Zh};function id(i,e){return Pr(i,new be.classes.URLSearchParams,{visitor:function(t,s,r,n){return be.isNode&&S.isBuffer(t)?(this.append(s,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...e})}function nd(i){return S.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ad(i){const e={},t=Object.keys(i);let s;const r=t.length;let n;for(s=0;s<r;s++)n=t[s],e[n]=i[n];return e}function io(i){function e(t,s,r,n){let o=t[n++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=n>=t.length;return o=!o&&S.isArray(r)?r.length:o,c?(S.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!l):((!r[o]||!S.isObject(r[o]))&&(r[o]=[]),e(t,s,r[o],n)&&S.isArray(r[o])&&(r[o]=ad(r[o])),!l)}if(S.isFormData(i)&&S.isFunction(i.entries)){const t={};return S.forEachEntry(i,(s,r)=>{e(nd(s),r,t,0)}),t}return null}function od(i,e,t){if(S.isString(i))try{return(e||JSON.parse)(i),S.trim(i)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(i)}const _s={transitional:ro,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",r=s.indexOf("application/json")>-1,n=S.isObject(e);if(n&&S.isHTMLForm(e)&&(e=new FormData(e)),S.isFormData(e))return r?JSON.stringify(io(e)):e;if(S.isArrayBuffer(e)||S.isBuffer(e)||S.isStream(e)||S.isFile(e)||S.isBlob(e)||S.isReadableStream(e))return e;if(S.isArrayBufferView(e))return e.buffer;if(S.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(n){if(s.indexOf("application/x-www-form-urlencoded")>-1)return id(e,this.formSerializer).toString();if((l=S.isFileList(e))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Pr(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return n||r?(t.setContentType("application/json",!1),od(e)):e}],transformResponse:[function(e){const t=this.transitional||_s.transitional,s=t&&t.forcedJSONParsing,r=this.responseType==="json";if(S.isResponse(e)||S.isReadableStream(e))return e;if(e&&S.isString(e)&&(s&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?z.from(l,z.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:be.classes.FormData,Blob:be.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};S.forEach(["delete","get","head","post","put","patch"],i=>{_s.headers[i]={}});const ld=S.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cd=i=>{const e={};let t,s,r;return i&&i.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!t||e[t]&&ld[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},bn=Symbol("internals");function as(i){return i&&String(i).trim().toLowerCase()}function or(i){return i===!1||i==null?i:S.isArray(i)?i.map(or):String(i)}function hd(i){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(i);)e[s[1]]=s[2];return e}const dd=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function Gr(i,e,t,s,r){if(S.isFunction(s))return s.call(this,e,t);if(r&&(e=t),!!S.isString(e)){if(S.isString(s))return e.indexOf(s)!==-1;if(S.isRegExp(s))return s.test(e)}}function ud(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function gd(i,e){const t=S.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(i,s+t,{value:function(r,n,o){return this[s].call(this,e,r,n,o)},configurable:!0})})}let ke=class{constructor(e){e&&this.set(e)}set(e,t,s){const r=this;function n(l,c,d){const h=as(c);if(!h)throw new Error("header name must be a non-empty string");const u=S.findKey(r,h);(!u||r[u]===void 0||d===!0||d===void 0&&r[u]!==!1)&&(r[u||c]=or(l))}const o=(l,c)=>S.forEach(l,(d,h)=>n(d,h,c));if(S.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(S.isString(e)&&(e=e.trim())&&!dd(e))o(cd(e),t);else if(S.isObject(e)&&S.isIterable(e)){let l={},c,d;for(const h of e){if(!S.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[d=h[0]]=(c=l[d])?S.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(l,t)}else e!=null&&n(t,e,s);return this}get(e,t){if(e=as(e),e){const s=S.findKey(this,e);if(s){const r=this[s];if(!t)return r;if(t===!0)return hd(r);if(S.isFunction(t))return t.call(this,r,s);if(S.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=as(e),e){const s=S.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||Gr(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let r=!1;function n(o){if(o=as(o),o){const l=S.findKey(s,o);l&&(!t||Gr(s,s[l],l,t))&&(delete s[l],r=!0)}}return S.isArray(e)?e.forEach(n):n(e),r}clear(e){const t=Object.keys(this);let s=t.length,r=!1;for(;s--;){const n=t[s];(!e||Gr(this,this[n],n,e,!0))&&(delete this[n],r=!0)}return r}normalize(e){const t=this,s={};return S.forEach(this,(r,n)=>{const o=S.findKey(s,n);if(o){t[o]=or(r),delete t[n];return}const l=e?ud(n):String(n).trim();l!==n&&delete t[n],t[l]=or(r),s[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return S.forEach(this,(s,r)=>{s!=null&&s!==!1&&(t[r]=e&&S.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[bn]=this[bn]={accessors:{}}).accessors,r=this.prototype;function n(o){const l=as(o);s[l]||(gd(r,o),s[l]=!0)}return S.isArray(e)?e.forEach(n):n(e),this}};ke.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);S.reduceDescriptors(ke.prototype,({value:i},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(s){this[t]=s}}});S.freezeMethods(ke);function qr(i,e){const t=this||_s,s=e||t,r=ke.from(s.headers);let n=s.data;return S.forEach(i,function(l){n=l.call(t,n,r.normalize(),e?e.status:void 0)}),r.normalize(),n}function no(i){return!!(i&&i.__CANCEL__)}let Cs=class extends z{constructor(e,t,s){super(e??"canceled",z.ERR_CANCELED,t,s),this.name="CanceledError",this.__CANCEL__=!0}};function ao(i,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?i(t):e(new z("Request failed with status code "+t.status,[z.ERR_BAD_REQUEST,z.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function md(i){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function pd(i,e){i=i||10;const t=new Array(i),s=new Array(i);let r=0,n=0,o;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),h=s[n];o||(o=d),t[r]=c,s[r]=d;let u=n,g=0;for(;u!==r;)g+=t[u++],u=u%i;if(r=(r+1)%i,r===n&&(n=(n+1)%i),d-o<e)return;const p=h&&d-h;return p?Math.round(g*1e3/p):void 0}}function fd(i,e){let t=0,s=1e3/e,r,n;const o=(d,h=Date.now())=>{t=h,r=null,n&&(clearTimeout(n),n=null),i(...d)};return[(...d)=>{const h=Date.now(),u=h-t;u>=s?o(d,h):(r=d,n||(n=setTimeout(()=>{n=null,o(r)},s-u)))},()=>r&&o(r)]}const pr=(i,e,t=3)=>{let s=0;const r=pd(50,250);return fd(n=>{const o=n.loaded,l=n.lengthComputable?n.total:void 0,c=o-s,d=r(c),h=o<=l;s=o;const u={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&h?(l-o)/d:void 0,event:n,lengthComputable:l!=null,[e?"download":"upload"]:!0};i(u)},t)},vn=(i,e)=>{const t=i!=null;return[s=>e[0]({lengthComputable:t,total:i,loaded:s}),e[1]]},wn=i=>(...e)=>S.asap(()=>i(...e)),xd=be.hasStandardBrowserEnv?((i,e)=>t=>(t=new URL(t,be.origin),i.protocol===t.protocol&&i.host===t.host&&(e||i.port===t.port)))(new URL(be.origin),be.navigator&&/(msie|trident)/i.test(be.navigator.userAgent)):()=>!0,yd=be.hasStandardBrowserEnv?{write(i,e,t,s,r,n,o){if(typeof document>"u")return;const l=[`${i}=${encodeURIComponent(e)}`];S.isNumber(t)&&l.push(`expires=${new Date(t).toUTCString()}`),S.isString(s)&&l.push(`path=${s}`),S.isString(r)&&l.push(`domain=${r}`),n===!0&&l.push("secure"),S.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(i){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+i+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(i){this.write(i,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function bd(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function vd(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function oo(i,e,t){let s=!bd(e);return i&&(s||t==!1)?vd(i,e):e}const jn=i=>i instanceof ke?{...i}:i;function At(i,e){e=e||{};const t={};function s(d,h,u,g){return S.isPlainObject(d)&&S.isPlainObject(h)?S.merge.call({caseless:g},d,h):S.isPlainObject(h)?S.merge({},h):S.isArray(h)?h.slice():h}function r(d,h,u,g){if(S.isUndefined(h)){if(!S.isUndefined(d))return s(void 0,d,u,g)}else return s(d,h,u,g)}function n(d,h){if(!S.isUndefined(h))return s(void 0,h)}function o(d,h){if(S.isUndefined(h)){if(!S.isUndefined(d))return s(void 0,d)}else return s(void 0,h)}function l(d,h,u){if(u in e)return s(d,h);if(u in i)return s(void 0,d)}const c={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,h,u)=>r(jn(d),jn(h),u,!0)};return S.forEach(Object.keys({...i,...e}),function(h){const u=c[h]||r,g=u(i[h],e[h],h);S.isUndefined(g)&&u!==l||(t[h]=g)}),t}const lo=i=>{const e=At({},i);let{data:t,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:n,headers:o,auth:l}=e;if(e.headers=o=ke.from(o),e.url=so(oo(e.baseURL,e.url,e.allowAbsoluteUrls),i.params,i.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),S.isFormData(t)){if(be.hasStandardBrowserEnv||be.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(S.isFunction(t.getHeaders)){const c=t.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([h,u])=>{d.includes(h.toLowerCase())&&o.set(h,u)})}}if(be.hasStandardBrowserEnv&&(s&&S.isFunction(s)&&(s=s(e)),s||s!==!1&&xd(e.url))){const c=r&&n&&yd.read(n);c&&o.set(r,c)}return e},wd=typeof XMLHttpRequest<"u",jd=wd&&function(i){return new Promise(function(t,s){const r=lo(i);let n=r.data;const o=ke.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=r,h,u,g,p,m;function x(){p&&p(),m&&m(),r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}let f=new XMLHttpRequest;f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout;function y(){if(!f)return;const j=ke.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),A={data:!l||l==="text"||l==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:j,config:i,request:f};ao(function(N){t(N),x()},function(N){s(N),x()},A),f=null}"onloadend"in f?f.onloadend=y:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(y)},f.onabort=function(){f&&(s(new z("Request aborted",z.ECONNABORTED,i,f)),f=null)},f.onerror=function(T){const A=T&&T.message?T.message:"Network Error",P=new z(A,z.ERR_NETWORK,i,f);P.event=T||null,s(P),f=null},f.ontimeout=function(){let T=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const A=r.transitional||ro;r.timeoutErrorMessage&&(T=r.timeoutErrorMessage),s(new z(T,A.clarifyTimeoutError?z.ETIMEDOUT:z.ECONNABORTED,i,f)),f=null},n===void 0&&o.setContentType(null),"setRequestHeader"in f&&S.forEach(o.toJSON(),function(T,A){f.setRequestHeader(A,T)}),S.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),l&&l!=="json"&&(f.responseType=r.responseType),d&&([g,m]=pr(d,!0),f.addEventListener("progress",g)),c&&f.upload&&([u,p]=pr(c),f.upload.addEventListener("progress",u),f.upload.addEventListener("loadend",p)),(r.cancelToken||r.signal)&&(h=j=>{f&&(s(!j||j.type?new Cs(null,i,f):j),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const w=md(r.url);if(w&&be.protocols.indexOf(w)===-1){s(new z("Unsupported protocol "+w+":",z.ERR_BAD_REQUEST,i));return}f.send(n||null)})},_d=(i,e)=>{const{length:t}=i=i?i.filter(Boolean):[];if(e||t){let s=new AbortController,r;const n=function(d){if(!r){r=!0,l();const h=d instanceof Error?d:this.reason;s.abort(h instanceof z?h:new Cs(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,n(new z(`timeout of ${e}ms exceeded`,z.ETIMEDOUT))},e);const l=()=>{i&&(o&&clearTimeout(o),o=null,i.forEach(d=>{d.unsubscribe?d.unsubscribe(n):d.removeEventListener("abort",n)}),i=null)};i.forEach(d=>d.addEventListener("abort",n));const{signal:c}=s;return c.unsubscribe=()=>S.asap(l),c}},Cd=function*(i,e){let t=i.byteLength;if(t<e){yield i;return}let s=0,r;for(;s<t;)r=s+e,yield i.slice(s,r),s=r},Sd=async function*(i,e){for await(const t of kd(i))yield*Cd(t,e)},kd=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const e=i.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},_n=(i,e,t,s)=>{const r=Sd(i,e);let n=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await r.next();if(d){l(),c.close();return}let u=h.byteLength;if(t){let g=n+=u;t(g)}c.enqueue(new Uint8Array(h))}catch(d){throw l(d),d}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},Cn=64*1024,{isFunction:Es}=S,Nd=(({Request:i,Response:e})=>({Request:i,Response:e}))(S.global),{ReadableStream:Sn,TextEncoder:kn}=S.global,Nn=(i,...e)=>{try{return!!i(...e)}catch{return!1}},Td=i=>{i=S.merge.call({skipUndefined:!0},Nd,i);const{fetch:e,Request:t,Response:s}=i,r=e?Es(e):typeof fetch=="function",n=Es(t),o=Es(s);if(!r)return!1;const l=r&&Es(Sn),c=r&&(typeof kn=="function"?(m=>x=>m.encode(x))(new kn):async m=>new Uint8Array(await new t(m).arrayBuffer())),d=n&&l&&Nn(()=>{let m=!1;const x=new t(be.origin,{body:new Sn,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!x}),h=o&&l&&Nn(()=>S.isReadableStream(new s("").body)),u={stream:h&&(m=>m.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!u[m]&&(u[m]=(x,f)=>{let y=x&&x[m];if(y)return y.call(x);throw new z(`Response type '${m}' is not supported`,z.ERR_NOT_SUPPORT,f)})});const g=async m=>{if(m==null)return 0;if(S.isBlob(m))return m.size;if(S.isSpecCompliantForm(m))return(await new t(be.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(S.isArrayBufferView(m)||S.isArrayBuffer(m))return m.byteLength;if(S.isURLSearchParams(m)&&(m=m+""),S.isString(m))return(await c(m)).byteLength},p=async(m,x)=>{const f=S.toFiniteNumber(m.getContentLength());return f??g(x)};return async m=>{let{url:x,method:f,data:y,signal:w,cancelToken:j,timeout:T,onDownloadProgress:A,onUploadProgress:P,responseType:N,headers:E,withCredentials:D="same-origin",fetchOptions:R}=lo(m),O=e||fetch;N=N?(N+"").toLowerCase():"text";let W=_d([w,j&&j.toAbortSignal()],T),C=null;const M=W&&W.unsubscribe&&(()=>{W.unsubscribe()});let U;try{if(P&&d&&f!=="get"&&f!=="head"&&(U=await p(E,y))!==0){let G=new t(x,{method:"POST",body:y,duplex:"half"}),ee;if(S.isFormData(y)&&(ee=G.headers.get("content-type"))&&E.setContentType(ee),G.body){const[de,se]=vn(U,pr(wn(P)));y=_n(G.body,Cn,de,se)}}S.isString(D)||(D=D?"include":"omit");const $=n&&"credentials"in t.prototype,Q={...R,signal:W,method:f.toUpperCase(),headers:E.normalize().toJSON(),body:y,duplex:"half",credentials:$?D:void 0};C=n&&new t(x,Q);let H=await(n?O(C,R):O(x,Q));const F=h&&(N==="stream"||N==="response");if(h&&(A||F&&M)){const G={};["status","statusText","headers"].forEach(pe=>{G[pe]=H[pe]});const ee=S.toFiniteNumber(H.headers.get("content-length")),[de,se]=A&&vn(ee,pr(wn(A),!0))||[];H=new s(_n(H.body,Cn,de,()=>{se&&se(),M&&M()}),G)}N=N||"text";let V=await u[S.findKey(u,N)||"text"](H,m);return!F&&M&&M(),await new Promise((G,ee)=>{ao(G,ee,{data:V,headers:ke.from(H.headers),status:H.status,statusText:H.statusText,config:m,request:C})})}catch($){throw M&&M(),$&&$.name==="TypeError"&&/Load failed|fetch/i.test($.message)?Object.assign(new z("Network Error",z.ERR_NETWORK,m,C),{cause:$.cause||$}):z.from($,$&&$.code,m,C)}}},Od=new Map,co=i=>{let e=i&&i.env||{};const{fetch:t,Request:s,Response:r}=e,n=[s,r,t];let o=n.length,l=o,c,d,h=Od;for(;l--;)c=n[l],d=h.get(c),d===void 0&&h.set(c,d=l?new Map:Td(e)),h=d;return d};co();const Bi={http:Yh,xhr:jd,fetch:{get:co}};S.forEach(Bi,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});const Tn=i=>`- ${i}`,Ed=i=>S.isFunction(i)||i===null||i===!1;function Dd(i,e){i=S.isArray(i)?i:[i];const{length:t}=i;let s,r;const n={};for(let o=0;o<t;o++){s=i[o];let l;if(r=s,!Ed(s)&&(r=Bi[(l=String(s)).toLowerCase()],r===void 0))throw new z(`Unknown adapter '${l}'`);if(r&&(S.isFunction(r)||(r=r.get(e))))break;n[l||"#"+o]=r}if(!r){const o=Object.entries(n).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=t?o.length>1?`since :
`+o.map(Tn).join(`
`):" "+Tn(o[0]):"as no adapter specified";throw new z("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r}const ho={getAdapter:Dd,adapters:Bi};function Kr(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new Cs(null,i)}function On(i){return Kr(i),i.headers=ke.from(i.headers),i.data=qr.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),ho.getAdapter(i.adapter||_s.adapter,i)(i).then(function(s){return Kr(i),s.data=qr.call(i,i.transformResponse,s),s.headers=ke.from(s.headers),s},function(s){return no(s)||(Kr(i),s&&s.response&&(s.response.data=qr.call(i,i.transformResponse,s.response),s.response.headers=ke.from(s.response.headers))),Promise.reject(s)})}const uo="1.13.4",Fr={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{Fr[i]=function(s){return typeof s===i||"a"+(e<1?"n ":" ")+i}});const En={};Fr.transitional=function(e,t,s){function r(n,o){return"[Axios v"+uo+"] Transitional option '"+n+"'"+o+(s?". "+s:"")}return(n,o,l)=>{if(e===!1)throw new z(r(o," has been removed"+(t?" in "+t:"")),z.ERR_DEPRECATED);return t&&!En[o]&&(En[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(n,o,l):!0}};Fr.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function Ad(i,e,t){if(typeof i!="object")throw new z("options must be an object",z.ERR_BAD_OPTION_VALUE);const s=Object.keys(i);let r=s.length;for(;r-- >0;){const n=s[r],o=e[n];if(o){const l=i[n],c=l===void 0||o(l,n,i);if(c!==!0)throw new z("option "+n+" must be "+c,z.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new z("Unknown option "+n,z.ERR_BAD_OPTION)}}const lr={assertOptions:Ad,validators:Fr},Ye=lr.validators;let Et=class{constructor(e){this.defaults=e||{},this.interceptors={request:new yn,response:new yn}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const n=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?n&&!String(s.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+n):s.stack=n}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=At(this.defaults,t);const{transitional:s,paramsSerializer:r,headers:n}=t;s!==void 0&&lr.assertOptions(s,{silentJSONParsing:Ye.transitional(Ye.boolean),forcedJSONParsing:Ye.transitional(Ye.boolean),clarifyTimeoutError:Ye.transitional(Ye.boolean)},!1),r!=null&&(S.isFunction(r)?t.paramsSerializer={serialize:r}:lr.assertOptions(r,{encode:Ye.function,serialize:Ye.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),lr.assertOptions(t,{baseUrl:Ye.spelling("baseURL"),withXsrfToken:Ye.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=n&&S.merge(n.common,n[t.method]);n&&S.forEach(["delete","get","head","post","put","patch","common"],m=>{delete n[m]}),t.headers=ke.concat(o,n);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(t)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let h,u=0,g;if(!c){const m=[On.bind(this),void 0];for(m.unshift(...l),m.push(...d),g=m.length,h=Promise.resolve(t);u<g;)h=h.then(m[u++],m[u++]);return h}g=l.length;let p=t;for(;u<g;){const m=l[u++],x=l[u++];try{p=m(p)}catch(f){x.call(this,f);break}}try{h=On.call(this,p)}catch(m){return Promise.reject(m)}for(u=0,g=d.length;u<g;)h=h.then(d[u++],d[u++]);return h}getUri(e){e=At(this.defaults,e);const t=oo(e.baseURL,e.url,e.allowAbsoluteUrls);return so(t,e.params,e.paramsSerializer)}};S.forEach(["delete","get","head","options"],function(e){Et.prototype[e]=function(t,s){return this.request(At(s||{},{method:e,url:t,data:(s||{}).data}))}});S.forEach(["post","put","patch"],function(e){function t(s){return function(n,o,l){return this.request(At(l||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Et.prototype[e]=t(),Et.prototype[e+"Form"]=t(!0)});let Md=class go{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(n){t=n});const s=this;this.promise.then(r=>{if(!s._listeners)return;let n=s._listeners.length;for(;n-- >0;)s._listeners[n](r);s._listeners=null}),this.promise.then=r=>{let n;const o=new Promise(l=>{s.subscribe(l),n=l}).then(r);return o.cancel=function(){s.unsubscribe(n)},o},e(function(n,o,l){s.reason||(s.reason=new Cs(n,o,l),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new go(function(r){e=r}),cancel:e}}};function Pd(i){return function(t){return i.apply(null,t)}}function Fd(i){return S.isObject(i)&&i.isAxiosError===!0}const bi={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(bi).forEach(([i,e])=>{bi[e]=i});function mo(i){const e=new Et(i),t=$a(Et.prototype.request,e);return S.extend(t,Et.prototype,e,{allOwnKeys:!0}),S.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return mo(At(i,r))},t}const he=mo(_s);he.Axios=Et;he.CanceledError=Cs;he.CancelToken=Md;he.isCancel=no;he.VERSION=uo;he.toFormData=Pr;he.AxiosError=z;he.Cancel=he.CanceledError;he.all=function(e){return Promise.all(e)};he.spread=Pd;he.isAxiosError=Fd;he.mergeConfig=At;he.AxiosHeaders=ke;he.formToJSON=i=>io(S.isHTMLForm(i)?new FormData(i):i);he.getAdapter=ho.getAdapter;he.HttpStatusCode=bi;he.default=he;const{Axios:Kf,AxiosError:Jf,CanceledError:Qf,isCancel:Zf,CancelToken:ex,VERSION:tx,all:sx,Cancel:rx,isAxiosError:ix,spread:nx,toFormData:ax,AxiosHeaders:ox,HttpStatusCode:lx,formToJSON:cx,getAdapter:hx,mergeConfig:dx}=he,Ld="http://localhost:8000/api/v1",I=he.create({baseURL:Ld,headers:{"Content-Type":"application/json"}});I.interceptors.request.use(i=>{const e=at.getState().accessToken;return e&&(i.headers.Authorization=`Bearer ${e}`),i},i=>Promise.reject(i));I.interceptors.response.use(i=>i,async i=>{var t;const e=i.config;if(((t=i.response)==null?void 0:t.status)===401&&!e._retry){e._retry=!0;try{await at.getState().refreshAccessToken();const s=at.getState().accessToken;if(s)return e.headers.Authorization=`Bearer ${s}`,I(e)}catch{at.getState().logout()}}return Promise.reject(i)});const po={generate:i=>I.post("/scripts/generate",i),list:i=>I.get("/scripts",{params:i}),get:i=>I.get(`/scripts/${i}`),update:(i,e)=>I.patch(`/scripts/${i}`,e),delete:i=>I.delete(`/scripts/${i}`),regenerate:i=>I.post(`/scripts/${i}/regenerate`)},Rd={generate:i=>I.post("/scripts/enhanced/generate",i),getExamples:()=>I.get("/scripts/enhanced/examples"),getLanguages:()=>I.get("/scripts/enhanced/languages"),getTones:()=>I.get("/scripts/enhanced/tones"),getContentTypes:()=>I.get("/scripts/enhanced/content-types")},Ht={getStyles:()=>I.get("/captions/styles"),generate:i=>I.post("/captions/generate",i),upload:(i,e)=>I.post("/captions/upload",i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e}),burn:(i,e)=>I.post(`/captions/${i}/burn`,null,{params:e}),list:i=>I.get("/captions",{params:i}),get:i=>I.get(`/captions/${i}`),update:(i,e)=>I.patch(`/captions/${i}`,e),export:(i,e)=>I.post(`/captions/${i}/export`,e),delete:i=>I.delete(`/captions/${i}`)},xt={list:i=>I.get("/templates",{params:i}),featured:()=>I.get("/templates/featured"),categories:()=>I.get("/templates/categories"),festivals:()=>I.get("/templates/festivals"),get:i=>I.get(`/templates/${i}`),definition:i=>I.get(`/templates/${i}/definition`),uploadAsset:i=>{const e=new FormData;return e.append("file",i),I.post("/templates/assets/upload",e,{headers:{"Content-Type":"multipart/form-data"}})},use:(i,e)=>I.post(`/templates/${i}/use`,e),render:i=>I.post("/templates/render",i),renderStatus:i=>I.get(`/templates/render/${i}/status`)},qt={generate:i=>I.post("/thumbnails/generate",i),uploadFace:i=>I.post("/thumbnails/upload-face",i,{headers:{"Content-Type":"multipart/form-data"}}),list:i=>I.get("/thumbnails",{params:i}),get:i=>I.get(`/thumbnails/${i}`),update:(i,e)=>I.patch(`/thumbnails/${i}`,e),createVariant:(i,e)=>I.post(`/thumbnails/${i}/variant`,e),variants:i=>I.get(`/thumbnails/${i}/variants`),download:i=>I.post(`/thumbnails/${i}/download`),delete:i=>I.delete(`/thumbnails/${i}`),formulas:()=>I.get("/thumbnails/meta/formulas"),fonts:i=>I.get("/thumbnails/meta/fonts",{params:i?{script:i}:{}}),downloadCoreFonts:()=>I.post("/thumbnails/meta/fonts/download"),stickerSuggestions:i=>I.get("/thumbnails/meta/sticker-suggestions",{params:{niche:i}}),editorRender:i=>I.post("/thumbnails/editor/render",i),uploadBackground:i=>I.post("/thumbnails/upload-background",i,{headers:{"Content-Type":"multipart/form-data"}})},Kt={generate:i=>I.post("/hooks/generate",i),templates:i=>I.get("/hooks/templates",{params:i}),types:()=>I.get("/hooks/types"),trending:()=>I.get("/hooks/trending"),leaderboard:i=>I.get("/hooks/leaderboard",{params:i?{limit:i}:{}}),vote:(i,e)=>I.post(`/hooks/${i}/vote`,e),trackUsage:i=>I.post(`/hooks/use/${i}`),history:i=>I.get("/hooks/history",{params:i})},Dn={create:i=>I.post("/projects",i),list:i=>I.get("/projects",{params:i}),get:i=>I.get(`/projects/${i}`),content:i=>I.get(`/projects/${i}/content`),update:(i,e)=>I.patch(`/projects/${i}`,e),delete:i=>I.delete(`/projects/${i}`)},Id={};function An(){const i=Id;return(i==null?void 0:i.VITE_UI_ONLY)==="true"||(i==null?void 0:i.VITE_MOCK_AUTH)==="true"}function Ds(i){return`${i}.${Math.random().toString(36).slice(2)}.${Date.now()}`}function Bd(i){return{id:`mock_${Date.now()}_${Math.random().toString(16).slice(2)}`,email:i.email,full_name:i.full_name,display_name:i.display_name,avatar_url:void 0,preferred_language:i.preferred_language||"hinglish",subscription_tier:"free",credits_remaining:999}}function Hd(i){return{id:`mock_${Date.now()}_${Math.random().toString(16).slice(2)}`,email:i,full_name:"Test User",display_name:void 0,avatar_url:void 0,preferred_language:"hinglish",subscription_tier:"free",credits_remaining:999}}const at=eh()(ah((i,e)=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isLoading:!1,login:async(t,s)=>{i({isLoading:!0});try{const r=await I.post("/auth/login",{email:t,password:s}),{access_token:n,refresh_token:o}=r.data;i({accessToken:n,refreshToken:o,isAuthenticated:!0});const l=await I.get("/users/me");i({user:l.data})}catch(r){if(An())i({accessToken:Ds("mock_access"),refreshToken:Ds("mock_refresh"),isAuthenticated:!0,user:Hd(t)});else throw r}finally{i({isLoading:!1})}},register:async t=>{i({isLoading:!0});try{await I.post("/auth/register",t),await e().login(t.email,t.password)}catch(s){if(An())i({accessToken:Ds("mock_access"),refreshToken:Ds("mock_refresh"),isAuthenticated:!0,user:Bd(t)});else throw s}finally{i({isLoading:!1})}},logout:()=>{i({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1})},refreshAccessToken:async()=>{const{refreshToken:t}=e();if(!t){e().logout();return}try{const s=await I.post("/auth/refresh",{refresh_token:t});i({accessToken:s.data.access_token})}catch{e().logout()}},updateUser:t=>{const{user:s}=e();s&&i({user:{...s,...t}})}}),{name:"contentkaro-auth",partialize:i=>({accessToken:i.accessToken,refreshToken:i.refreshToken,isAuthenticated:i.isAuthenticated,user:i.user})}));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=(...i)=>i.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=i=>{const e=Wd(i);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Vd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=k.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:r="",children:n,iconNode:o,...l},c)=>k.createElement("svg",{ref:c,...Vd,width:e,height:e,stroke:i,strokeWidth:s?Number(t)*24/Number(e):t,className:fo("lucide",r),...!n&&!Ud(l)&&{"aria-hidden":"true"},...l},[...o.map(([d,h])=>k.createElement(d,h)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=(i,e)=>{const t=k.forwardRef(({className:s,...r},n)=>k.createElement($d,{ref:n,iconNode:e,className:fo(`lucide-${zd(Mn(i))}`,`lucide-${i}`,s),...r}));return t.displayName=Mn(i),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Hi=K("arrow-right",Yd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Gd=K("bell",Xd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]],xo=K("captions",qd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],yo=K("check",Kd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Qd=K("chevron-down",Jd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],eu=K("chevron-right",Zd);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],bo=K("clock",tu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],ru=K("cloud-upload",su);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nu=K("download",iu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ou=K("ellipsis",au);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cu=K("eye",lu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z",key:"1tzo1f"}]],du=K("file-play",hu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],vo=K("file-text",uu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mu=K("folder",gu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],wo=K("image",pu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],xu=K("languages",fu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],bu=K("layout-dashboard",yu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],wu=K("layout-template",vu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],jo=K("loader-circle",ju);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Cu=K("message-square",_u);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],zi=K("play",Su);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Nu=K("plus",ku);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Ou=K("rocket",Tu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_o=K("search",Eu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Co=K("sparkles",Du);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Pn=K("star",Au);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Pu=K("upload",Mu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Lu=K("video",Fu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Iu=K("wand-sparkles",Ru);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Hu=K("x",Bu);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Wi=K("zap",zu),Wu=[{icon:bu,label:"Dashboard",subLabel:"",path:"/"},{icon:vo,label:"Scripts",subLabel:"",path:"/scripts"},{icon:xo,label:"Captions",subLabel:"",path:"/captions"},{icon:wu,label:"Templates",subLabel:"",path:"/templates"},{icon:wo,label:"Thumbnails",subLabel:"",path:"/thumbnails"},{icon:Wi,label:"Hooks",subLabel:"",path:"/hooks"},{icon:mu,label:"Projects",subLabel:"",path:"/projects"}];function Vu({variant:i="desktop"}){const[e,t]=k.useState(!1);return a.jsxs("aside",{className:`fixed left-0 top-0 h-screen z-50 transition-all duration-300 ease-in-out border-r border-white/10 ${e?"w-[280px]":"w-[80px]"}`,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),children:[a.jsx("div",{className:"absolute inset-0 bg-surface/60 backdrop-blur-xl"}),a.jsxs("div",{className:"relative z-10 flex flex-col h-full py-6",children:[a.jsxs("div",{className:`flex items-center px-4 mb-10 ${e?"justify-start":"justify-center"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent flex items-center justify-center shadow-lg shadow-accent/20",children:a.jsx("span",{className:"text-white font-bold text-xl",children:"B"})}),a.jsx("div",{className:`ml-3 transition-opacity duration-300 ${e?"opacity-100":"opacity-0 w-0 overflow-hidden"}`,children:a.jsx("h1",{className:"text-white font-display font-bold text-xl",children:"Bolo"})})]}),a.jsx("nav",{className:"flex-1 px-3 space-y-2",children:Wu.map(s=>a.jsx(Ll,{to:s.path,className:({isActive:r})=>`
                relative flex items-center px-3 py-3 rounded-xl transition-all duration-200 group
                ${r?"bg-white/10 text-white shadow-lg shadow-black/5":"text-text-secondary hover:text-white hover:bg-white/5"}
              `,children:({isActive:r})=>a.jsxs(a.Fragment,{children:[r&&a.jsx("div",{className:"absolute left-0 w-1 h-8 bg-accent rounded-r-full shadow-[0_0_10px_rgba(255,149,0,0.5)]"}),a.jsx("div",{className:`flex flex-col items-center justify-center w-10 h-10 transition-transform duration-200 ${r?"scale-110":"group-hover:scale-110"}`,children:a.jsx(s.icon,{size:24,strokeWidth:1.5,className:r?"text-accent drop-shadow-[0_0_8px_rgba(255,149,0,0.5)]":""})}),a.jsx("div",{className:`ml-3 whitespace-nowrap overflow-hidden transition-all duration-300 ${e?"opacity-100 w-auto":"opacity-0 w-0"}`,children:a.jsxs("div",{className:"flex flex-col justify-center items-start",children:[a.jsx("span",{className:"font-medium text-sm leading-tight text-white",children:s.label}),a.jsx("span",{className:"text-[10px] text-text-tertiary leading-tight font-hindi mt-0.5",children:s.subLabel})]})}),r&&e&&a.jsx("div",{className:"absolute right-3 w-1.5 h-1.5 rounded-full bg-accent shadow-[0_0_8px_rgba(255,149,0,0.8)]"})]})},s.path))}),a.jsx("div",{className:"mt-auto px-4",children:a.jsxs("div",{className:`bg-white/5 rounded-2xl p-2 flex items-center transition-all duration-300 border border-white/5 ${e?"justify-start":"justify-center"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-purple-500 to-blue-500 flex items-center justify-center shrink-0",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"AK"})}),a.jsxs("div",{className:`ml-3 overflow-hidden transition-all duration-300 ${e?"opacity-100":"opacity-0 w-0"}`,children:[a.jsx("p",{className:"text-sm font-medium text-white",children:"Ayush Kumar"}),a.jsx("p",{className:"text-xs text-text-tertiary",children:"Pro Plan"})]})]})})]})]})}function Uu({title:i="Dashboard"}){const[e,t]=k.useState(!1);return k.useEffect(()=>{const s=()=>{t(window.scrollY>20)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]),a.jsxs("header",{className:`fixed top-0 right-0 left-0 z-40 h-[60px] flex items-center justify-between px-8 transition-all duration-300 ${e?"bg-background/80 backdrop-blur-xl border-b border-white/10 shadow-sm":"bg-transparent"}`,style:{paddingLeft:"calc(80px + 2rem)"},children:[a.jsx("div",{className:"flex items-center",children:a.jsx("h1",{className:`text-xl font-display font-semibold text-white transition-opacity duration-300 ${e?"opacity-100":"opacity-0"}`,children:i})}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:`relative group transition-all duration-300 ${e?"w-64":"w-10 hover:w-64"}`,children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(_o,{size:18,className:"text-text-tertiary group-hover:text-white transition-colors"})}),a.jsx("input",{type:"text",className:`
              block w-full pl-10 pr-3 py-2 border border-transparent rounded-full leading-5 
              text-white placeholder-text-tertiary focus:outline-none focus:bg-white/10
              focus:border-white/20 focus:placeholder-white/50 sm:text-sm transition-all duration-300
              ${e?"bg-white/5":"bg-transparent hover:bg-white/5 cursor-pointer focus:cursor-text"}
            `,placeholder:e?"Search...":""})]}),a.jsxs("button",{className:"relative p-2 text-text-tertiary hover:text-white transition-colors duration-200 rounded-full hover:bg-white/10",children:[a.jsx(Gd,{size:20}),a.jsx("span",{className:"absolute top-2 right-2 block h-2 w-2 rounded-full bg-accent ring-2 ring-background transform translate-x-1/2 -translate-y-1/2"})]})]})]})}function $u(){const i=Oa(),e=()=>{switch(i.pathname){case"/":return"Dashboard";case"/scripts":return"Scripts";case"/captions":return"Captions";case"/templates":return"Templates";case"/thumbnails":return"Thumbnails";case"/hooks":return"Hooks";case"/projects":return"Projects";default:return"Dashboard"}};return a.jsxs("div",{className:"min-h-screen bg-background text-text-primary selection:bg-accent/30 font-sans",children:[a.jsx(Vu,{}),a.jsx(Uu,{title:e()}),a.jsx("main",{className:"pl-[80px] pt-[80px] min-h-screen transition-all duration-300",children:a.jsx("div",{className:"max-w-[1400px] mx-auto px-8 pb-12 animate-fade-in",children:a.jsx(Ea,{})})}),a.jsxs("div",{className:"fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none",children:[a.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] rounded-full bg-purple-900/10 blur-[120px]"}),a.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] rounded-full bg-blue-900/10 blur-[120px]"}),a.jsx("div",{className:"absolute top-[40%] left-[30%] w-[30%] h-[30%] rounded-full bg-accent/5 blur-[100px]"})]})]})}function Yu(){return a.jsxs("div",{className:"min-h-screen bg-background flex",children:[a.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative flex-col justify-between p-12 overflow-hidden bg-surface border-r border-white/10",children:[a.jsx("div",{className:"absolute inset-0 bg-accent/5"}),a.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top_left,_var(--tw-gradient-stops))] from-accent/20 via-background to-background opacity-40"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs(te,{to:"/",className:"flex items-center gap-3 mb-12",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent flex items-center justify-center shadow-lg shadow-accent/20",children:a.jsx("span",{className:"text-white font-bold text-xl",children:"B"})}),a.jsx("span",{className:"text-2xl font-bold text-white tracking-tight font-display",children:"Bolo"})]}),a.jsxs("div",{className:"space-y-6 max-w-lg mt-20",children:[a.jsxs("h1",{className:"text-5xl font-bold text-white leading-[1.1] tracking-tight font-display",children:["Create Viral Canvases ",a.jsx("br",{}),a.jsx("span",{className:"text-gradient-accent",children:"in seconds."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xl text-white/80 font-medium",children:"    AI "}),a.jsx("p",{className:"text-lg text-text-secondary",children:"AI-Powered Tools for Indian Creators"})]})]})]}),a.jsx("div",{className:"relative z-10",children:a.jsxs("div",{className:"glass-card p-6 rounded-2xl border-white/10 max-w-md",children:[a.jsx("p",{className:"text-white/90 text-lg font-medium italic mb-4 leading-relaxed",children:'"Bolo changed how I write scripts. It understands Hinglish perfectly!"'}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-purple-500 to-blue-500"}),a.jsxs("div",{className:"text-white/80 text-sm",children:[a.jsx("div",{className:"font-semibold text-white",children:"Rahul Sharma"}),a.jsx("div",{className:"text-text-tertiary",children:"YouTuber (1.2M Subs)"})]})]})]})})]}),a.jsxs("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-8 relative",children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:a.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-accent/5 rounded-full blur-[100px] opacity-50"})}),a.jsxs("div",{className:"w-full max-w-md relative z-10",children:[a.jsx(Ea,{}),a.jsx("div",{className:"mt-8 text-center space-y-2",children:a.jsxs("p",{className:"text-sm text-text-tertiary",children:["Create content in ",a.jsx("span",{className:"text-white/80",children:"Hindi"}),", ",a.jsx("span",{className:"text-white/80",children:"English"}),", or ",a.jsx("span",{className:"text-white/80",children:"Hinglish"})]})})]})]})]})}function Xu(){const[i,e]=k.useState(null),{scrollY:t}=El(),s=ir(t,[0,300],[1,0]),r=n=>{e(i===n?null:n)};return a.jsxs("div",{className:"min-h-screen bg-apple-bg text-apple-text-primary font-sans selection:bg-apple-accent/30",children:[a.jsx("nav",{className:"fixed top-0 inset-x-0 z-50 transition-all duration-300 border-b border-white/5 bg-black/50 backdrop-blur-xl",children:a.jsxs("div",{className:"container mx-auto px-6 h-[60px] flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex items-center justify-center w-8 h-8",children:[a.jsx("div",{className:"absolute inset-0 bg-apple-accent/20 blur-lg rounded-full"}),a.jsx(Ou,{size:20,className:"text-apple-accent relative z-10"})]}),a.jsx("span",{className:"text-lg font-bold tracking-tight text-white",children:"Bolo"})]}),a.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[a.jsx("a",{href:"#features",className:"text-sm font-medium text-white/70 hover:text-white transition-colors",children:"Features"}),a.jsx("a",{href:"#pricing",className:"text-sm font-medium text-white/70 hover:text-white transition-colors",children:"Pricing"}),a.jsx(te,{to:"/login",className:"text-sm font-medium text-white/70 hover:text-white transition-colors",children:"Login"}),a.jsx(te,{to:"/register",className:"px-4 py-1.5 rounded-full bg-white text-black text-sm font-medium hover:bg-white/90 transition-all hover:scale-105",children:"Get Started"})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(te,{to:"/register",className:"px-4 py-2 rounded-full bg-white text-black text-xs font-bold",children:"Start"})})]})}),a.jsxs("header",{className:"relative pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] bg-apple-accent/20 rounded-[100%] blur-[120px] opacity-30 pointer-events-none"}),a.jsx("div",{className:"absolute top-20 right-0 w-[500px] h-[500px] bg-purple-500/10 rounded-[100%] blur-[100px] opacity-30 pointer-events-none"}),a.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[a.jsxs(B.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},style:{opacity:s},children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 mb-8 rounded-full bg-white/5 border border-white/10 backdrop-blur-md",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-apple-success animate-pulse"}),a.jsx("span",{className:"text-xs font-medium text-white/80 tracking-wide uppercase",children:"Made in India for Creators"})]}),a.jsxs("h1",{className:"text-5xl md:text-7xl lg:text-8xl font-semibold tracking-tighter text-white mb-6 leading-[1.1]",children:["Create Viral Reels ",a.jsx("br",{className:"hidden md:block"}),a.jsx("span",{className:"bg-gradient-to-r from-apple-accent to-red-500 bg-clip-text text-transparent",children:"in seconds."})]}),a.jsxs("p",{className:"text-xl md:text-2xl text-white/60 mb-10 max-w-2xl mx-auto font-normal leading-relaxed",children:["Script, hooks, captions, and editing  automated. ",a.jsx("br",{}),"Focus on content, leave the rest to AI."]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-24",children:[a.jsxs(te,{to:"/register",className:"group relative w-full sm:w-auto px-8 py-4 rounded-full bg-white text-black font-semibold text-lg hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2",children:[a.jsx("span",{children:"Start Creating Free"}),a.jsx(Hi,{size:18,className:"group-hover:translate-x-1 transition-transform"})]}),a.jsxs("button",{onClick:()=>{var n;return(n=document.getElementById("demo"))==null?void 0:n.scrollIntoView({behavior:"smooth"})},className:"w-full sm:w-auto px-8 py-4 rounded-full bg-white/10 text-white font-medium text-lg border border-white/10 hover:bg-white/20 transition-all backdrop-blur-md flex items-center justify-center gap-2",children:[a.jsx(zi,{size:18,fill:"currentColor"}),a.jsx("span",{children:"Watch Demo"})]})]})]}),a.jsx("div",{id:"demo",className:"relative mx-auto max-w-6xl aspect-video rounded-3xl bg-[#1C1C1E] border border-white/10 shadow-2xl overflow-hidden group",children:a.jsx("video",{src:"/vedio/demo.mp4",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"})})]})]}),a.jsxs("section",{className:"py-32 bg-black relative",children:[a.jsx("div",{className:"absolute top-1/2 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-white/10 to-transparent"}),a.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[a.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-20",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-semibold mb-6 tracking-tight",children:"Creator Burnout is Real."}),a.jsx("p",{className:"text-xl text-white/50",children:"Stop wasting hours on technical tasks. Create more, edit less."})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[{icon:bo,title:"Editing takes hours",desc:"Finding clips, adding captions, and syncing music shouldn't take 4 hours for a 30s reel."},{icon:Wi,title:"Trends move fast",desc:"By the time you edit manually, the trend is gone. Speed is the key to going viral."},{icon:Cu,title:"Writer's Block",desc:"Staring at a blank screen? Get unlimited viral scripts and hooks instantly."}].map((n,o)=>a.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:o*.1},className:"bg-apple-surface p-8 rounded-3xl border border-white/5 hover:border-white/10 transition-colors group",children:[a.jsx("div",{className:"w-14 h-14 bg-white/5 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300 border border-white/5",children:a.jsx(n.icon,{size:28,className:"text-apple-accent"})}),a.jsx("h3",{className:"text-xl font-semibold mb-3 text-white",children:n.title}),a.jsx("p",{className:"text-white/50 leading-relaxed",children:n.desc})]},o))})]})]}),a.jsx("section",{id:"features",className:"py-32 bg-apple-bg overflow-hidden",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-20",children:[a.jsx("span",{className:"text-apple-accent font-medium tracking-widest text-xs uppercase mb-4 block",children:"Workflow"}),a.jsxs("h2",{className:"text-4xl md:text-6xl font-semibold tracking-tight",children:["From Idea to Viral ",a.jsx("br",{}),a.jsx("span",{className:"text-white/40",children:"in 4 Simple Steps"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl mx-auto",children:[{title:"Script Idea",desc:"Enter a topic, get a viral script in Hinglish.",icon:""},{title:"Add Captions",desc:"Auto-generated flashy captions like top creators.",icon:""},{title:"Pick Template",desc:"Choose from 20+ viral visual styles.",icon:""},{title:"Export",desc:"Download HD video ready to post everywhere.",icon:""}].map((n,o)=>a.jsxs("div",{className:"bg-black p-8 rounded-[32px] border border-white/10 relative overflow-hidden group hover:border-apple-accent/30 transition-colors",children:[a.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 font-bold text-8xl leading-none select-none group-hover:opacity-20 transition-opacity",children:o+1}),a.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-end min-h-[240px]",children:[a.jsx("div",{className:"text-4xl mb-6",children:n.icon}),a.jsx("h3",{className:"text-2xl font-bold mb-2 text-white",children:n.title}),a.jsx("p",{className:"text-white/50",children:n.desc})]})]},o))})]})}),a.jsx("section",{className:"py-32 bg-black border-t border-white/5",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-semibold mb-4",children:"Trusted by 5,000+ Creators"}),a.jsx("p",{className:"text-white/50",children:"Join the community building the future of content."})]}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto",children:[{name:"Mumbai Cafe",role:"Local Business  12k",text:"My cafe sales increased 30% after I started posting daily reels using Bolo. The captions are a lifesaver!",color:"bg-blue-500"},{name:"Priya Fitness",role:"Influencer  45k",text:"The hooks generator is crazy good. My views went from 2k avg to 15k avg in just two weeks.",color:"bg-pink-500"},{name:"Rahul Tech",role:"Reviewer  2k",text:"Finally a tool that understands Hinglish properly. Script writing used to take me hours, now it's done in minutes.",color:"bg-green-500"}].map((n,o)=>a.jsxs("div",{className:"bg-apple-surface p-8 rounded-3xl border border-white/5 flex flex-col justify-between",children:[a.jsxs("p",{className:"text-white/80 text-lg leading-relaxed mb-8",children:['"',n.text,'"']}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-full ${n.color} flex items-center justify-center text-white font-bold text-sm`,children:n.name[0]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-white text-sm",children:n.name}),a.jsx("p",{className:"text-xs text-white/40",children:n.role})]})]})]},o))})]})}),a.jsx("section",{id:"pricing",className:"py-32 bg-apple-bg",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[a.jsx("h2",{className:"text-4xl md:text-5xl font-semibold text-white mb-4",children:"Pricing"}),a.jsx("p",{className:"text-white/50 text-xl",children:"Professional tools, pocket-friendly price."})]}),a.jsxs("div",{className:"max-w-md mx-auto relative group",children:[a.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-apple-accent to-red-500 rounded-[34px] blur opacity-20 group-hover:opacity-40 transition duration-1000"}),a.jsxs("div",{className:"relative bg-apple-surface rounded-[32px] p-10 border border-white/10 hover:border-white/20 transition-all",children:[a.jsxs("div",{className:"flex justify-between items-start mb-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-white",children:"Pro Creator"}),a.jsx("p",{className:"text-white/40 text-sm mt-1",children:"Everything you need to grow."})]}),a.jsx("span",{className:"bg-apple-accent/10 text-apple-accent text-xs font-bold px-3 py-1 rounded-full border border-apple-accent/20",children:"POPULAR"})]}),a.jsxs("div",{className:"flex items-baseline text-white mb-2",children:[a.jsx("span",{className:"text-5xl font-bold tracking-tight",children:"299"}),a.jsx("span",{className:"ml-2 text-xl text-white/40",children:"/month"})]}),a.jsx("p",{className:"text-sm text-white/30 mb-8",children:"Cancel anytime. No hidden fees."}),a.jsx("div",{className:"space-y-4 mb-10",children:["Unlimited Hinglish Scripts","AI Caption Generator","Viral Hook Library","HD Export (1080p)","No Watermark","Commercial License"].map(n=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center",children:a.jsx(yo,{size:12,className:"text-green-500"})}),a.jsx("span",{className:"text-white/80 font-medium",children:n})]},n))}),a.jsx(te,{to:"/register",className:"block w-full bg-white text-black rounded-xl py-4 text-center font-bold hover:bg-gray-200 transition-colors",children:"Start Pro Trial"})]})]})]})}),a.jsx("section",{className:"py-24 bg-black border-t border-white/5",children:a.jsxs("div",{className:"container mx-auto px-4 max-w-3xl",children:[a.jsx("h2",{className:"text-3xl font-semibold text-center mb-12 text-white",children:"Questions?"}),a.jsx("div",{className:"space-y-4",children:[{q:"Does it support Hindi & Hinglish?",a:"Haan bilkul! Our AI is specifically trained on Indian content data, so it writes authentic Hinglish scripts and captions that connect with local audiences."},{q:"Can I use it on my phone?",a:"Yes! The website is 100% mobile-friendly. You can create scripts and edit straight from your phone browser."},{q:"Is there a money-back guarantee?",a:"We offer a 7-day refund policy. If you dont like the pro plan, just email us and we will refund 299 instantly. No questions asked."}].map((n,o)=>a.jsxs("div",{className:"bg-apple-surface rounded-2xl border border-white/5 overflow-hidden",children:[a.jsxs("button",{onClick:()=>r(o),className:"w-full flex justify-between items-center p-6 text-left font-medium text-white hover:bg-white/5 transition",children:[a.jsx("span",{children:n.q}),a.jsx(Qd,{className:`transform transition-transform text-white/40 ${i===o?"rotate-180":""}`})]}),i===o&&a.jsx("div",{className:"px-6 pb-6 text-white/60 text-sm leading-relaxed border-t border-white/5 pt-4",children:n.a})]},o))})]})}),a.jsx("footer",{className:"py-12 bg-black text-white/40 border-t border-white/5 text-sm",children:a.jsxs("div",{className:"container mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-bold text-white",children:"Bolo"}),a.jsx("span",{children:" 2026"})]}),a.jsxs("div",{className:"flex gap-8",children:[a.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Privacy"}),a.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Terms"}),a.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Twitter"}),a.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Instagram"})]})]})})]})}const Gu=[{icon:"",title:"Script Generator",titleHi:" ",description:"AI-powered scripts in Hindi, English, or Hinglish for reels, shorts, and more"},{icon:"",title:"Auto Captions",titleHi:" ",description:"Accurate transcription with support for Indian languages and accents"},{icon:"",title:"Reel Templates",titleHi:" ",description:"10+ templates for festivals, food, fitness, business, and lifestyle content"},{icon:"",title:"Thumbnail Creator",titleHi:" ",description:"Eye-catching thumbnails with Hindi text and AI backgrounds"},{icon:"",title:"Viral Hooks",titleHi:" ",description:"Attention-grabbing hooks that work for Indian audiences"},{icon:"",title:"Project Management",titleHi:" ",description:"Organize all your content in one place"}],qu={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Ku={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Ju(){return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("header",{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-background"}),a.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-accent/10 rounded-full blur-[120px] opacity-30"}),a.jsx("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-blue-500/10 rounded-full blur-[120px] opacity-30"})]}),a.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 lg:py-32",children:[a.jsxs("nav",{className:"flex items-center justify-between mb-16",children:[a.jsx("span",{className:"text-2xl font-bold font-display text-white",children:"Bolo"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(te,{to:"/login",className:"text-text-secondary hover:text-white transition-colors",children:"Login"}),a.jsx(te,{to:"/register",className:"px-6 py-2.5 rounded-full bg-white text-black font-semibold hover:bg-white/90 transition-all",children:"Get Started Free"})]})]}),a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsxs(B.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-5xl lg:text-7xl font-bold text-white mb-6 font-display tracking-tight",children:["Create Viral Content",a.jsx("span",{className:"block text-gradient-accent mt-2",children:"For Indian Audiences"})]}),a.jsx(B.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"text-xl text-text-secondary mb-4",children:"AI-powered tools to create scripts, captions, thumbnails, and more in Hindi, English, or Hinglish"}),a.jsx(B.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.15},className:"text-lg text-white/80 font-hindi mb-8",children:", ,     "}),a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[a.jsx(te,{to:"/register",className:"px-8 py-3.5 rounded-full bg-accent text-white font-bold hover:bg-accent/90 transition-all shadow-[0_0_20px_rgba(255,149,0,0.4)]",children:"Start Creating Free "}),a.jsxs("a",{href:"#features",className:"text-text-secondary hover:text-white transition-colors flex items-center",children:["See Features",a.jsx("svg",{className:"w-5 h-5 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})]})]})]}),a.jsx("section",{id:"features",className:"py-24 bg-surface/30",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold text-white mb-4",children:"Everything You Need to Create Content"}),a.jsx("p",{className:"text-lg text-text-secondary max-w-2xl mx-auto",children:"Built specifically for Indian content creators with support for local languages and cultural themes"})]}),a.jsx(B.div,{variants:qu,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-100px"},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:Gu.map((i,e)=>a.jsxs(B.div,{variants:Ku,className:"glass-card rounded-2xl p-6 hover:bg-white/5 transition-all",children:[a.jsx("div",{className:"text-4xl mb-4",children:i.icon}),a.jsx("h3",{className:"text-xl font-semibold text-white mb-1",children:i.title}),a.jsx("p",{className:"text-sm text-accent mb-3 font-hindi",children:i.titleHi}),a.jsx("p",{className:"text-text-secondary",children:i.description})]},e))})]})}),a.jsx("section",{className:"py-24 bg-black",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("div",{className:"text-center mb-16",children:a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold text-white mb-4",children:"Create Content in Your Language"})}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[a.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center p-8 rounded-2xl bg-surface border border-white/10 hover:border-accent/40 transition-colors",children:[a.jsx("h3",{className:"text-6xl font-bold text-white font-hindi mb-4",children:""}),a.jsx("p",{className:"text-lg font-medium text-white",children:"Hindi"}),a.jsx("p",{className:"text-text-secondary mt-2",children:"Pure Hindi scripts and captions with proper Unicode support"})]}),a.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.1},className:"text-center p-8 rounded-2xl bg-surface border border-white/10 hover:border-blue-500/40 transition-colors",children:[a.jsx("h3",{className:"text-6xl font-bold text-white mb-4",children:"ABC"}),a.jsx("p",{className:"text-lg font-medium text-white",children:"English"}),a.jsx("p",{className:"text-text-secondary mt-2",children:"Professional English content for global audiences"})]}),a.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2},className:"text-center p-8 rounded-2xl bg-surface border border-white/10 hover:border-pink-500/40 transition-colors",children:[a.jsxs("h3",{className:"text-4xl font-bold text-accent mb-4",children:[a.jsx("span",{className:"font-hindi",children:""}),"lish"]}),a.jsx("p",{className:"text-lg font-medium text-white",children:"Hinglish"}),a.jsx("p",{className:"text-text-secondary mt-2",children:"Mix of Hindi and English that resonates with young Indians"})]})]})]})}),a.jsxs("section",{className:"py-24 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-accent/10"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent"}),a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10",children:[a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold text-white mb-4",children:"Ready to Create Viral Content?"}),a.jsx("p",{className:"text-xl text-white/70 mb-8",children:"Join thousands of Indian creators already using Bolo"}),a.jsxs(te,{to:"/register",className:"inline-flex items-center px-8 py-4 bg-white text-black font-bold rounded-full hover:scale-105 transition-transform",children:["Get Started Free",a.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})]}),a.jsx("footer",{className:"bg-black text-text-tertiary py-12 border-t border-white/5",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[a.jsxs("div",{className:"mb-4 md:mb-0",children:[a.jsx("span",{className:"text-xl font-bold text-white",children:"Bolo"}),a.jsx("p",{className:"text-sm mt-1",children:"AI-powered content creation for India"})]}),a.jsxs("div",{className:"flex items-center space-x-6",children:[a.jsx(te,{to:"/login",className:"hover:text-white transition-colors",children:"Login"}),a.jsx(te,{to:"/register",className:"hover:text-white transition-colors",children:"Sign Up"})]})]}),a.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 text-center text-sm",children:a.jsxs("p",{children:[" ",new Date().getFullYear()," Bolo. Made with  for Indian Creators"]})})]})})]})}function Qu(){const[i,e]=k.useState(""),[t,s]=k.useState(""),[r,n]=k.useState(!1),{login:o}=at(),l=Ft(),c=!1,d=async h=>{h.preventDefault(),n(!0);try{await o(i,t),X.success("Welcome back!"),l("/dashboard")}catch(u){const g=u instanceof Error?u.message:"Login failed. Please try again.";X.error(g)}finally{n(!1)}};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Sign in to continue creating content"}),a.jsxs("form",{onSubmit:d,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{id:"email",type:"email",value:i,onChange:h=>e(h.target.value),required:!0,className:"input-field",placeholder:"your@email.com"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsx(te,{to:"/forgot-password",className:"text-sm text-primary-600 hover:text-primary-700",children:"Forgot password?"})]}),a.jsx("input",{id:"password",type:"password",value:t,onChange:h=>s(h.target.value),required:!0,className:"input-field",placeholder:""})]}),c,a.jsx("button",{type:"submit",disabled:r,className:"btn-primary w-full py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:r?a.jsxs("span",{className:"flex items-center justify-center",children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",a.jsx(te,{to:"/register",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Sign up free"})]})}),a.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-gray-500 text-center",children:[a.jsx("span",{className:"font-medium",children:"Tip:"})," In dev, use Autofill random for quick testing"]})})]})}function Zu(){const[i,e]=k.useState(""),[t,s]=k.useState(""),[r,n]=k.useState(""),[o,l]=k.useState(""),[c,d]=k.useState("hinglish"),[h,u]=k.useState(!1),{register:g}=at(),p=Ft(),m=!1,x=async f=>{if(f.preventDefault(),r!==o){X.error("Passwords do not match");return}if(r.length<8){X.error("Password must be at least 8 characters");return}u(!0);try{await g({email:t,password:r,full_name:i,preferred_language:c}),X.success("Account created successfully!"),p("/dashboard")}catch(y){const w=y instanceof Error?y.message:"Registration failed. Please try again.";X.error(w)}finally{u(!1)}};return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create Your Account"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Start creating viral content today"}),a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),a.jsx("input",{id:"fullName",type:"text",value:i,onChange:f=>e(f.target.value),required:!0,className:"input-field",placeholder:"Your name"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{id:"email",type:"email",value:t,onChange:f=>s(f.target.value),required:!0,className:"input-field",placeholder:"your@email.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"preferredLanguage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Language"}),a.jsxs("select",{id:"preferredLanguage",value:c,onChange:f=>d(f.target.value),className:"input-field",children:[a.jsx("option",{value:"hinglish",children:"Hinglish ()"}),a.jsx("option",{value:"hi",children:" (Hindi)"}),a.jsx("option",{value:"en",children:"English"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),a.jsx("input",{id:"password",type:"password",value:r,onChange:f=>n(f.target.value),required:!0,minLength:8,className:"input-field",placeholder:"At least 8 characters"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),a.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:f=>l(f.target.value),required:!0,className:"input-field",placeholder:"Re-enter your password"})]}),a.jsx("button",{type:"submit",disabled:h,className:"btn-primary w-full py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:h?a.jsxs("span",{className:"flex items-center justify-center",children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating account..."]}):"Create Account"}),m]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",a.jsx(te,{to:"/login",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Sign in"})]})}),a.jsx("p",{className:"mt-4 text-xs text-gray-500 text-center",children:"By creating an account, you agree to our Terms of Service and Privacy Policy"})]})}function eg(){const[i,e]=k.useState("");return k.useEffect(()=>{const t=new Date().getHours();t<12?e("Good morning"):t<18?e("Good afternoon"):e("Good evening")},[]),a.jsxs("div",{className:"relative overflow-hidden rounded-3xl p-8 mb-8 border border-white/10 group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-accent/20 via-background to-background opacity-50 group-hover:opacity-60 transition-opacity duration-500"}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-accent/10 blur-[80px] rounded-full"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"flex items-center space-x-2 mb-2",children:a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-white/10 border border-white/5 text-xs text-accent backdrop-blur-md",children:[a.jsx(Co,{size:12,className:"mr-1"}),"AI Creative Assistant"]})}),a.jsxs("h1",{className:"text-4xl md:text-5xl font-display font-bold text-white mb-2 tracking-tight",children:[a.jsx("span",{className:"text-gradient-accent",children:i}),", Creator"]}),a.jsxs("p",{className:"text-text-secondary text-lg max-w-lg",children:["Ready to make something ",a.jsx("span",{className:"text-white font-medium",children:"amazing/"})," today?"]})]})]})}const As=({to:i,icon:e,title:t,titleHi:s,subtitle:r,size:n="small",color:o="accent"})=>a.jsxs(te,{to:i,className:`
      relative overflow-hidden rounded-3xl border border-white/10 group
      ${n==="large"?"col-span-2 row-span-2":"col-span-1 row-span-1"}
      bg-card/40 hover:bg-card/60 transition-all duration-300
    `,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),a.jsxs("div",{className:"p-6 h-full flex flex-col justify-between relative z-10",children:[a.jsx("div",{className:`
        w-12 h-12 rounded-2xl flex items-center justify-center mb-4 transition-transform duration-300 group-hover:scale-110
        ${o==="accent"?"bg-accent/20 text-accent":""}
        ${o==="green"?"bg-success/20 text-success":""}
        ${o==="blue"?"bg-info/20 text-info":""}
        ${o==="orange"?"bg-warning/20 text-warning":""}
      `,children:a.jsx(e,{size:24})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-white mb-1 group-hover:text-accent transition-colors flex flex-col items-start gap-0.5",children:[a.jsx("span",{children:t}),a.jsx("span",{className:"opacity-70 text-sm font-normal font-hindi text-text-secondary",children:s})]}),a.jsx("p",{className:"text-sm text-text-tertiary mt-2",children:r})]}),n==="large"&&a.jsx("div",{className:"absolute bottom-6 right-6 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-x-4 group-hover:translate-x-0",children:a.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center backdrop-blur-md",children:a.jsx(Hi,{size:20,className:"text-white"})})})]})]});function tg(){return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsx(As,{to:"/scripts",icon:vo,title:"Generate Script",titleHi:" ",subtitle:"AI-powered scripts for YouTube & Reels",size:"large",color:"accent"}),a.jsx(As,{to:"/captions",icon:xo,title:"Captions",titleHi:"",subtitle:"Auto-transcribe & style",size:"small",color:"green"}),a.jsx(As,{to:"/thumbnails",icon:wo,title:"Thumbnails",titleHi:"",subtitle:"Create click-worthy covers",size:"small",color:"blue"}),a.jsx(As,{to:"/hooks",icon:Wi,title:"Viral Hooks",titleHi:"",subtitle:"Get attention instantly",size:"small",color:"orange"}),a.jsx("div",{className:"col-span-1 row-span-1 rounded-3xl border border-dashed border-white/20 flex items-center justify-center bg-transparent hover:bg-white/5 transition-colors cursor-pointer group",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center mx-auto mb-2 group-hover:scale-110 transition-transform",children:a.jsx(Lu,{size:20,className:"text-text-tertiary group-hover:text-white"})}),a.jsx("span",{className:"text-sm text-text-tertiary group-hover:text-white",children:"New Project"})]})})]})}const Jr=({percentage:i,color:e,radius:t,stroke:s})=>{const r=t-s*2,n=r*2*Math.PI,o=n-i/100*n;return a.jsx("div",{className:"relative flex items-center justify-center",children:a.jsxs("svg",{height:t*2,width:t*2,className:"transform -rotate-90",children:[a.jsx("circle",{stroke:"rgba(255,255,255,0.1)",strokeWidth:s,fill:"transparent",r,cx:t,cy:t}),a.jsx("circle",{stroke:e,strokeWidth:s,strokeDasharray:n+" "+n,style:{strokeDashoffset:o,transition:"stroke-dashoffset 1s ease-in-out"},strokeLinecap:"round",fill:"transparent",r,cx:t,cy:t})]})})};function sg(){return a.jsxs("div",{className:"glass-card rounded-3xl p-6 flex flex-col items-center justify-center h-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 w-full text-left",children:"Activity"}),a.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx(Jr,{percentage:75,color:"#FF9500",radius:90,stroke:12})}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx(Jr,{percentage:45,color:"#30D158",radius:72,stroke:12})}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx(Jr,{percentage:60,color:"#0A84FF",radius:54,stroke:12})}),a.jsxs("div",{className:"text-center z-10",children:[a.jsx("span",{className:"block text-3xl font-bold text-white",children:"12"}),a.jsx("span",{className:"text-xs text-text-tertiary",children:"Projects"})]})]}),a.jsxs("div",{className:"mt-6 w-full space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-accent mr-2"}),a.jsx("span",{className:"text-text-secondary",children:"Scripts"})]}),a.jsx("span",{className:"text-white font-medium",children:"8/10"})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-success mr-2"}),a.jsx("span",{className:"text-text-secondary",children:"Captions"})]}),a.jsx("span",{className:"text-white font-medium",children:"45m"})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-info mr-2"}),a.jsx("span",{className:"text-text-secondary",children:"Thumbnails"})]}),a.jsx("span",{className:"text-white font-medium",children:"4"})]})]})]})}const Fn=[{id:1,title:"Goa Trip Vlog 2024",type:"Script",status:"Draft",date:"2h ago",icon:""},{id:2,title:"Tech Review: iPhone 16",type:"Caption",status:"Processing",date:"5h ago",icon:""},{id:3,title:"Street Food Delhi",type:"Thumbnail",status:"Done",date:"1d ago",icon:""},{id:4,title:"Crypto Basics Hindi",type:"Script",status:"Done",date:"2d ago",icon:""}];function rg(){return a.jsxs("div",{className:"glass-card rounded-3xl p-6 h-full flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent Projects"}),a.jsx("button",{className:"text-text-tertiary hover:text-white transition-colors",children:a.jsx(eu,{size:20})})]}),a.jsxs("div",{className:"overflow-y-auto pr-2 space-y-2 flex-1 scrollbar-thin",children:[Fn.map(i=>a.jsxs("div",{className:"group flex items-center justify-between p-3 rounded-2xl hover:bg-white/5 transition-colors cursor-pointer border border-transparent hover:border-white/5",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-surface flex items-center justify-center text-lg border border-white/5 group-hover:border-white/10 transition-colors shadow-sm",children:i.icon}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-white group-hover:text-accent transition-colors",children:i.title}),a.jsxs("div",{className:"flex items-center text-xs text-text-tertiary mt-1",children:[a.jsx("span",{children:i.type}),a.jsx("div",{className:"w-1 h-1 rounded-full bg-text-tertiary/50 mx-2"}),a.jsx(bo,{size:10,className:"mr-1 opacity-70"}),a.jsx("span",{children:i.date})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:`
                text-[10px] uppercase tracking-wider font-bold px-2 py-0.5 rounded-full border shadow-sm
                ${i.status==="Done"?"bg-success/10 text-success border-success/20":""}
                ${i.status==="Processing"?"bg-warning/10 text-warning border-warning/20":""}
                ${i.status==="Draft"?"bg-white/10 text-text-secondary border-white/10":""}
              `,children:i.status}),a.jsx("button",{className:"text-text-tertiary opacity-0 group-hover:opacity-100 hover:text-white transition-all",children:a.jsx(ou,{size:16})})]})]},i.id)),Fn.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx("p",{className:"text-text-tertiary",children:"No projects yet"}),a.jsx("button",{className:"mt-2 text-accent text-sm font-medium hover:underline",children:"Create New"})]})]})]})}const ig=[{id:1,title:"Cinematic Vlog",type:"Travel",image:"https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&q=80&w=400"},{id:2,title:"Tech Review",type:"Tech",image:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&q=80&w=400"},{id:3,title:"Food Reels",type:"Lifestyle",image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&q=80&w=400"},{id:4,title:"Finance Tips",type:"Education",image:"https://images.unsplash.com/photo-1579621970563-ebec7560ff3e?auto=format&fit=crop&q=80&w=400"},{id:5,title:"Finance Tips",type:"Education",image:"https://images.unsplash.com/photo-1579621970563-ebec7560ff3e?auto=format&fit=crop&q=80&w=400"}];function ng(){return a.jsxs("div",{className:"mb-12",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-white",children:["Featured Templates / ",a.jsx("span",{className:"text-lg font-normal text-text-tertiary font-hindi",children:""})]}),a.jsx("button",{className:"text-sm text-accent hover:text-accent-hover transition-colors",children:"View All"})]}),a.jsx("div",{className:"flex space-x-4 overflow-x-auto pb-6 scrollbar-hide snap-x",children:ig.map((i,e)=>a.jsxs("div",{className:"relative flex-none w-64 aspect-video rounded-2xl overflow-hidden group cursor-pointer snap-start",children:[a.jsx("img",{src:i.image,alt:i.title,className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-80 group-hover:opacity-70 transition-opacity"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:a.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center",children:a.jsx(zi,{size:20,className:"text-white fill-current ml-1"})})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[a.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-accent mb-1 block",children:i.type}),a.jsx("h4",{className:"text-white font-medium truncate",children:i.title})]}),e===0&&a.jsx("div",{className:"absolute top-3 left-3 bg-accent text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"NEW"})]},e))})]})}function ag(){return a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsx(eg,{}),a.jsx(tg,{}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[a.jsx("div",{className:"lg:col-span-2 h-full",children:a.jsx(rg,{})}),a.jsx("div",{className:"lg:col-span-1 h-full",children:a.jsx(sg,{})})]}),a.jsx(ng,{})]})}const og=[{value:"entertainment",label:"Entertainment",labelHi:"",icon:""},{value:"education",label:"Education",labelHi:"",icon:""},{value:"food",label:"Food",labelHi:"",icon:""},{value:"fitness",label:"Fitness",labelHi:"",icon:""},{value:"business",label:"Business",labelHi:"",icon:""},{value:"technology",label:"Technology",labelHi:"",icon:""},{value:"lifestyle",label:"Lifestyle",labelHi:"",icon:""},{value:"comedy",label:"Comedy",labelHi:"",icon:""},{value:"motivation",label:"Motivation",labelHi:"",icon:""},{value:"festival",label:"Festival",labelHi:"",icon:""}],lg=[{value:"reel",label:"Instagram Reel",duration:"30-60 sec"},{value:"short",label:"YouTube Short",duration:"60 sec"},{value:"youtube",label:"YouTube Video",duration:"5-10 min"},{value:"podcast",label:"Podcast Intro",duration:"2-3 min"},{value:"ad",label:"Ad Script",duration:"15-30 sec"},{value:"story",label:"Story/Status",duration:"15 sec"}],cg=[{value:"casual",label:"Casual",labelHi:" "},{value:"professional",label:"Professional",labelHi:""},{value:"humorous",label:"Humorous",labelHi:""},{value:"inspirational",label:"Inspirational",labelHi:""},{value:"educational",label:"Educational",labelHi:""},{value:"dramatic",label:"Dramatic",labelHi:""}];function Ln(){const i=Ft(),[e,t]=k.useState({topic:"",language:"hinglish",script_type:"reel",category:"entertainment",tone:"casual",target_duration_seconds:45,target_audience:"",include_hooks:!0,include_hashtags:!0,additional_instructions:""}),[s,r]=k.useState(!1),n=Pe({mutationFn:async l=>(r(!0),po.generate(l)),onSuccess:l=>{r(!1),X.success("Script generated successfully!"),i(`/scripts/${l.data.id}`)},onError:()=>{r(!1),X.error("Failed to generate script. Please try again.")}}),o=l=>{if(l.preventDefault(),!e.topic.trim()){X.error("Please enter a topic");return}n.mutate(e)};return a.jsxs("div",{className:"max-w-4xl mx-auto pb-20",children:[a.jsxs("div",{className:"mb-10 text-center",children:[a.jsx("h1",{className:"text-4xl font-display font-bold text-white mb-3",children:"Generate Script"}),a.jsx("p",{className:"text-text-secondary text-lg",children:"Create viral scripts in Hindi, English, or Hinglish with AI magic."})]}),a.jsxs("form",{onSubmit:o,className:"space-y-8",children:[a.jsx(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass p-1 rounded-3xl",children:a.jsxs("div",{className:"bg-background/40 backdrop-blur-xl rounded-[20px] p-6 md:p-8",children:[a.jsx("label",{className:"block text-xl font-medium text-white mb-4",children:"What's your video about?"}),a.jsx("textarea",{value:e.topic,onChange:l=>t({...e,topic:l.target.value}),placeholder:"e.g., 5 tips for waking up early and being productive, focusing on Indian lifestyle...",className:"w-full bg-transparent border-none text-white text-lg placeholder-text-tertiary focus:ring-0 min-h-[120px] resize-none",required:!0})]})}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"space-y-8",children:[a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[a.jsx("label",{className:"block text-sm font-medium text-text-secondary uppercase tracking-wider mb-4 pl-2",children:"Language / "}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"hi",label:"",sublabel:"Hindi"},{value:"en",label:"English",sublabel:"English"},{value:"hinglish",label:"Hinglish",sublabel:"Mix"}].map(l=>a.jsxs("button",{type:"button",onClick:()=>t({...e,language:l.value}),className:`p-4 rounded-2xl border transition-all duration-200 text-center ${e.language===l.value?"bg-accent text-white border-accent shadow-glow":"bg-surface/50 text-text-secondary border-white/5 hover:bg-surface hover:text-white"}`,children:[a.jsx("span",{className:"block font-bold text-lg mb-0.5",children:l.label}),a.jsx("span",{className:"block text-xs opacity-70",children:l.sublabel})]},l.value))})]}),a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[a.jsx("label",{className:"block text-sm font-medium text-text-secondary uppercase tracking-wider mb-4 pl-2",children:"Category"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:og.slice(0,6).map(l=>a.jsxs("button",{type:"button",onClick:()=>t({...e,category:l.value}),className:`flex items-center p-3 rounded-xl border transition-all duration-200 ${e.category===l.value?"bg-white/10 text-white border-accent/50":"bg-surface/30 text-text-secondary border-white/5 hover:bg-surface/50 hover:text-white"}`,children:[a.jsx("span",{className:"mr-3 text-xl",children:l.icon}),a.jsx("div",{className:"text-left",children:a.jsx("span",{className:"block text-sm font-medium",children:l.label})})]},l.value))})]})]}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},children:[a.jsx("label",{className:"block text-sm font-medium text-text-secondary uppercase tracking-wider mb-4 pl-2",children:"Format & Tone"}),a.jsxs("div",{className:"glass-card rounded-3xl p-6 space-y-6",children:[a.jsx("div",{className:"overflow-x-auto pb-2 -mx-2 px-2 flex space-x-3 scrollbar-hide",children:lg.map(l=>a.jsx("button",{type:"button",onClick:()=>t({...e,script_type:l.value}),className:`flex-none px-4 py-2 rounded-full border text-sm font-medium transition-all whitespace-nowrap ${e.script_type===l.value?"bg-white text-black border-white":"bg-transparent text-text-secondary border-white/20 hover:border-white hover:text-white"}`,children:l.label},l.value))}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:cg.map(l=>a.jsx("button",{type:"button",onClick:()=>t({...e,tone:l.value}),className:`px-2 py-2 rounded-lg text-xs font-medium transition-all ${e.tone===l.value?"bg-accent/20 text-accent ring-1 ring-accent":"bg-surface/50 text-text-tertiary hover:text-white hover:bg-surface"}`,children:l.label},l.value))}),a.jsx("div",{className:"h-px bg-white/10"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Viral Hooks"}),a.jsx("div",{onClick:()=>t({...e,include_hooks:!e.include_hooks}),className:`w-12 h-7 rounded-full p-1 cursor-pointer transition-colors duration-300 ${e.include_hooks?"bg-success":"bg-surface border border-white/10"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${e.include_hooks?"translate-x-5":"translate-x-0"}`})})]})]})]}),a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"pt-4",children:[a.jsxs("button",{type:"submit",disabled:s,className:"w-full relative group overflow-hidden rounded-full p-[1px]",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500 via-pink-500 to-orange-500 animate-gradient opacity-100 transition-opacity"}),a.jsx("div",{className:"relative bg-background rounded-full px-8 py-4 bg-opacity-90 group-hover:bg-opacity-80 transition-all",children:a.jsx("div",{className:"flex items-center justify-center space-x-2",children:s?a.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Co,{className:"text-white w-5 h-5"}),a.jsx("span",{className:"text-lg font-bold text-white tracking-wide",children:"Generate Magic"}),a.jsx(Hi,{className:"text-white/50 w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})})]}),a.jsx("p",{className:"text-center text-xs text-text-tertiary mt-4",children:"Takes about 15-30 seconds to generate a full script"})]})]})]})]})]})}const hg=[{value:"",label:"All Types"},{value:"reel",label:"Reel"},{value:"short",label:"YouTube Short"},{value:"youtube",label:"YouTube Video"},{value:"podcast",label:"Podcast"},{value:"ad",label:"Ad"},{value:"story",label:"Story"}],dg=[{value:"",label:"All Languages"},{value:"hi",label:" (Hindi)"},{value:"en",label:"English"},{value:"hinglish",label:"Hinglish"}];function ug(){var l,c;const[i,e]=k.useState({language:"",script_type:"",is_favorite:void 0,search:"",page:1}),{data:t,isLoading:s,error:r}=xe({queryKey:["scripts",i],queryFn:()=>po.list(i)}),n=((l=t==null?void 0:t.data)==null?void 0:l.items)||[],o=((c=t==null?void 0:t.data)==null?void 0:c.has_more)||!1;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Scripts"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Generate and manage your content scripts"})]}),a.jsxs(te,{to:"/scripts/new",className:"btn-primary whitespace-nowrap",children:[a.jsx("span",{className:"mr-2",children:"+"}),"Generate New Script"]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:a.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),a.jsx("input",{type:"text",value:i.search,onChange:d=>e({...i,search:d.target.value,page:1}),placeholder:"Search scripts...",className:"input-field"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),a.jsx("select",{value:i.language,onChange:d=>e({...i,language:d.target.value,page:1}),className:"input-field",children:dg.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),a.jsx("select",{value:i.script_type,onChange:d=>e({...i,script_type:d.target.value,page:1}),className:"input-field",children:hg.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Favorites"}),a.jsxs("select",{value:i.is_favorite===void 0?"":i.is_favorite?"true":"false",onChange:d=>e({...i,is_favorite:d.target.value===""?void 0:d.target.value==="true",page:1}),className:"input-field",children:[a.jsx("option",{value:"",children:"All Scripts"}),a.jsx("option",{value:"true",children:"Favorites Only"}),a.jsx("option",{value:"false",children:"Non-Favorites"})]})]})]})}),s?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"}),a.jsx("p",{className:"text-gray-500 mt-4",children:"Loading scripts..."})]}):r?a.jsx("div",{className:"text-center py-12 bg-white rounded-xl border border-red-200",children:a.jsx("p",{className:"text-red-600",children:"Failed to load scripts. Please try again."})}):n.length===0?a.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[a.jsx("div",{className:"text-5xl mb-4",children:""}),a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No scripts yet"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Generate your first script to get started"}),a.jsx(te,{to:"/scripts/new",className:"btn-primary inline-block mt-4",children:"Generate Script"})]}):a.jsx("div",{className:"grid gap-4",children:n.map((d,h)=>a.jsx(gg,{script:d,index:h},d.id))}),n.length>0&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:()=>e({...i,page:i.page-1}),disabled:i.page===1,className:"btn-secondary disabled:opacity-50",children:"Previous"}),a.jsxs("span",{className:"text-gray-600",children:["Page ",i.page]}),a.jsx("button",{onClick:()=>e({...i,page:i.page+1}),disabled:!o,className:"btn-secondary disabled:opacity-50",children:"Next"})]})]})}function gg({script:i,index:e}){const t={hi:"",en:"English",hinglish:"Hinglish"};return a.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.05},children:a.jsx(te,{to:`/scripts/${i.id}`,className:"block bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.is_favorite&&a.jsx("span",{className:"text-yellow-500",children:""}),a.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:i.title})]}),a.jsxs("p",{className:"text-gray-600 text-sm line-clamp-2 mb-3",children:[i.content.substring(0,150),"..."]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 bg-primary-50 text-primary-700 text-xs rounded-full",children:t[i.language]||i.language}),a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full capitalize",children:i.script_type}),a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full capitalize",children:i.category}),a.jsxs("span",{className:"text-xs text-gray-500",children:[i.word_count," words  ",i.target_duration_seconds,"s"]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-4",children:a.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})})}function mg({onUploadComplete:i}){const e=Ft(),t=k.useRef(null),[s,r]=k.useState(null),[n,o]=k.useState(""),[l,c]=k.useState("auto"),[d,h]=k.useState(!0),[u,g]=k.useState(0),[p,m]=k.useState(!1),[x,f]=k.useState(null),[y,w]=k.useState(1),{data:j}=xe({queryKey:["caption-styles"],queryFn:Ht.getStyles}),T=Pe({mutationFn:async O=>{const W=new FormData;return W.append("file",O),W.append("title",n||O.name),W.append("language_hint",l),W.append("word_timestamps",String(d)),x&&W.append("style_preset_id",x),(await Ht.upload(W,M=>{const U=Math.round(M.loaded*100/(M.total||100));g(U)})).data},onSuccess:O=>{X.success("Video uploaded! Processing captions..."),r(null),g(0),i?i(O):e(`/captions/${O.id}`)},onError:O=>{X.error("Upload failed. Please try again."),g(0),console.error(O)}}),A=O=>{O.preventDefault(),O.stopPropagation(),O.type==="dragenter"||O.type==="dragover"?m(!0):O.type==="dragleave"&&m(!1)},P=O=>{O.preventDefault(),O.stopPropagation(),m(!1),O.dataTransfer.files&&O.dataTransfer.files[0]&&E(O.dataTransfer.files[0])},N=O=>{O.preventDefault(),O.target.files&&O.target.files[0]&&E(O.target.files[0])},E=O=>{if(!["video/mp4","video/quicktime","video/x-m4v","audio/mpeg","audio/wav"].includes(O.type)&&!O.type.startsWith("video/")){X.error("Please upload MP4, MOV, or MP3 file");return}if(O.size>104857600){X.error("File size too large (max 100MB)");return}r(O),n||o(O.name.replace(/\.[^/.]+$/,"")),w(2)},D=O=>{O.preventDefault(),s&&T.mutate(s)},R=(j==null?void 0:j.data.styles)||{};return a.jsxs("div",{className:"w-full",children:[y===1&&a.jsxs("div",{className:`relative border-2 border-dashed rounded-[32px] p-12 text-center transition-all cursor-pointer group ${p?"border-accent bg-accent/5":"border-white/10 hover:border-white/20 hover:bg-white/5"}`,onDragEnter:A,onDragLeave:A,onDragOver:A,onDrop:P,onClick:()=>{var O;return(O=t.current)==null?void 0:O.click()},children:[a.jsx("input",{ref:t,type:"file",className:"hidden",onChange:N,accept:".mp4,.mov,.mp3,.wav"}),a.jsxs("div",{className:"flex flex-col items-center space-y-4 relative z-10",children:[a.jsx("div",{className:"w-20 h-20 rounded-full bg-surface/80 flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:a.jsx(Pu,{className:"text-accent w-8 h-8"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Upload Video"}),a.jsx("p",{className:"text-text-secondary max-w-sm mx-auto",children:"Drag & drop MP4 or MOV files here, or click to browse (Max 100MB)"})]})]})]}),y===2&&s&&a.jsxs(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"space-y-8 p-6 md:p-8",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-surface flex items-center justify-center",children:a.jsx(du,{className:"text-accent"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-medium truncate max-w-xs",children:s.name}),a.jsxs("p",{className:"text-sm text-text-tertiary",children:[(s.size/(1024*1024)).toFixed(1)," MB"]})]})]}),a.jsx("button",{onClick:()=>{r(null),w(1),g(0)},className:"p-2 hover:bg-white/10 rounded-full transition-colors text-text-tertiary hover:text-white",children:a.jsx(Hu,{size:20})})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-text-secondary uppercase tracking-wider pl-1",children:"Project Title"}),a.jsx("input",{type:"text",value:n,onChange:O=>o(O.target.value),className:"glass-input w-full p-4 rounded-xl text-white outline-none",placeholder:"e.g. My Viral Video"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-text-secondary uppercase tracking-wider pl-1",children:"Language"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx("button",{onClick:()=>c("auto"),className:`p-3 rounded-xl border text-sm font-medium transition-all ${l==="auto"?"bg-accent/20 text-accent border-accent":"bg-surface/50 text-text-secondary border-transparent hover:bg-surface"}`,children:"Auto-Detect"}),a.jsx("button",{onClick:()=>c("hinglish"),className:`p-3 rounded-xl border text-sm font-medium transition-all ${l==="hinglish"?"bg-accent/20 text-accent border-accent":"bg-surface/50 text-text-secondary border-transparent hover:bg-surface"}`,children:"Hinglish"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3 p-4 rounded-xl bg-white/5 border border-white/5",children:[a.jsx("input",{type:"checkbox",id:"timestamps",checked:d,onChange:O=>h(O.target.checked),className:"w-5 h-5 rounded border-white/20 bg-surface/50 text-accent focus:ring-accent"}),a.jsxs("label",{htmlFor:"timestamps",className:"cursor-pointer",children:[a.jsx("span",{className:"block font-medium text-white",children:"Karaoke Highlights"}),a.jsx("span",{className:"block text-xs text-text-tertiary",children:"Animate active words like Instagram Reels"})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"text-sm font-medium text-text-secondary uppercase tracking-wider pl-1",children:"Caption Style"}),a.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[300px] overflow-y-auto scrollbar-thin pr-1",children:Object.values(R).map(O=>a.jsxs("div",{onClick:()=>f(O.id),className:`cursor-pointer p-3 rounded-xl border transition-all ${x===O.id?"border-accent bg-accent/10":"border-white/10 bg-surface/30 hover:bg-surface/50"}`,children:[a.jsx("div",{className:"h-16 flex items-center justify-center rounded-lg mb-2 overflow-hidden text-xs",style:{backgroundColor:O.background_color==="transparent"?"#1c1c1e":O.background_color},children:a.jsx("span",{style:{fontFamily:O.font_family,fontWeight:O.font_weight,color:O.color,textTransform:O.text_transform,textShadow:O.text_shadow},children:O.name})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs font-medium text-white truncate",children:O.name}),x===O.id&&a.jsx(yo,{size:12,className:"text-accent"})]})]},O.id))})]})]}),a.jsx("div",{className:"pt-4",children:T.isPending?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:a.jsx(B.div,{className:"h-full bg-accent",initial:{width:0},animate:{width:`${u}%`}})}),a.jsxs("p",{className:"text-center text-sm text-text-tertiary flex items-center justify-center",children:[a.jsx(jo,{className:"animate-spin w-4 h-4 mr-2"}),"Extracting Audio... ",u,"%"]})]}):a.jsx("button",{onClick:D,className:"w-full py-4 bg-accent text-white rounded-2xl font-bold text-lg hover:bg-accent-hover transition-colors shadow-glow hover:shadow-[0_0_30px_rgba(255,149,0,0.5)] active:scale-[0.98]",children:"Generate Captions"})})]})]})}function pg(){const i=Ft(),e=t=>{i(`/captions/${t.id}`)};return a.jsxs("div",{className:"max-w-5xl mx-auto pb-20 animate-fade-in",children:[a.jsxs("div",{className:"text-center mb-16 relative",children:[a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-accent/20 blur-[100px] rounded-full -z-10"}),a.jsxs("h1",{className:"text-4xl md:text-5xl font-display font-bold text-white mb-4",children:["Captions that ",a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-500",children:"Pop"})]}),a.jsx("p",{className:"text-xl text-text-secondary max-w-2xl mx-auto",children:"Auto-generate subtitles in Hinglish, Hindi, and English with Bollywood-style animations."})]}),a.jsx("div",{className:"glass-card rounded-[40px] p-2 mb-20 bg-surface/30 backdrop-blur-2xl border border-white/10 shadow-2xl",children:a.jsx("div",{className:"bg-background/50 rounded-[32px] overflow-hidden",children:a.jsx(mg,{onUploadComplete:e})})}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsx(Qr,{icon:a.jsx(ru,{className:"text-accent",size:32}),title:"Instant Transcription",desc:"Uses OpenAI Whisper for 99% accuracy even with heavy Indian accents."}),a.jsx(Qr,{icon:a.jsx(Iu,{className:"text-purple-400",size:32}),title:"Viral Aesthetics",desc:"Choose from 5+ presets like 'Bollywood Drama' or 'Minimal Chic'."}),a.jsx(Qr,{icon:a.jsx(xu,{className:"text-green-400",size:32}),title:"Language Mix",desc:"Perfectly handles 'Bhai, ye scene check kar' (Hinglish context)."})]})]})}function Qr({icon:i,title:e,desc:t}){return a.jsxs("div",{className:"glass p-8 rounded-3xl hover:bg-white/10 transition-colors duration-300",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/5 flex items-center justify-center mb-6 border border-white/10",children:i}),a.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:e}),a.jsx("p",{className:"text-text-secondary",children:t})]})}function fg(){var x,f,y,w;const{id:i}=Da(),e=Na(),[t,s]=k.useState("srt"),[r,n]=k.useState("minimal_chic"),[o,l]=k.useState(!0),{data:c}=xe({queryKey:["caption-styles"],queryFn:Ht.getStyles}),{data:d,isLoading:h,error:u}=xe({queryKey:["caption",i],queryFn:()=>Ht.get(i),refetchInterval:j=>{var A,P;const T=(P=(A=j.state.data)==null?void 0:A.data)==null?void 0:P.status;return T==="completed"||T==="failed"?!1:2e3},enabled:!!i}),g=Pe({mutationFn:j=>Ht.export(i,{format:j}),onSuccess:j=>{window.open(j.data.download_url,"_blank"),ne.success(`Downloaded ${t.toUpperCase()}`)},onError:()=>ne.error("Export failed")}),p=Pe({mutationFn:()=>Ht.burn(i,{style_preset_id:r,karaoke:o}),onSuccess:j=>{var A;const T=(A=j.data)==null?void 0:A.download_url;T&&window.open(T,"_blank"),ne.success("Burned captions video ready"),e.invalidateQueries({queryKey:["caption",i]})},onError:()=>ne.error("Burn-in failed")}),m=d==null?void 0:d.data;return h?a.jsx("div",{className:"p-12 text-center",children:"Loading..."}):u||!m?a.jsx("div",{className:"p-12 text-center text-red-500",children:"Error loading caption"}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{children:[a.jsx(te,{to:"/captions",className:"text-gray-500 hover:text-black mb-2 inline-block",children:" Back to Upload"}),a.jsx("h1",{className:"text-2xl font-bold",children:m.title}),a.jsxs("p",{className:"text-gray-500 text-sm",children:["Status: ",a.jsx("span",{className:`uppercase font-bold ${m.status==="completed"?"text-green-600":"text-orange-500"}`,children:m.status})]})]}),m.status==="completed"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:t,onChange:j=>s(j.target.value),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"srt",children:"SRT (Subtitles)"}),a.jsx("option",{value:"txt",children:"Text Only"})]}),a.jsx("button",{onClick:()=>g.mutate(t),className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800",children:"Download"})]})]}),m.status==="completed"&&a.jsxs("div",{className:"bg-white border rounded-xl p-4 mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Burn captions into video"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reels-style karaoke highlighting uses word timestamps."}),((x=m.exported_formats)==null?void 0:x.burned_mp4)&&a.jsx("a",{className:"text-sm text-blue-600 hover:underline",href:m.exported_formats.burned_mp4,target:"_blank",rel:"noreferrer",children:"Download burned video"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[a.jsx("select",{value:r,onChange:j=>n(j.target.value),className:"border rounded px-3 py-2",children:Object.values(((f=c==null?void 0:c.data)==null?void 0:f.styles)||{}).map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))}),a.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:j=>l(j.target.checked)}),"Karaoke"]}),a.jsx("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 disabled:opacity-60",children:p.isPending?"Rendering":"Burn & Download"})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-black rounded-xl aspect-video flex items-center justify-center relative overflow-hidden",children:[a.jsx("p",{className:"text-white opacity-50",children:"Video Preview"}),m.status==="completed"&&a.jsx("div",{className:"absolute bottom-8 text-center w-full px-4",children:a.jsx("p",{className:"text-white text-2xl font-bold font-sans drop-shadow-md bg-black/50 inline-block px-2",children:((w=(y=m.segments)==null?void 0:y[0])==null?void 0:w.text)||"Caption preview..."})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow p-6 h-[500px] overflow-y-auto",children:[a.jsx("h3",{className:"font-bold mb-4",children:"Transcription"}),m.status==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center h-40 space-y-4",children:[a.jsx("div",{className:"animate-spin text-4xl",children:""}),a.jsx("p",{children:"AI is transcribing your audio..."}),a.jsx("p",{className:"text-xs text-gray-500",children:"This usually takes about 20% of video duration."})]}),m.status==="completed"&&m.segments?a.jsx("div",{className:"space-y-4",children:m.segments.map(j=>a.jsxs("div",{className:"flex gap-4 p-3 hover:bg-gray-50 rounded group cursor-pointer border-b border-gray-100",children:[a.jsx("span",{className:"text-xs text-mono text-gray-400 mt-1 w-12 shrink-0",children:new Date(j.start_time*1e3).toISOString().substr(14,5)}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-800",children:j.text}),j.text_english&&a.jsx("p",{className:"text-sm text-indigo-600 mt-1",children:j.text_english})]})]},j.segment_index))}):null]})]})]})}const xg=[{value:"",label:"All",icon:""},{value:"festival",label:"Festival",labelHi:"",icon:""},{value:"food",label:"Food",labelHi:"",icon:""},{value:"fitness",label:"Fitness",labelHi:"",icon:""},{value:"business",label:"Business",labelHi:"",icon:""},{value:"lifestyle",label:"Lifestyle",labelHi:"",icon:""},{value:"travel",label:"Travel",labelHi:"",icon:""},{value:"education",label:"Education",labelHi:"",icon:""},{value:"motivation",label:"Motivation",labelHi:"",icon:""},{value:"entertainment",label:"Entertainment",labelHi:"",icon:""},{value:"product",label:"Product",labelHi:"",icon:""}];function yg(){var d,h,u;const[i,e]=k.useState({category:"",aspect_ratio:"",is_featured:void 0,search:"",page:1}),{data:t,isLoading:s,error:r}=xe({queryKey:["templates",i],queryFn:()=>xt.list(i)}),{data:n}=xe({queryKey:["templates-featured"],queryFn:()=>xt.featured()}),o=((d=t==null?void 0:t.data)==null?void 0:d.items)||[],l=((h=n==null?void 0:n.data)==null?void 0:h.items)||[],c=((u=t==null?void 0:t.data)==null?void 0:u.has_more)||!1;return a.jsxs("div",{className:"space-y-8 pb-20 animate-fade-in",children:[a.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Reel Templates"}),a.jsx("p",{className:"text-text-secondary",children:"Professional templates for festivals, food, fitness, and more"})]})}),l.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pn,{className:"text-accent fill-accent",size:20}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Featured Templates"})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:l.slice(0,5).map((g,p)=>a.jsx(Rn,{template:g,index:p,featured:!0},g.id))})]}),a.jsx("div",{className:"glass p-1 rounded-2xl sticky top-[80px] z-30",children:a.jsxs("div",{className:"bg-background/60 backdrop-blur-md rounded-xl p-4 space-y-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(_o,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-tertiary",size:18}),a.jsx("input",{type:"text",value:i.search,onChange:g=>e({...i,search:g.target.value,page:1}),placeholder:"Search templates...",className:"w-full bg-white/5 border border-white/10 rounded-xl pl-10 pr-4 py-2.5 text-white placeholder-text-tertiary focus:outline-none focus:border-accent/50 focus:ring-1 focus:ring-accent/50 transition-all"})]}),a.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 md:pb-0 scrollbar-hide",children:[a.jsxs("select",{value:i.aspect_ratio,onChange:g=>e({...i,aspect_ratio:g.target.value,page:1}),className:"bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-text-secondary focus:outline-none focus:border-accent/50",children:[a.jsx("option",{value:"",children:"All Ratios"}),a.jsx("option",{value:"9:16",children:"9:16 (Reels)"}),a.jsx("option",{value:"1:1",children:"1:1 (Square)"}),a.jsx("option",{value:"16:9",children:"16:9 (Video)"})]}),a.jsxs("button",{onClick:()=>e({...i,is_featured:i.is_featured?void 0:!0}),className:`px-4 py-2.5 rounded-xl border flex items-center gap-2 whitespace-nowrap transition-all ${i.is_featured?"bg-accent text-white border-accent":"bg-white/5 border-white/10 text-text-secondary hover:bg-white/10"}`,children:[a.jsx(Pn,{size:16,className:i.is_featured?"fill-current":""}),"Featured Only"]})]})]}),a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:xg.map(g=>a.jsxs("button",{onClick:()=>e({...i,category:g.value,page:1}),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 whitespace-nowrap ${i.category===g.value?"bg-white text-black":"bg-white/5 text-text-secondary hover:bg-white/10 hover:text-white"}`,children:[a.jsx("span",{children:g.icon}),a.jsx("span",{children:g.label})]},g.value))})]})}),s?a.jsx("div",{className:"flex justify-center py-20",children:a.jsx("div",{className:"w-8 h-8 border-2 border-accent border-t-transparent rounded-full animate-spin"})}):r?a.jsx("div",{className:"text-center py-20 text-red-500 bg-red-500/10 rounded-3xl border border-red-500/20",children:"Failed to load templates. Please try again."}):o.length===0?a.jsxs("div",{className:"text-center py-20 bg-white/5 rounded-3xl border border-white/5",children:[a.jsx("div",{className:"text-5xl mb-4",children:""}),a.jsx("h3",{className:"text-lg font-medium text-white",children:"No templates found"}),a.jsx("p",{className:"text-text-tertiary mt-1",children:"Try adjusting your filters"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:o.map((g,p)=>a.jsx(Rn,{template:g,index:p},g.id))}),o.length>0&&a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-white/10",children:[a.jsx("button",{onClick:()=>e({...i,page:i.page-1}),disabled:i.page===1,className:"px-6 py-2 rounded-full border border-white/10 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-all",children:"Previous"}),a.jsxs("span",{className:"text-text-secondary",children:["Page ",i.page]}),a.jsx("button",{onClick:()=>e({...i,page:i.page+1}),disabled:!c,className:"px-6 py-2 rounded-full bg-white text-black hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium",children:"Next"})]})]})}function Rn({template:i,index:e,featured:t}){const s={festival:"",food:"",fitness:"",business:"",lifestyle:"",travel:"",education:"",motivation:"",entertainment:"",product:""};return a.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.05},children:a.jsxs(te,{to:`/templates/${i.id}`,className:"group block glass-card rounded-2xl overflow-hidden hover:border-accent/50 transition-all duration-300",children:[a.jsxs("div",{className:"relative aspect-[9/16] bg-surface/50 overflow-hidden",children:[i.thumbnail_url?a.jsx("img",{src:i.thumbnail_url,alt:i.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-surface to-background",children:a.jsx("span",{className:"text-5xl opacity-50",children:s[i.category]||""})}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center backdrop-blur-sm",children:a.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center",children:a.jsx(zi,{className:"fill-white text-white ml-1",size:24})})}),a.jsxs("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:[t&&a.jsx("span",{className:"px-2 py-0.5 bg-accent text-white text-[10px] font-bold uppercase tracking-wider rounded-md shadow-lg",children:"Featured"}),i.is_premium&&a.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-purple-500 to-indigo-500 text-white text-[10px] font-bold uppercase tracking-wider rounded-md shadow-lg",children:"Pro"})]}),a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("span",{className:"px-1.5 py-0.5 bg-black/60 backdrop-blur-md text-white/80 text-[10px] rounded",children:i.aspect_ratio||"9:16"})})]}),a.jsxs("div",{className:"p-3",children:[a.jsx("h3",{className:"font-medium text-white truncate text-sm",children:i.name}),a.jsx("p",{className:"text-xs text-text-tertiary truncate mt-0.5 capitalize",children:i.category})]})]})})}function In(i,e,t){return Math.min(Math.max(i,e),t)}function bg(i,e){return typeof i!="string"?i:i==="$duration"?e.durationSeconds:i.startsWith("$theme.colors.")?e.themeColors[i.slice(15)]??"#000000":i.startsWith("$theme.fonts.")?e.themeFonts[i.slice(14)]??"Inter":i.startsWith("$placeholder.")?e.placeholderValues[i.slice(13)]??"":i}function vi(i,e){if(Array.isArray(i))return i.map(t=>vi(t,e));if(i&&typeof i=="object"){const t={};for(const[s,r]of Object.entries(i))t[s]=vi(r,e);return t}return e(i)}function vg(i,e,t){const s=Number(i.start??0),r=i.end==="$duration"?t:Number(i.end??t);return e>=s&&e<=r}function wg(i){switch(i){case"fade":return{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}};case"slideUp":return{initial:{opacity:0,y:28},animate:{opacity:1,y:0},exit:{opacity:0,y:-10}};case"slideDown":return{initial:{opacity:0,y:-28},animate:{opacity:1,y:0},exit:{opacity:0,y:10}};case"pop":return{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9}};case"wipe":return{initial:{clipPath:"inset(0 100% 0 0)"},animate:{clipPath:"inset(0 0% 0 0)"},exit:{opacity:0}};default:return{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}}}function jg({definition:i,themeId:e,durationSeconds:t,placeholderValues:s,localMediaUrls:r}){const[n,o]=k.useState(!0),[l,c]=k.useState(0),[d,h]=k.useState(420),u=k.useRef(null),g=k.useRef(null),p=k.useRef(performance.now());k.useEffect(()=>{const D=u.current;if(!D)return;const R=new ResizeObserver(([O])=>{O&&h(O.contentRect.width)});return R.observe(D),()=>R.disconnect()},[]);const m=d/i.width,x=k.useMemo(()=>{var D;return((D=i.themes)==null?void 0:D[e])??{}},[i.themes,e]),f=k.useMemo(()=>x.colors??{},[x]),y=k.useMemo(()=>x.fonts??{},[x]),w=k.useMemo(()=>{const D={};for(const[R,O]of Object.entries(i.placeholders??{}))O.type==="text"?D[R]=s[R]??O.default??"":D[R]=s[R]??"";return D},[i.placeholders,s]),j=k.useCallback(D=>bg(D,{themeColors:f,themeFonts:y,placeholderValues:w,durationSeconds:t}),[f,y,w,t]),T=k.useMemo(()=>[...Array.isArray(i.layers)?i.layers:[]].map(R=>{const O=R==null?void 0:R.source,W=vi(R,j);return W.__sourceToken=O,W}).sort((R,O)=>Number(R.z??0)-Number(O.z??0)),[i.layers,j]);k.useEffect(()=>{if(!n)return;p.current=performance.now()-l*1e3;const D=R=>{const O=(R-p.current)/1e3;c(O%t),g.current=requestAnimationFrame(D)};return g.current=requestAnimationFrame(D),()=>{g.current&&cancelAnimationFrame(g.current)}},[n,t]);const A=k.useMemo(()=>{var R;const D=T.find(O=>O.type==="solid");return((R=D==null?void 0:D.style)==null?void 0:R.color)??"#000"},[T]),P=D=>(r==null?void 0:r[D])??s[D]??"",N=D=>{const R=D.transform??{},O=D.style??{},W=Number(R.x??0)/i.width*100,C=Number(R.y??0)/i.height*100,M={position:"absolute",left:`${W}%`,top:`${C}%`,opacity:R.opacity!=null?Number(R.opacity):void 0},U=Array.isArray(D.animations)?D.animations[0]:void 0,$=wg(U==null?void 0:U.type),Q={duration:In(Number((U==null?void 0:U.duration)??.35),.05,2),ease:"easeOut"};if(D.type==="video"){const H=D.__sourceToken,F=typeof H=="string"&&H.startsWith("$placeholder.")?H.slice(13):"",V=F?P(F):typeof D.source=="string"?D.source:"";return a.jsx(B.div,{style:{...M,left:0,top:0,width:"100%",height:"100%"},...$,transition:Q,children:V?a.jsx("video",{src:V,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0,loop:!0}):a.jsxs("div",{className:"w-full h-full bg-gradient-to-b from-black/10 to-black/30 flex flex-col items-center justify-center gap-2 text-white/60",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),a.jsx("span",{className:"text-xs font-medium",children:"Add video clip"})]})},D.id)}if(D.type==="image"){const H=D.__sourceToken,F=typeof H=="string"&&H.startsWith("$placeholder.")?H.slice(13):"",V=F?P(F):typeof D.source=="string"?D.source:"",G=R.w?Number(R.w)*m:120*m,ee=R.h?Number(R.h)*m:120*m;return a.jsx(B.div,{style:{...M,width:G,height:ee},...$,transition:Q,children:V?a.jsx("img",{src:V,className:"w-full h-full object-contain",alt:""}):a.jsx("div",{className:"w-full h-full rounded-xl bg-white/10 border border-dashed border-white/30 flex items-center justify-center text-white/40 text-xs",children:"Logo"})},D.id)}if(D.type==="text"){const H=O.background,F=O.stroke,V=typeof D.text=="string"?D.text:"",G={...M,fontFamily:`${O.fontFamily||"Inter"}, sans-serif`,fontSize:Math.round(Number(O.fontSize??48)*m),fontWeight:Number(O.fontWeight??700),color:O.color,lineHeight:1.1,padding:H?`${Math.round(Number(H.paddingY??0)*m)}px ${Math.round(Number(H.paddingX??0)*m)}px`:void 0,background:H==null?void 0:H.color,borderRadius:H!=null&&H.radius?Math.round(Number(H.radius)*m):void 0,whiteSpace:"pre-wrap",maxWidth:"90%",textShadow:F?`0 0 ${Number(F.width??4)*m}px ${F.color??"rgba(0,0,0,0.5)"}`:void 0};return a.jsx(B.div,{style:G,...$,transition:Q,children:V},D.id)}return null},E=D=>{const R=D.currentTarget.getBoundingClientRect(),W=In((D.clientX-R.left)/R.width,0,1)*t;c(W),p.current=performance.now()-W*1e3};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{className:"w-8 h-8 flex items-center justify-center rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors text-gray-700",onClick:()=>o(D=>!D),title:n?"Pause":"Play",children:n?a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]}):a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("polygon",{points:"5,3 19,12 5,21"})})}),a.jsxs("div",{className:"flex-1 h-2 bg-gray-200 rounded-full cursor-pointer relative group",onClick:E,children:[a.jsx("div",{className:"h-full bg-gradient-to-r from-primary-500 to-accent-500 rounded-full transition-[width] duration-75",style:{width:`${l/t*100}%`}}),a.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-3.5 h-3.5 rounded-full bg-white border-2 border-primary-500 shadow-sm opacity-0 group-hover:opacity-100 transition-opacity",style:{left:`${l/t*100}%`,transform:"translate(-50%, -50%)"}})]}),a.jsxs("span",{className:"text-xs tabular-nums text-gray-500 min-w-[3rem] text-right",children:[l.toFixed(1),"s / ",t,"s"]})]}),a.jsx("div",{ref:u,className:"w-full max-w-[420px] mx-auto",children:a.jsxs("div",{className:"relative aspect-[9/16] rounded-2xl overflow-hidden border border-gray-200 shadow-lg",style:{background:A},children:[a.jsx(Qt,{mode:"sync",children:T.filter(D=>D.type!=="solid").filter(D=>vg(D,l,t)).map(D=>N(D))}),a.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/4 bg-gradient-to-t from-black/30 to-transparent pointer-events-none"})]})})]})}function _g(i){return i?Object.keys(i)[0]??"":""}function Cg(){var O,W,C,M,U,$,Q,H;const{id:i}=Da(),e=i||"",[t,s]=k.useState(""),[r,n]=k.useState(0),[o,l]=k.useState({}),[c,d]=k.useState({}),[h,u]=k.useState(null),g=xe({queryKey:["template",e],queryFn:()=>xt.get(e),enabled:!!e}),p=xe({queryKey:["template-definition",e],queryFn:()=>xt.definition(e),enabled:!!e}),m=((W=(O=p.data)==null?void 0:O.data)==null?void 0:W.template_data)??null;k.useEffect(()=>{m&&(s(F=>F||_g(m.themes)),n(F=>{var V;return F||(((V=m.durationPresets)==null?void 0:V[0])??15)}),l(F=>{const V={...F};for(const[G,ee]of Object.entries(m.placeholders??{}))ee.type==="text"&&V[G]==null&&(V[G]=ee.default??"");return V}))},[m]);const x=Pe({mutationFn:F=>xt.uploadAsset(F)}),f=Pe({mutationFn:F=>xt.use(e,{template_id:e,...F})}),y=Pe({mutationFn:F=>xt.render({user_template_id:F,output_format:"mp4",quality:"high",watermark:!1})}),w=xe({queryKey:["template-render-status",h],queryFn:()=>xt.renderStatus(h),enabled:!!h,refetchInterval:F=>{var G;const V=(G=F==null?void 0:F.data)==null?void 0:G.status;return V==="completed"||V==="failed"?!1:1500}}),j=g.isLoading||p.isLoading,T=g.error||p.error,A=k.useMemo(()=>m?Object.entries(m.placeholders??{}):[],[m]),P=async(F,V)=>{var se;const G=URL.createObjectURL(V);d(pe=>({...pe,[F]:G}));const ee=await x.mutateAsync(V),de=(se=ee==null?void 0:ee.data)==null?void 0:se.url;de&&l(pe=>({...pe,[F]:de}))},N=async()=>{var se,pe,$e,gt;if(!m)return;const F=(pe=(se=g.data)==null?void 0:se.data)!=null&&pe.name?`${g.data.data.name} (Custom)`:"My Template",V={...o,theme_id:t,duration_seconds:r},G=await f.mutateAsync({title:F,customizations:V}),ee=($e=G==null?void 0:G.data)==null?void 0:$e.id;if(!ee)return;const de=await y.mutateAsync(ee);u(((gt=de==null?void 0:de.data)==null?void 0:gt.user_template_id)??ee)},E=(M=(C=w.data)==null?void 0:C.data)==null?void 0:M.output_url,D=($=(U=w.data)==null?void 0:U.data)==null?void 0:$.status,R=(H=(Q=w.data)==null?void 0:Q.data)==null?void 0:H.error_message;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Template Editor"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Preview and customize your reel template"})]}),j?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"}),a.jsx("p",{className:"text-gray-500 mt-4",children:"Loading template..."})]}):T||!m?a.jsx("div",{className:"p-4 bg-white rounded-xl border border-red-200 text-red-600",children:"Failed to load template definition."}):a.jsxs("div",{className:"grid lg:grid-cols-[1fr_420px] gap-6",children:[a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:a.jsx(jg,{definition:m,themeId:t,durationSeconds:r,placeholderValues:o,localMediaUrls:c})}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Theme"}),a.jsx("select",{className:"input-field",value:t,onChange:F=>s(F.target.value),children:Object.entries(m.themes??{}).map(([F,V])=>a.jsx("option",{value:F,children:V.name??F},F))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),a.jsx("select",{className:"input-field",value:r,onChange:F=>n(Number(F.target.value)),children:(m.durationPresets??[15]).map(F=>a.jsxs("option",{value:F,children:[F,"s"]},F))})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Placeholders"}),A.map(([F,V])=>{if(V.type==="text")return a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:V.label??F}),a.jsx("input",{className:"input-field",value:o[F]??V.default??"",maxLength:V.maxLength,onChange:G=>l(ee=>({...ee,[F]:G.target.value}))})]},F);if(V.type==="video"||V.type==="logo"||V.type==="image"){const G=V.type==="video"?"video/mp4,video/quicktime":"image/png,image/jpeg,image/webp",ee=o[F];return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700",children:V.label??F}),ee?a.jsx("a",{className:"text-xs text-primary-600 hover:underline",href:ee,target:"_blank",rel:"noreferrer",children:"asset url"}):null]}),a.jsx("input",{type:"file",accept:G,onChange:de=>{var pe;const se=(pe=de.target.files)==null?void 0:pe[0];se&&P(F,se)}}),a.jsx("input",{className:"input-field",placeholder:"...or paste a URL",value:o[F]??"",onChange:de=>l(se=>({...se,[F]:de.target.value}))})]},F)}return null})]}),a.jsxs("div",{className:"pt-2 space-y-2",children:[a.jsx("button",{className:"btn-primary w-full",onClick:N,disabled:f.isPending||y.isPending,children:y.isPending?"Starting render":"Render MP4"}),h&&a.jsxs("div",{className:"text-sm text-gray-600",children:["Status: ",a.jsx("span",{className:"font-medium text-gray-900",children:D??"rendering"})]}),R&&a.jsx("div",{className:"text-sm text-red-600",children:R}),E&&a.jsx("a",{className:"btn-secondary w-full block text-center",href:E,target:"_blank",rel:"noreferrer",children:"Download output"})]})]})]})]})}const Sg=[{value:"",label:"All Styles"},{value:"bold",label:"Bold & Colorful"},{value:"minimal",label:"Minimal"},{value:"youtube",label:"YouTube Style"},{value:"gradient",label:"Gradient"},{value:"neon",label:"Neon"},{value:"traditional",label:"Traditional Indian"}];function kg(){var l,c;const[i,e]=k.useState({style:"",status:"",page:1}),{data:t,isLoading:s,error:r}=xe({queryKey:["thumbnails",i],queryFn:()=>qt.list(i)}),n=((l=t==null?void 0:t.data)==null?void 0:l.items)||[],o=((c=t==null?void 0:t.data)==null?void 0:c.has_more)||!1;return a.jsxs("div",{className:"space-y-8 pb-20 animate-fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Thumbnails"}),a.jsx("p",{className:"text-text-secondary",children:"Create click-worthy thumbnails with Hindi text support"})]}),a.jsxs(te,{to:"/thumbnails/new",className:"inline-flex items-center px-6 py-3 bg-white text-black rounded-full font-bold hover:bg-gray-200 transition-colors shadow-[0_0_20px_rgba(255,255,255,0.2)] active:scale-95",children:[a.jsx(Nu,{size:20,className:"mr-2"}),"Create Thumbnail"]})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{style:"bold",label:"Bold & Colorful",icon:"",color:"from-orange-500/20 to-red-500/20"},{style:"minimal",label:"Minimal Clean",icon:"",color:"from-blue-500/20 to-cyan-500/20"},{style:"youtube",label:"YouTube Style",icon:"",color:"from-red-500/20 to-pink-500/20"},{style:"traditional",label:"Traditional Indian",icon:"",color:"from-amber-500/20 to-orange-500/20"}].map(d=>a.jsxs(te,{to:`/thumbnails/new?style=${d.style}`,className:"group relative overflow-hidden rounded-3xl border border-white/5 hover:border-white/10 transition-all duration-300",children:[a.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${d.color} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),a.jsxs("div",{className:"relative p-6 bg-surface/40 backdrop-blur-md h-full group-hover:bg-surface/20 transition-colors",children:[a.jsx("div",{className:"text-3xl mb-3 transform group-hover:scale-110 transition-transform duration-300",children:d.icon}),a.jsx("h3",{className:"font-bold text-white text-lg",children:d.label}),a.jsxs("p",{className:"text-xs text-text-tertiary mt-2 flex items-center group-hover:text-white transition-colors",children:["Start creating ",a.jsx("span",{className:"ml-1 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all",children:""})]})]})]},d.style))}),a.jsx("div",{className:"glass p-1 rounded-2xl sticky top-[80px] z-30",children:a.jsxs("div",{className:"bg-background/60 backdrop-blur-md rounded-xl p-2 flex flex-wrap gap-2",children:[a.jsx("select",{value:i.style,onChange:d=>e({...i,style:d.target.value,page:1}),className:"bg-transparent text-white px-4 py-2 rounded-lg border border-transparent hover:bg-white/5 focus:bg-white/10 outline-none cursor-pointer",children:Sg.map(d=>a.jsx("option",{value:d.value,className:"bg-surface text-white",children:d.label},d.value))}),a.jsx("div",{className:"w-px h-8 bg-white/10 my-auto"}),a.jsxs("select",{value:i.status,onChange:d=>e({...i,status:d.target.value,page:1}),className:"bg-transparent text-white px-4 py-2 rounded-lg border border-transparent hover:bg-white/5 focus:bg-white/10 outline-none cursor-pointer",children:[a.jsx("option",{value:"",className:"bg-surface text-white",children:"All Status"}),a.jsx("option",{value:"pending",className:"bg-surface text-white",children:"Pending"}),a.jsx("option",{value:"generating",className:"bg-surface text-white",children:"Generating"}),a.jsx("option",{value:"completed",className:"bg-surface text-white",children:"Completed"}),a.jsx("option",{value:"failed",className:"bg-surface text-white",children:"Failed"})]})]})}),s?a.jsx("div",{className:"flex justify-center py-20",children:a.jsx("div",{className:"w-8 h-8 border-2 border-accent border-t-transparent rounded-full animate-spin"})}):r?a.jsx("div",{className:"text-center py-20 text-red-500 bg-red-500/10 rounded-3xl border border-red-500/20",children:"Failed to load thumbnails. Please try again."}):n.length===0?a.jsxs("div",{className:"text-center py-20 bg-white/5 rounded-3xl border border-white/5 mx-auto max-w-lg",children:[a.jsx("div",{className:"text-5xl mb-6",children:""}),a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No thumbnails yet"}),a.jsx("p",{className:"text-text-secondary mb-6",children:"Create your first eye-catching thumbnail to get started"}),a.jsx(te,{to:"/thumbnails/new",className:"px-8 py-3 bg-accent text-white rounded-full font-bold hover:bg-accent-hover transition-colors shadow-glow",children:"Create Thumbnail"})]}):a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6",children:n.map((d,h)=>a.jsx(Ng,{thumbnail:d,index:h},d.id))}),n.length>0&&a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-white/10",children:[a.jsx("button",{onClick:()=>e({...i,page:i.page-1}),disabled:i.page===1,className:"px-6 py-2 rounded-full border border-white/10 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-all",children:"Previous"}),a.jsxs("span",{className:"text-text-secondary",children:["Page ",i.page]}),a.jsx("button",{onClick:()=>e({...i,page:i.page+1}),disabled:!o,className:"px-6 py-2 rounded-full bg-white text-black hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium",children:"Next"})]})]})}function Ng({thumbnail:i,index:e}){const t={pending:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",generating:"bg-blue-500/20 text-blue-300 border-blue-500/30",completed:"bg-green-500/20 text-green-300 border-green-500/30",failed:"bg-red-500/20 text-red-300 border-red-500/30"};return a.jsx(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:e*.05},children:a.jsxs(te,{to:`/thumbnails/${i.id}`,className:"group block glass-card rounded-2xl overflow-hidden hover:border-white/20 hover:scale-[1.02] transition-all duration-300",children:[a.jsxs("div",{className:"relative aspect-video bg-surface/50",children:[i.output_url?a.jsx("img",{src:i.output_url,alt:i.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.status==="generating"?a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx(jo,{className:"animate-spin text-accent",size:32}),a.jsx("span",{className:"text-xs text-text-tertiary",children:"Generating..."})]}):a.jsx("span",{className:"text-4xl opacity-50",children:""})}),i.status==="completed"&&a.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3 backdrop-blur-sm",children:[a.jsx("button",{className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:a.jsx(cu,{size:20})}),a.jsx("button",{className:"p-2 rounded-full bg-white text-black hover:scale-110 transition-transform",children:a.jsx(nu,{size:20})})]}),a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded border ${t[i.status]||"bg-gray-500/20 text-gray-400 border-gray-500/30"}`,children:i.status})})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-medium text-white truncate text-sm",children:i.title}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-text-tertiary",children:[a.jsx("span",{className:"capitalize px-2 py-0.5 rounded bg-white/5",children:i.style||"Custom"}),i.download_count>0&&a.jsxs("span",{children:[i.download_count," saved"]})]})]})]})})}function b(i,e,t){return(e=function(s){var r=function(n,o){if(typeof n!="object"||!n)return n;var l=n[Symbol.toPrimitive];if(l!==void 0){var c=l.call(n,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}(s,"string");return typeof r=="symbol"?r:r+""}(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Bn(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,s)}return t}function v(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bn(Object(t),!0).forEach(function(s){b(i,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Bn(Object(t)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(t,s))})}return i}function re(i,e){if(i==null)return{};var t,s,r=function(o,l){if(o==null)return{};var c={};for(var d in o)if({}.hasOwnProperty.call(o,d)){if(l.indexOf(d)>=0)continue;c[d]=o[d]}return c}(i,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);for(s=0;s<n.length;s++)t=n[s],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function jt(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}class Hn{constructor(){b(this,"browserShadowBlurConstant",1),b(this,"DPI",96),b(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),b(this,"perfLimitSizeTotal",2097152),b(this,"maxCacheSideLimit",4096),b(this,"minCacheSideLimit",256),b(this,"disableStyleCopyPaste",!1),b(this,"enableGLFiltering",!0),b(this,"textureSize",4096),b(this,"forceGLPutImageData",!1),b(this,"cachesBoundsOfCurve",!1),b(this,"fontPaths",{}),b(this,"NUM_FRACTION_DIGITS",4)}}const q=new class extends Hn{constructor(i){super(),this.configure(i)}configure(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,i)}addFonts(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=v(v({},this.fontPaths),i)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(i=>{delete this.fontPaths[i]})}clearFonts(){this.fontPaths={}}restoreDefaults(i){const e=new Hn,t=(i==null?void 0:i.reduce((s,r)=>(s[r]=e[r],s),{}))||e;this.configure(t)}},bt=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return console[i]("fabric",...t)};class Ke extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class Tg extends Ke{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class Og{}class Eg extends Og{testPrecision(e,t){const s="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,s),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(s=>this.testPrecision(t,s)),t.getExtension("WEBGL_lose_context").loseContext(),bt("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const Dg={};let zn;const Qe=()=>zn||(zn={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Eg,dispose(){},copyPasteData:Dg}),es=()=>Qe().document,Vi=()=>Qe().window,So=()=>{var i;return Math.max((i=q.devicePixelRatio)!==null&&i!==void 0?i:Vi().devicePixelRatio,1)},cs=new class{constructor(){b(this,"charWidthsCache",{}),b(this,"boundsOfCurveCache",{})}getFontCache(i){let{fontFamily:e,fontStyle:t,fontWeight:s}=i;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const r=this.charWidthsCache[e],n="".concat(t.toLowerCase(),"_").concat((s+"").toLowerCase());return r[n]||(r[n]={}),r[n]}clearFontCache(i){(i=(i||"").toLowerCase())?this.charWidthsCache[i]&&delete this.charWidthsCache[i]:this.charWidthsCache={}}limitDimsByArea(i){const{perfLimitSizeTotal:e}=q,t=Math.sqrt(e*i);return[Math.floor(t),Math.floor(e/t)]}},wi="6.6.1";function cr(){}const Ss=Math.PI/2,fr=2*Math.PI,Ui=Math.PI/180,_e=Object.freeze([1,0,0,1,0,0]),$i=16,pt=.4477152502,Y="center",J="left",Ne="top",ji="bottom",le="right",Te="none",Yi=/\r?\n/,ko="moving",Lr="scaling",No="rotating",Xi="rotate",To="skewing",ms="resizing",Ag="modifyPoly",Mg="modifyPath",xr="changed",Rr="scale",Ee="scaleX",Fe="scaleY",ts="skewX",ss="skewY",ge="fill",Oe="stroke",yr="modified",Rt="json",Zr="svg",L=new class{constructor(){this[Rt]=new Map,this[Zr]=new Map}has(i){return this[Rt].has(i)}getClass(i){const e=this[Rt].get(i);if(!e)throw new Ke("No class registered for ".concat(i));return e}setClass(i,e){e?this[Rt].set(e,i):(this[Rt].set(i.type,i),this[Rt].set(i.type.toLowerCase(),i))}getSVGClass(i){return this[Zr].get(i)}setSVGClass(i,e){this[Zr].set(e??i.type.toLowerCase(),i)}},br=new class extends Array{remove(i){const e=this.indexOf(i);e>-1&&this.splice(e,1)}cancelAll(){const i=this.splice(0);return i.forEach(e=>e.abort()),i}cancelByCanvas(i){if(!i)return[];const e=this.filter(t=>{var s;return t.target===i||typeof t.target=="object"&&((s=t.target)===null||s===void 0?void 0:s.canvas)===i});return e.forEach(t=>t.abort()),e}cancelByTarget(i){if(!i)return[];const e=this.filter(t=>t.target===i);return e.forEach(t=>t.abort()),e}};class Pg{constructor(){b(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(s=>{let[r,n]=s;this.on(r,n)}),()=>this.off(e);if(t){const s=e;return this.__eventListeners[s]||(this.__eventListeners[s]=[]),this.__eventListeners[s].push(t),()=>this.off(s,t)}return()=>!1}once(e,t){if(typeof e=="object"){const s=[];return Object.entries(e).forEach(r=>{let[n,o]=r;s.push(this.once(n,o))}),()=>s.forEach(r=>r())}if(t){const s=this.on(e,function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];t.call(this,...n),s()});return s}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const s=this.__eventListeners[e],r=s.indexOf(t);r>-1&&s.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const s in this.__eventListeners)this._removeEventListener(s);else typeof e=="object"?Object.entries(e).forEach(s=>{let[r,n]=s;this._removeEventListener(r,n)}):this._removeEventListener(e,t)}fire(e,t){var s;if(!this.__eventListeners)return;const r=(s=this.__eventListeners[e])===null||s===void 0?void 0:s.concat();if(r)for(let n=0;n<r.length;n++)r[n].call(this,t||{})}}const Bt=(i,e)=>{const t=i.indexOf(e);return t!==-1&&i.splice(t,1),i},ct=i=>{if(i===0)return 1;switch(Math.abs(i)/Ss){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},ht=i=>{if(i===0)return 0;const e=i/Ss,t=Math.sign(i);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(i)};class _{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new _(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new _(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new _(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new _(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new _(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new _(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new _(this.x/e.x,this.y/e.y)}scalarDivide(e){return new _(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new _(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,s=this.y-e.y;return Math.sqrt(t*t+s*s)}midPointFrom(e){return this.lerp(e)}min(e){return new _(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new _(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,s=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=s}clone(){return new _(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gi;const s=ht(e),r=ct(e),n=this.subtract(t);return new _(n.x*r-n.y*s,n.x*s+n.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new _(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Gi=new _(0,0),hr=i=>!!i&&Array.isArray(i._objects);function Oo(i){class e extends i{constructor(){super(...arguments),b(this,"_objects",[])}_onObjectAdded(s){}_onObjectRemoved(s){}_onStackOrderChanged(s){}add(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];const o=this._objects.push(...r);return r.forEach(l=>this._onObjectAdded(l)),o}insertAt(s){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return this._objects.splice(s,0,...n),n.forEach(l=>this._onObjectAdded(l)),this._objects.length}remove(){const s=this._objects,r=[];for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return o.forEach(c=>{const d=s.indexOf(c);d!==-1&&(s.splice(d,1),r.push(c),this._onObjectRemoved(c))}),r}forEachObject(s){this.getObjects().forEach((r,n,o)=>s(r,n,o))}getObjects(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return r.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...r))}item(s){return this._objects[s]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(s,r){return!!this._objects.includes(s)||!!r&&this._objects.some(n=>n instanceof e&&n.contains(s,!0))}complexity(){return this._objects.reduce((s,r)=>s+=r.complexity?r.complexity():0,0)}sendObjectToBack(s){return!(!s||s===this._objects[0])&&(Bt(this._objects,s),this._objects.unshift(s),this._onStackOrderChanged(s),!0)}bringObjectToFront(s){return!(!s||s===this._objects[this._objects.length-1])&&(Bt(this._objects,s),this._objects.push(s),this._onStackOrderChanged(s),!0)}sendObjectBackwards(s,r){if(!s)return!1;const n=this._objects.indexOf(s);if(n!==0){const o=this.findNewLowerIndex(s,n,r);return Bt(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}bringObjectForward(s,r){if(!s)return!1;const n=this._objects.indexOf(s);if(n!==this._objects.length-1){const o=this.findNewUpperIndex(s,n,r);return Bt(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}moveObjectTo(s,r){return s!==this._objects[r]&&(Bt(this._objects,s),this._objects.splice(r,0,s),this._onStackOrderChanged(s),!0)}findNewLowerIndex(s,r,n){let o;if(n){o=r;for(let l=r-1;l>=0;--l)if(s.isOverlapping(this._objects[l])){o=l;break}}else o=r-1;return o}findNewUpperIndex(s,r,n){let o;if(n){o=r;for(let l=r+1;l<this._objects.length;++l)if(s.isOverlapping(this._objects[l])){o=l;break}}else o=r+1;return o}collectObjects(s){let{left:r,top:n,width:o,height:l}=s,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],h=new _(r,n),u=h.add(new _(o,l));for(let g=this._objects.length-1;g>=0;g--){const p=this._objects[g];p.selectable&&p.visible&&(c&&p.intersectsWithRect(h,u)||p.isContainedWithinRect(h,u)||c&&p.containsPoint(h)||c&&p.containsPoint(u))&&d.push(p)}return d}}return e}class Eo extends Pg{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function dr(i){return Vi().requestAnimationFrame(i)}function Fg(i){return Vi().cancelAnimationFrame(i)}let Lg=0;const vt=()=>Lg++,Ve=()=>{const i=es().createElement("canvas");if(!i||i.getContext===void 0)throw new Ke("Failed to create `canvas` element");return i},Rg=()=>es().createElement("img"),Ze=i=>{const e=Ve();return e.width=i.width,e.height=i.height,e},Do=(i,e,t)=>i.toDataURL("image/".concat(e),t),Ao=(i,e,t)=>new Promise((s,r)=>{i.toBlob(s,"image/".concat(e),t)}),ce=i=>i*Ui,Mt=i=>i/Ui,Ig=i=>i.every((e,t)=>e===_e[t]),Ce=(i,e,t)=>new _(i).transform(e,t),He=i=>{const e=1/(i[0]*i[3]-i[1]*i[2]),t=[e*i[3],-e*i[1],-e*i[2],e*i[0],0,0],{x:s,y:r}=new _(i[4],i[5]).transform(t,!0);return t[4]=-s,t[5]=-r,t},fe=(i,e,t)=>[i[0]*e[0]+i[2]*e[1],i[1]*e[0]+i[3]*e[1],i[0]*e[2]+i[2]*e[3],i[1]*e[2]+i[3]*e[3],t?0:i[0]*e[4]+i[2]*e[5]+i[4],t?0:i[1]*e[4]+i[3]*e[5]+i[5]],qi=(i,e)=>i.reduceRight((t,s)=>s&&t?fe(s,t,e):s||t,void 0)||_e.concat(),Mo=i=>{let[e,t]=i;return Math.atan2(t,e)},vr=i=>{const e=Mo(i),t=Math.pow(i[0],2)+Math.pow(i[1],2),s=Math.sqrt(t),r=(i[0]*i[3]-i[2]*i[1])/s,n=Math.atan2(i[0]*i[2]+i[1]*i[3],t);return{angle:Mt(e),scaleX:s,scaleY:r,skewX:Mt(n),skewY:0,translateX:i[4]||0,translateY:i[5]||0}},ks=function(i){return[1,0,0,1,i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Ns(){let{angle:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=ce(i),r=ct(s),n=ht(s);return[r,n,-n,r,e?e-(r*e-n*t):0,t?t-(n*e+r*t):0]}const Ki=function(i){return[i,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,0,0]},Po=i=>Math.tan(ce(i)),Fo=i=>[1,0,Po(i),1,0,0],Lo=i=>[1,Po(i),0,1,0,0],Ir=i=>{let{scaleX:e=1,scaleY:t=1,flipX:s=!1,flipY:r=!1,skewX:n=0,skewY:o=0}=i,l=Ki(s?-e:e,r?-t:t);return n&&(l=fe(l,Fo(n),!0)),o&&(l=fe(l,Lo(o),!0)),l},Bg=i=>{const{translateX:e=0,translateY:t=0,angle:s=0}=i;let r=ks(e,t);s&&(r=fe(r,Ns({angle:s})));const n=Ir(i);return Ig(n)||(r=fe(r,n)),r},ur=function(i){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(s,r){if(e&&e.aborted)return r(new Tg("loadImage"));const n=Rg();let o;e&&(o=function(c){n.src="",r(c)},e.addEventListener("abort",o,{once:!0}));const l=function(){n.onload=n.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),s(n)};i?(n.onload=l,n.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),r(new Ke("Error loading ".concat(n.src)))},t&&(n.crossOrigin=t),n.src=i):l()})},ps=function(i){let{signal:e,reviver:t=cr}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((s,r)=>{const n=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(i.map(o=>L.getClass(o.type).fromObject(o,{signal:e}).then(l=>(t(o,l),n.push(l),l)))).then(s).catch(o=>{n.forEach(l=>{l.dispose&&l.dispose()}),r(o)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},Br=function(i){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,s)=>{const r=[];e&&e.addEventListener("abort",s,{once:!0});const n=Object.values(i).map(l=>l&&l.type&&L.has(l.type)?ps([l],{signal:e}).then(c=>{let[d]=c;return r.push(d),d}):l),o=Object.keys(i);Promise.all(n).then(l=>l.reduce((c,d,h)=>(c[o[h]]=d,c),{})).then(t).catch(l=>{r.forEach(c=>{c.dispose&&c.dispose()}),s(l)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},rs=function(i){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in i&&(e[t]=i[t]),e),{})},Ji=(i,e)=>Object.keys(i).reduce((t,s)=>(e(i[s],s,i)&&(t[s]=i[s]),t),{}),Wn={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},ei=(i,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+(e-i)*(2/3-t)*6:i),Vn=(i,e,t,s)=>{i/=255,e/=255,t/=255;const r=Math.max(i,e,t),n=Math.min(i,e,t);let o,l;const c=(r+n)/2;if(r===n)o=l=0;else{const d=r-n;switch(l=c>.5?d/(2-r-n):d/(r+n),r){case i:o=(e-t)/d+(e<t?6:0);break;case e:o=(t-i)/d+2;break;case t:o=(i-e)/d+4}o/=6}return[Math.round(360*o),Math.round(100*l),Math.round(100*c),s]},Un=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(i)/(i.endsWith("%")?100:1)},Ms=i=>Math.min(Math.round(i),255).toString(16).toUpperCase().padStart(2,"0"),$n=i=>{let[e,t,s,r=1]=i;const n=Math.round(.3*e+.59*t+.11*s);return[n,n,n,r]};class Z{constructor(e){if(b(this,"isUnrecognised",!1),e)if(e instanceof Z)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,s,r,n=1]=e;this.setSource([t,s,r,n])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Wn&&(e=Wn[e]),e==="transparent"?[255,255,255,0]:Z.sourceFromHex(e)||Z.sourceFromRgb(e)||Z.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,s]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(s,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,s]=Vn(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(s,"%)")}toHsla(){const[e,t,s,r]=Vn(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(s,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,s,r]=this.getSource();return"".concat(Ms(e)).concat(Ms(t)).concat(Ms(s)).concat(Ms(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource($n(this.getSource())),this}toBlackWhite(e){const[t,,,s]=$n(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,s]),this}overlayWith(e){e instanceof Z||(e=new Z(e));const t=this.getSource(),s=e.getSource(),[r,n,o]=t.map((l,c)=>Math.round(.5*l+.5*s[c]));return this.setSource([r,n,o,t[3]]),this}static fromRgb(e){return Z.fromRgba(e)}static fromRgba(e){return new Z(Z.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[s,r,n]=t.slice(1,4).map(o=>{const l=parseFloat(o);return o.endsWith("%")?Math.round(2.55*l):l});return[s,r,n,Un(t[4])]}}static fromHsl(e){return Z.fromHsla(e)}static fromHsla(e){return new Z(Z.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const s=(Z.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,n=parseFloat(t[3])/100;let o,l,c;if(r===0)o=l=c=n;else{const d=n<=.5?n*(r+1):n+r-n*r,h=2*n-d;o=ei(h,d,s+1/3),l=ei(h,d,s),c=ei(h,d,s-1/3)}return[Math.round(255*o),Math.round(255*l),Math.round(255*c),Un(t[4])]}static fromHex(e){return new Z(Z.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let s;s=t.length<=4?t.split("").map(c=>c+c):t.match(/.{2}/g);const[r,n,o,l=255]=s.map(c=>parseInt(c,16));return[r,n,o,l/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),s=parseFloat(t);return t.includes("rad")?Mt(s):t.includes("turn")?360*s:s}}const ae=(i,e)=>parseFloat(Number(i).toFixed(e)),Ut=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$i;const t=/\D{0,2}$/.exec(i),s=parseFloat(i),r=q.DPI;switch(t==null?void 0:t[0]){case"mm":return s*r/25.4;case"cm":return s*r/2.54;case"in":return s*r;case"pt":return s*r/72;case"pc":return s*r/72*12;case"em":return s*e;default:return s}},Hg=i=>{const[e,t]=i.trim().split(" "),[s,r]=(n=e)&&n!==Te?[n.slice(1,4),n.slice(5,8)]:n===Te?[n,n]:["Mid","Mid"];var n;return{meetOrSlice:t||"meet",alignX:s,alignY:r}},wr=i=>"matrix("+i.map(e=>ae(e,q.NUM_FRACTION_DIGITS)).join(" ")+")",fs=function(i,e){let t,s,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const n=new Z(e),o=n.getAlpha();t=n.toRgb(),o!==1&&(s=o.toString())}else t="none";return r?"".concat(i,": ").concat(t,"; ").concat(s?"".concat(i,"-opacity: ").concat(s,"; "):""):"".concat(i,'="').concat(t,'" ').concat(s?"".concat(i,'-opacity="').concat(s,'" '):"")},Me=i=>!!i&&i.toLive!==void 0,Yn=i=>!!i&&typeof i.toObject=="function",Xn=i=>!!i&&i.offsetX!==void 0&&"source"in i,Ct=i=>!!i&&"multiSelectionStacking"in i;function Ro(i){const e=i&&Be(i);let t=0,s=0;if(!i||!e)return{left:t,top:s};let r=i;const n=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=o.scrollLeft||n.scrollLeft||0,s=o.scrollTop||n.scrollTop||0):(t+=r.scrollLeft||0,s+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:s}}const Be=i=>i.ownerDocument||null,Io=i=>{var e;return((e=i.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},Bo=function(i,e,t){let{width:s,height:r}=t,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;i.width=s,i.height=r,n>1&&(i.setAttribute("width",(s*n).toString()),i.setAttribute("height",(r*n).toString()),e.scale(n,n))},_i=(i,e)=>{let{width:t,height:s}=e;t&&(i.style.width=typeof t=="number"?"".concat(t,"px"):t),s&&(i.style.height=typeof s=="number"?"".concat(s,"px"):s)};function Gn(i){return i.onselectstart!==void 0&&(i.onselectstart=()=>!1),i.style.userSelect=Te,i}class Ho{constructor(e){b(this,"_originalCanvasStyle",void 0),b(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(s=e)&&s.getContext!==void 0?e:e&&es().getElementById(e)||Ve();var s;if(t.hasAttribute("data-fabric"))throw new Ke("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:s}=e;const{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(s)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:s,ctx:r}=this.lower;Bo(s,r,e,t)}setCSSDimensions(e){_i(this.lower.el,e)}calcOffset(){return function(e){var t;const s=e&&Be(e),r={left:0,top:0};if(!s)return r;const n=((t=Io(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(n.borderLeftWidth,10)||0,r.top+=parseInt(n.borderTopWidth,10)||0,r.left+=parseInt(n.paddingLeft,10)||0,r.top+=parseInt(n.paddingTop,10)||0;let o={left:0,top:0};const l=s.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const c=Ro(e);return{left:o.left+c.left-(l.clientLeft||0)+r.left,top:o.top+c.top-(l.clientTop||0)+r.top}}(this.lower.el)}dispose(){Qe().dispose(this.lower.el),delete this.lower}}const zg={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[..._e]};class Ts extends Oo(Eo){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Ts.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Ho(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];const n=super.insertAt(e,...s);return s.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),n}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(bt("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?So():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:s=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const r=v({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}s||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const s=e,r=[...this.viewportTransform],n=Ce(e,He(r));r[0]=t,r[3]=t;const o=Ce(n,r);r[4]+=s.x-o.x,r[5]+=s.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new _(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new _(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=dr(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,s=He(this.viewportTransform),r=Ce({x:0,y:0},s),n=Ce({x:e,y:t},s),o=r.min(n),l=r.max(n);return this.vptCoords={tl:o,tr:new _(l.x,o.y),bl:new _(o.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(Fg(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const s=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const s=this.viewportTransform;e.save(),e.transform(...s),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let s=0,r=t.length;s<r;++s)t[s]&&t[s].render(e)}_renderBackgroundOrOverlay(e,t){const s=this["".concat(t,"Color")],r=this["".concat(t,"Image")],n=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!s&&!r)return;const l=Me(s);if(s){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=l?s.toLive(e):s,o&&e.transform(...n),l){e.transform(1,0,0,1,s.offsetX||0,s.offsetY||0);const c=s.gradientTransform||s.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(r){e.save();const{skipOffscreen:c}=this;this.skipOffscreen=o,o&&e.transform(...n),r.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new _(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new _(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new _(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new _(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new _(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Ce(this.getCenterPoint(),He(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Y,Y),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const s=this.clipPath,r=s&&!s.excludeFromExport?this._toObject(s,e,t):null;return v(v(v({version:wi},rs(this,t)),{},{objects:this._objects.filter(n=>!n.excludeFromExport).map(n=>this._toObject(n,e,t))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,s){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);const n=e[t](s);return this.includeDefaultValues||(e.includeDefaultValues=!!r),n}__serializeBgOverlay(e,t){const s={},r=this.backgroundImage,n=this.overlayImage,o=this.backgroundColor,l=this.overlayColor;return Me(o)?o.excludeFromExport||(s.background=o.toObject(t)):o&&(s.background=o),Me(l)?l.excludeFromExport||(s.overlay=l.toObject(t)):l&&(s.overlay=l),r&&!r.excludeFromExport&&(s.backgroundImage=this._toObject(r,e,t)),n&&!n.excludeFromExport&&(s.overlayImage=this._toObject(n,e,t)),s}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const s=[];return this._setSVGPreamble(s,e),this._setSVGHeader(s,e),this.clipPath&&s.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(s,"background"),this._setSVGBgOverlayImage(s,"backgroundImage",t),this._setSVGObjects(s,t),this.clipPath&&s.push(`</g>
`),this._setSVGBgOverlayColor(s,"overlay"),this._setSVGBgOverlayImage(s,"overlayImage",t),s.push("</svg>"),s.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const s=t.width||"".concat(this.width),r=t.height||"".concat(this.height),n=q.NUM_FRACTION_DIGITS,o=t.viewBox;let l;if(o)l='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const c=this.viewportTransform;l='viewBox="'.concat(ae(-c[4]/c[0],n)," ").concat(ae(-c[5]/c[3],n)," ").concat(ae(this.width/c[0],n)," ").concat(ae(this.height/c[3],n),'" ')}else l='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',s,'" ','height="',r,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",wi,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(vt()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Me(t)){const s=this["".concat(e,"Vpt")],r=this.viewportTransform,n={isType:()=>!1,width:this.width/(s?r[0]:1),height:this.height/(s?r[3]:1)};return t.toSVG(n,{additionalTransform:s?wr(r):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},s=q.fontPaths;this._objects.forEach(function n(o){e.push(o),hr(o)&&o._objects.forEach(n)}),e.forEach(n=>{if(!(o=n)||typeof o._renderText!="function")return;var o;const{styles:l,fontFamily:c}=n;!t[c]&&s[c]&&(t[c]=!0,l&&Object.values(l).forEach(d=>{Object.values(d).forEach(h=>{let{fontFamily:u=""}=h;!t[u]&&s[u]&&(t[u]=!0)})}))});const r=Object.keys(t).map(n=>`		@font-face {
			font-family: '`.concat(n,`';
			src: url('`).concat(s[n],`');
		}
`)).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(s=>{s.excludeFromExport||this._setSVGObject(e,s,t)})}_setSVGObject(e,t,s){e.push(t.toSVG(s))}_setSVGBgOverlayImage(e,t,s){const r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(s))}_setSVGBgOverlayColor(e,t){const s=this["".concat(t,"Color")];if(s)if(Me(s)){const r=s.repeat||"",n=this.width,o=this.height,l=this["".concat(t,"Vpt")]?wr(He(this.viewportTransform)):"";e.push('<rect transform="'.concat(l," translate(").concat(n/2,",").concat(o/2,')" x="').concat(s.offsetX-n/2,'" y="').concat(s.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!Xn(s)?n:s.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!Xn(s)?o:s.source.height,'" fill="url(#SVGID_').concat(s.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',s,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:s}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Ke("`json` is undefined"));const r=typeof e=="string"?JSON.parse(e):e,{objects:n=[],backgroundImage:o,background:l,overlayImage:c,overlay:d,clipPath:h}=r,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([ps(n,{reviver:t,signal:s}),Br({backgroundImage:o,backgroundColor:l,overlayImage:c,overlayColor:d,clipPath:h},{signal:s})]).then(g=>{let[p,m]=g;return this.clear(),this.add(...p),this.set(r),this.set(m),this.renderOnAddRemove=u,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Ze(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:s=1,multiplier:r=1,enableRetinaScaling:n=!1}=e,o=r*(n?this.getRetinaScaling():1);return Do(this.toCanvasElement(o,e),t,s)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:s=1,multiplier:r=1,enableRetinaScaling:n=!1}=e,o=r*(n?this.getRetinaScaling():1);return Ao(this.toCanvasElement(o,e),t,s)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:s,left:r,top:n,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=(t||this.width)*e,c=(s||this.height)*e,d=this.getZoom(),h=this.width,u=this.height,g=this.skipControlsDrawing,p=d*e,m=this.viewportTransform,x=[p,0,0,p,(m[4]-(r||0))*e,(m[5]-(n||0))*e],f=this.enableRetinaScaling,y=Ze({width:l,height:c}),w=o?this._objects.filter(j=>o(j)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=x,this.width=l,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(y.getContext("2d"),w),this.viewportTransform=m,this.width=h,this.height=u,this.calcViewportBoundaries(),this.enableRetinaScaling=f,this.skipControlsDrawing=g,y}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),br.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const s=()=>{this.destroy(),e(!0)};s.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=s:s()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}b(Ts,"ownDefaults",zg);const Wg=["touchstart","touchmove","touchend"],Vg=i=>{const e=Ro(i.target),t=function(s){const r=s.changedTouches;return r&&r[0]?r[0]:s}(i);return new _(t.clientX+e.left,t.clientY+e.top)},Ci=i=>Wg.includes(i.type)||i.pointerType==="touch",Si=i=>{i.preventDefault(),i.stopPropagation()},ot=i=>{let e=0,t=0,s=0,r=0;for(let n=0,o=i.length;n<o;n++){const{x:l,y:c}=i[n];(l>s||!n)&&(s=l),(l<e||!n)&&(e=l),(c>r||!n)&&(r=c),(c<t||!n)&&(t=c)}return{left:e,top:t,width:s-e,height:r-t}},Ug=["translateX","translateY","scaleX","scaleY"],$g=(i,e)=>jr(i,fe(e,i.calcOwnMatrix())),jr=(i,e)=>{const t=vr(e),{translateX:s,translateY:r,scaleX:n,scaleY:o}=t,l=re(t,Ug),c=new _(s,r);i.flipX=!1,i.flipY=!1,Object.assign(i,l),i.set({scaleX:n,scaleY:o}),i.setPositionByOrigin(c,Y,Y)},Yg=i=>{i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},zo=i=>({scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}),Qi=(i,e,t)=>{const s=i/2,r=e/2,n=[new _(-s,-r),new _(s,-r),new _(-s,r),new _(s,r)].map(l=>l.transform(t)),o=ot(n);return new _(o.width,o.height)},Hr=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_e;return fe(He(arguments.length>1&&arguments[1]!==void 0?arguments[1]:_e),i)},$t=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_e,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_e;return i.transform(Hr(e,t))},Xg=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_e,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_e;return i.transform(Hr(e,t),!0)},Gg=(i,e,t)=>{const s=Hr(e,t);return jr(i,fe(s,i.calcOwnMatrix())),s},Wo=(i,e)=>{var t;const{transform:{target:s}}=e;(t=s.canvas)===null||t===void 0||t.fire("object:".concat(i),v(v({},e),{},{target:s})),s.fire(i,e)},qg={left:-.5,top:-.5,center:0,bottom:.5,right:.5},ue=i=>typeof i=="string"?qg[i]:i-.5,_r="not-allowed";function Vo(i){return ue(i.originX)===ue(Y)&&ue(i.originY)===ue(Y)}function qn(i){return .5-ue(i)}const We=(i,e)=>i[e],Uo=(i,e,t,s)=>({e:i,transform:e,pointer:new _(t,s)});function $o(i,e){const t=i.getTotalAngle()+Mt(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function Zi(i,e,t,s,r){var n;let{target:o,corner:l}=i;const c=o.controls[l],d=((n=o.canvas)===null||n===void 0?void 0:n.getZoom())||1,h=o.padding/d,u=function(g,p,m,x){const f=g.getRelativeCenterPoint(),y=m!==void 0&&x!==void 0?g.translateToGivenOrigin(f,Y,Y,m,x):new _(g.left,g.top);return(g.angle?p.rotate(-ce(g.angle),f):p).subtract(y)}(o,new _(s,r),e,t);return u.x>=h&&(u.x-=h),u.x<=-h&&(u.x+=h),u.y>=h&&(u.y-=h),u.y<=h&&(u.y+=h),u.x-=c.offsetX,u.y-=c.offsetY,u}const Kg=(i,e,t,s)=>{const{target:r,offsetX:n,offsetY:o}=e,l=t-n,c=s-o,d=!We(r,"lockMovementX")&&r.left!==l,h=!We(r,"lockMovementY")&&r.top!==c;return d&&r.set(J,l),h&&r.set(Ne,c),(d||h)&&Wo(ko,Uo(i,e,t,s)),d||h};class Yo{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",s=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):Te,n=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",h=this.visible?"":" visibility: hidden;",u=e?"":this.getSvgFilter(),g=fs(ge,this.fill);return[fs(Oe,this.stroke),"stroke-width: ",s,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",n,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",c,"; ",g,"fill-rule: ",t,"; ","opacity: ",d,";",u,h].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const s=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(wr(s));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),n=e.indexOf("COMMON_PARTS");return e[n]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:s,withShadow:r,additionalTransform:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),l=r?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=c&&c.absolutePositioned,u=this.stroke,g=this.fill,p=this.shadow,m=[],x=e.indexOf("COMMON_PARTS");let f;c&&(c.clipPathId="CLIPPATH_".concat(vt()),f='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(s),`</clipPath>
`)),h&&m.push("<g ",l,this.getSvgCommons(),` >
`),m.push("<g ",this.getSvgTransform(!1),h?"":l+this.getSvgCommons(),` >
`);const y=[o,d,t?"":this.addPaintOrder()," ",n?'transform="'.concat(n,'" '):""].join("");return e[x]=y,Me(g)&&m.push(g.toSVG(this)),Me(u)&&m.push(u.toSVG(this)),p&&m.push(p.toSVG(this)),c&&m.push(f),m.push(e.join("")),m.push(`</g>
`),h&&m.push(`</g>
`),s?s(m.join("")):m.join("")}addPaintOrder(){return this.paintFirst!==ge?' paint-order="'.concat(this.paintFirst,'" '):""}}function zr(i){return new RegExp("^("+i.join("|")+")\\b","i")}var Kn;const Pt=String.raw(Kn||(Kn=jt(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),Jg=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Pt+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Pt+"))?\\s+(.*)"),Qg={cx:J,x:J,r:"radius",cy:Ne,y:Ne,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},ti="font-size",si="clip-path";zr(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);zr(["symbol","image","marker","pattern","view","svg"]);const Jn=zr(["symbol","g","a","svg","clipPath","defs"]),Zg=new _(1,0),Xo=new _,Go=(i,e)=>i.rotate(e),ki=(i,e)=>new _(e).subtract(i),Ni=i=>i.distanceFrom(Xo),Ti=(i,e)=>Math.atan2(hs(i,e),tm(i,e)),em=i=>Ti(Zg,i),en=i=>i.eq(Xo)?i:i.scalarDivide(Ni(i)),qo=function(i){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return en(new _(-i.y,i.x).scalarMultiply(e?1:-1))},hs=(i,e)=>i.x*e.y-i.y*e.x,tm=(i,e)=>i.x*e.x+i.y*e.y,Qn=(i,e,t)=>{if(i.eq(e)||i.eq(t))return!0;const s=hs(e,t),r=hs(e,i),n=hs(t,i);return s>=0?r>=0&&n<=0:!(r<=0&&n>=0)},Zn="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",ea=new RegExp("(?:\\s|^)"+Zn+Zn+"("+Pt+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Je{constructor(e){const t=typeof e=="string"?Je.parseShadow(e):e;Object.assign(this,Je.ownDefaults,t),this.id=vt()}static parseShadow(e){const t=e.trim(),[,s=0,r=0,n=0]=(ea.exec(t)||[]).map(o=>parseFloat(o)||0);return{color:(t.replace(ea,"")||"rgb(0,0,0)").trim(),offsetX:s,offsetY:r,blur:n}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=Go(new _(this.offsetX,this.offsetY),ce(-e.angle)),s=new Z(this.color);let r=40,n=40;return e.width&&e.height&&(r=100*ae((Math.abs(t.x)+this.blur)/e.width,q.NUM_FRACTION_DIGITS)+20,n=100*ae((Math.abs(t.y)+this.blur)/e.height,q.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(n,'%" height="').concat(100+2*n,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(ae(this.blur?this.blur/2:0,q.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(ae(t.x,q.NUM_FRACTION_DIGITS),'" dy="').concat(ae(t.y,q.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(s.toRgb(),'" flood-opacity="').concat(s.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=Je.ownDefaults;return this.includeDefaultValues?e:Ji(e,(s,r)=>s!==t[r])}static async fromObject(e){return new this(e)}}b(Je,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),b(Je,"type","shadow"),L.setClass(Je,"shadow");const Jt=(i,e,t)=>Math.max(i,Math.min(e,t)),sm=[Ne,J,Ee,Fe,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",ts,ss],dt=[ge,Oe,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],rm={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:J,originY:Ne,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:ge,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},im=(i,e,t,s)=>-t*Math.cos(i/s*Ss)+t+e,nm=()=>!1;class tn{constructor(e){let{startValue:t,byValue:s,duration:r=500,delay:n=0,easing:o=im,onStart:l=cr,onChange:c=cr,onComplete:d=cr,abort:h=nm,target:u}=e;b(this,"_state","pending"),b(this,"durationProgress",0),b(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=n,this.easing=o,this._onStart=l,this._onChange=c,this._onComplete=d,this._abort=h,this.target=u,this.startValue=t,this.byValue=s,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>dr(e),this.delay):dr(e)}tick(e){const t=(e||+new Date)-this.startTime,s=Math.min(t,this.duration);this.durationProgress=s/this.duration;const{value:r,valueProgress:n}=this.calculate(s);this.value=Object.freeze(r),this.valueProgress=n,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),dr(this.tick)))}register(){br.push(this)}unregister(){br.remove(this)}abort(){this._state="aborted",this.unregister()}}const am=["startValue","endValue"];class om extends tn{constructor(e){let{startValue:t=0,endValue:s=100}=e;super(v(v({},re(e,am)),{},{startValue:t,byValue:s-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const lm=["startValue","endValue"];class cm extends tn{constructor(e){let{startValue:t=[0],endValue:s=[100]}=e;super(v(v({},re(e,lm)),{},{startValue:t,byValue:s.map((r,n)=>r-t[n])}))}calculate(e){const t=this.startValue.map((s,r)=>this.easing(e,s,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const hm=["startValue","endValue","easing","onChange","onComplete","abort"],dm=(i,e,t,s)=>e+t*(1-Math.cos(i/s*Ss)),ri=i=>i&&((e,t,s)=>i(new Z(e).toRgba(),t,s));class um extends tn{constructor(e){let{startValue:t,endValue:s,easing:r=dm,onChange:n,onComplete:o,abort:l}=e,c=re(e,hm);const d=new Z(t).getSource(),h=new Z(s).getSource();super(v(v({},c),{},{startValue:d,byValue:h.map((u,g)=>u-d[g]),easing:r,onChange:ri(n),onComplete:ri(o),abort:ri(l)}))}calculate(e){const[t,s,r,n]=this.startValue.map((l,c)=>this.easing(e,l,this.byValue[c],this.duration,c)),o=[...[t,s,r].map(Math.round),Jt(0,n,1)];return{value:o,valueProgress:o.map((l,c)=>this.byValue[c]!==0?Math.abs((l-this.startValue[c])/this.byValue[c]):0).find(l=>l!==0)||0}}}function Ko(i){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(i)?new cm(i):new om(i);return e.start(),e}function gm(i){const e=new um(i);return e.start(),e}class ie{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.points=this.points.concat(t.filter(r=>!this.includes(r))),this}static isPointContained(e,t,s){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(s))return e.eq(t);if(t.x===s.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,s.y)&&e.y<=Math.max(t.y,s.y));if(t.y===s.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,s.x)&&e.x<=Math.max(t.x,s.x));{const n=ki(t,s),o=ki(t,e).divide(n);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const s=new _(e).setX(Math.min(e.x-1,...t.map(n=>n.x)));let r=0;for(let n=0;n<t.length;n++){const o=this.intersectSegmentSegment(t[n],t[(n+1)%t.length],e,s);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,s,r){let n=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const l=t.x-e.x,c=t.y-e.y,d=r.x-s.x,h=r.y-s.y,u=e.x-s.x,g=e.y-s.y,p=d*g-h*u,m=l*g-c*u,x=h*l-d*c;if(x!==0){const f=p/x,y=m/x;return(n||0<=f&&f<=1)&&(o||0<=y&&y<=1)?new ie("Intersection").append(new _(e.x+f*l,e.y+f*c)):new ie}if(p===0||m===0){const f=n||o||ie.isPointContained(e,s,r)||ie.isPointContained(t,s,r)||ie.isPointContained(s,e,t)||ie.isPointContained(r,e,t);return new ie(f?"Coincident":void 0)}return new ie("Parallel")}static intersectSegmentLine(e,t,s,r){return ie.intersectLineLine(e,t,s,r,!1,!0)}static intersectSegmentSegment(e,t,s,r){return ie.intersectLineLine(e,t,s,r,!1,!1)}static intersectLinePolygon(e,t,s){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const n=new ie,o=s.length;for(let l,c,d,h=0;h<o;h++){if(l=s[h],c=s[(h+1)%o],d=ie.intersectLineLine(e,t,l,c,r,!1),d.status==="Coincident")return d;n.append(...d.points)}return n.points.length>0&&(n.status="Intersection"),n}static intersectSegmentPolygon(e,t,s){return ie.intersectLinePolygon(e,t,s,!1)}static intersectPolygonPolygon(e,t){const s=new ie,r=e.length,n=[];for(let o=0;o<r;o++){const l=e[o],c=e[(o+1)%r],d=ie.intersectSegmentPolygon(l,c,t);d.status==="Coincident"?(n.push(d),s.append(l,c)):s.append(...d.points)}return n.length>0&&n.length===e.length?new ie("Coincident"):(s.points.length>0&&(s.status="Intersection"),s)}static intersectPolygonRectangle(e,t,s){const r=t.min(s),n=t.max(s),o=new _(n.x,r.y),l=new _(r.x,n.y);return ie.intersectPolygonPolygon(e,[r,o,n,l])}}class mm extends Eo{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Ce(e,this.group.calcTransformMatrix()):e}setXY(e,t,s){this.group&&(e=Ce(e,He(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,s)}getRelativeXY(){return new _(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,s)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:s,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),n=[e,t,s,r];if(this.group){const o=this.group.calcTransformMatrix();return n.map(l=>Ce(l,o))}return n}intersectsWithRect(e,t){return ie.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=ie.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:s,top:r,width:n,height:o}=this.getBoundingRect();return s>=e.x&&s+n<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return ie.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(s=>s.x<=t.x&&s.x>=e.x&&s.y<=t.y&&s.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(s=>(s.x>=t.x||s.x<=e.x)&&(s.y>=t.y||s.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return ot(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Ee,e),this._set(Fe,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Mt(Mo(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||_e.concat()}calcACoords(){const e=Ns({angle:this.angle}),{x:t,y:s}=this.getRelativeCenterPoint(),r=ks(t,s),n=fe(r,e),o=this._getTransformedDimensions(),l=o.x/2,c=o.y/2;return{tl:Ce({x:-l,y:-c},n),tr:Ce({x:l,y:-c},n),bl:Ce({x:-l,y:c},n),br:Ce({x:l,y:c},n)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,ue(this.originX),ue(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const s=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every((n,o)=>n===s[o])?r.value:(this.group&&(t=fe(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:s,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const s=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:s.x,translateY:s.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},n=Bg(r);return this.ownMatrixCache={key:e,value:n},n}_getNonTransformedDimensions(){return new _(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=v({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),s=t.strokeWidth;let r=s,n=0;this.strokeUniform&&(r=0,n=s);const o=t.width+r,l=t.height+r;let c;return c=t.skewX===0&&t.skewY===0?new _(o*t.scaleX,l*t.scaleY):Qi(o,l,Ir(t)),c.scalarAdd(n)}translateToGivenOrigin(e,t,s,r,n){let o=e.x,l=e.y;const c=ue(r)-ue(t),d=ue(n)-ue(s);if(c||d){const h=this._getTransformedDimensions();o+=c*h.x,l+=d*h.y}return new _(o,l)}translateToCenterPoint(e,t,s){if(t===Y&&s===Y)return e;const r=this.translateToGivenOrigin(e,t,s,Y,Y);return this.angle?r.rotate(ce(this.angle),e):r}translateToOriginPoint(e,t,s){const r=this.translateToGivenOrigin(e,Y,Y,t,s);return this.angle?r.rotate(ce(this.angle),e):r}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Ce(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new _(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,s){const r=this.translateToCenterPoint(e,t,s),n=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:n.x,top:n.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),J,Ne)}}const pm=["type"],fm=["extraParam"];let tt=class gr extends mm{static getDefaults(){return gr.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){bt("warn","Setting type has no effect",e)}constructor(e){super(),b(this,"_cacheContext",null),Object.assign(this,gr.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Ve(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,s=e.height,r=q.maxCacheSideLimit,n=q.minCacheSideLimit;if(t<=r&&s<=r&&t*s<=q.perfLimitSizeTotal)return t<n&&(e.width=n),s<n&&(e.height=n),e;const o=t/s,[l,c]=cs.limitDimsByArea(o),d=Jt(n,l,r),h=Jt(n,c,r);return t>d&&(e.zoomX/=t/d,e.width=d,e.capped=!0),s>h&&(e.zoomY/=s/h,e.height=h,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),s=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(s+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:s,y:r}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:s,height:r,zoomX:n,zoomY:o,x:l,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=s!==e.width||r!==e.height,h=this.zoomX!==n||this.zoomY!==o;if(!e||!t)return!1;if(d||h){s!==e.width||r!==e.height?(e.width=s,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const u=l/2,g=c/2;return this.cacheTranslationX=Math.round(e.width/2-u)+u,this.cacheTranslationY=Math.round(e.height/2-g)+g,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(n,o),this.zoomX=n,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,s=this.calcTransformMatrix(!t);e.transform(s[0],s[1],s[2],s[3],s[4],s[5])}getObjectScaling(){if(!this.group)return new _(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=vr(this.calcTransformMatrix());return new _(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),s=this.getCanvasRetinaScaling();return e.scalarMultiply(t*s)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Ee&&e!==Fe||(t=this._constrainScale(t)),e===Ee&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof Je||(t=new Je(t));const s=this[e]!==t;return this[e]=t,s&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||s&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:s,cacheTranslationX:r,cacheTranslationY:n}=this,{width:o,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:s,cacheTranslationX:r,cacheTranslationY:n,width:o,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Oe&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,s){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0),e.restore()}drawObject(e,t,s){const r=this.fill,n=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,s),this.fill=r,this.stroke=n}createClipPathLayer(e,t){const s=Ze(t),r=s.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=s,t.parentClipPaths.forEach(n=>{n.transform(r)}),t.parentClipPaths.push(e),e.absolutePositioned){const n=He(this.calcTransformMatrix());r.transform(n[0],n[1],n[2],n[3],n[4],n[5])}return e.transform(r),e.drawObject(r,!0,t),s}_drawClipPath(e,t,s){if(!t)return;t._transformDone=!0;const r=this.createClipPathLayer(t,s);this.drawClipPathOnCache(e,t,r)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,s=this._cacheContext;return!(!t||!s||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&s&&!e&&(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),s.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const s=t.stroke;s&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Me(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?this._applyPatternForTransformedGradient(e,s):(e.strokeStyle=s.toLive(e),this._applyPatternGradientTransform(e,s)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:s}=t;s&&(Me(s)?(e.fillStyle=s.toLive(e),this._applyPatternGradientTransform(e,s)):e.fillStyle=s)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,s=this.canvas,r=this.getCanvasRetinaScaling(),[n,,,o]=(s==null?void 0:s.viewportTransform)||_e,l=n*r,c=o*r,d=t.nonScaling?new _(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*q.browserShadowBlurConstant*(l+c)*(d.x+d.y)/4,e.shadowOffsetX=t.offsetX*l*d.x,e.shadowOffsetY=t.offsetY*c*d.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Me(t))return{offsetX:0,offsetY:0};const s=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,n=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,n):e.transform(1,0,0,1,r,n),s&&e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),{offsetX:r,offsetY:n}}_renderPaintInOrder(e){this.paintFirst===Oe?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var s;const r=this._limitCacheSize(this._getCacheCanvasDimensions()),n=this.getCanvasRetinaScaling(),o=r.x/this.scaleX/n,l=r.y/this.scaleY/n,c=Ze({width:Math.ceil(o),height:Math.ceil(l)}),d=c.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(o,0),d.lineTo(o,l),d.lineTo(0,l),d.closePath(),d.translate(o/2,l/2),d.scale(r.zoomX/this.scaleX/n,r.zoomY/this.scaleY/n),this._applyPatternGradientTransform(d,t),d.fillStyle=t.toLive(e),d.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(n*this.scaleX/r.zoomX,n*this.scaleY/r.zoomY),e.strokeStyle=(s=d.createPattern(c,"no-repeat"))!==null&&s!==void 0?s:"")}_findCenterFromElement(){return new _(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(L.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=zo(this),s=this.group,r=this.shadow,n=Math.abs,o=e.enableRetinaScaling?So():1,l=(e.multiplier||1)*o,c=e.canvasProvider||(w=>new Ts(w,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&Yg(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Gg(this,this.getViewportTransform()),this.setCoords();const d=Ve(),h=this.getBoundingRect(),u=this.shadow,g=new _;if(u){const w=u.blur,j=u.nonScaling?new _(1,1):this.getObjectScaling();g.x=2*Math.round(n(u.offsetX)+w)*n(j.x),g.y=2*Math.round(n(u.offsetY)+w)*n(j.y)}const p=h.width+g.x,m=h.height+g.y;d.width=Math.ceil(p),d.height=Math.ceil(m);const x=c(d);e.format==="jpeg"&&(x.backgroundColor="#fff"),this.setPositionByOrigin(new _(x.width/2,x.height/2),Y,Y);const f=this.canvas;x._objects=[this],this.set("canvas",x),this.setCoords();const y=x.toCanvasElement(l||1,e);return this.set("canvas",f),this.shadow=r,s&&(this.group=s),this.set(t),this.setCoords(),x._objects=[],x.destroy(),y}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Do(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ao(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:s,originY:r}=this;if(t){const{x:n,y:o}=this.getRelativeCenterPoint();this.originX=Y,this.originY=Y,this.left=n,this.top=o}if(this.set("angle",e),t){const{x:n,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),s,r);this.left=n,this.top=o,this.originX=s,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){br.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Qe().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((s,r)=>{let[n,o]=r;return s[n]=this._animate(n,o,t),s},{})}_animate(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.split("."),n=this.constructor.colorProperties.includes(r[r.length-1]),{abort:o,startValue:l,onChange:c,onComplete:d}=s,h=v(v({},s),{},{target:this,startValue:l??r.reduce((u,g)=>u[g],this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(u,g,p)=>{r.reduce((m,x,f)=>(f===r.length-1&&(m[x]=u),m[x]),this),c&&c(u,g,p)},onComplete:(u,g,p)=>{this.setCoords(),d&&d(u,g,p)}});return n?gm(h):Ko(h)}isDescendantOf(e){const{parent:t,group:s}=this;return t===e||s===e||!!t&&t.isDescendantOf(e)||!!s&&s!==t&&s.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),s=e.getAncestors();if(t.length===0&&s.length>0&&this===s[s.length-1])return{fork:[],otherFork:[e,...s.slice(0,s.length-1)],common:[this]};for(let r,n=0;n<t.length;n++){if(r=t[n],r===e)return{fork:[this,...t.slice(0,n)],otherFork:[],common:t.slice(n)};for(let o=0;o<s.length;o++){if(this===s[o])return{fork:[],otherFork:[e,...s.slice(0,o)],common:[this,...t]};if(r===s[o])return{fork:[this,...t.slice(0,n)],otherFork:[e,...s.slice(0,o)],common:t.slice(n)}}}return{fork:[this,...t],otherFork:[e,...s],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const s=t.common[0]||this.canvas;if(!s)return;const r=t.fork.pop(),n=t.otherFork.pop(),o=s._objects.indexOf(r),l=s._objects.indexOf(n);return o>-1&&o>l}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(gr.customProperties,this.constructor.customProperties||[]);let t;const s=q.NUM_FRACTION_DIGITS,{clipPath:r,fill:n,stroke:o,shadow:l,strokeDashArray:c,left:d,top:h,originX:u,originY:g,width:p,height:m,strokeWidth:x,strokeLineCap:f,strokeDashOffset:y,strokeLineJoin:w,strokeUniform:j,strokeMiterLimit:T,scaleX:A,scaleY:P,angle:N,flipX:E,flipY:D,opacity:R,visible:O,backgroundColor:W,fillRule:C,paintFirst:M,globalCompositeOperation:U,skewX:$,skewY:Q}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));const H=V=>ae(V,s),F=v(v({},rs(this,e)),{},{type:this.constructor.type,version:wi,originX:u,originY:g,left:H(d),top:H(h),width:H(p),height:H(m),fill:Yn(n)?n.toObject():n,stroke:Yn(o)?o.toObject():o,strokeWidth:H(x),strokeDashArray:c&&c.concat(),strokeLineCap:f,strokeDashOffset:y,strokeLineJoin:w,strokeUniform:j,strokeMiterLimit:H(T),scaleX:H(A),scaleY:H(P),angle:H(N),flipX:E,flipY:D,opacity:H(R),shadow:l&&l.toObject(),visible:O,backgroundColor:W,fillRule:C,paintFirst:M,globalCompositeOperation:U,skewX:H($),skewY:H(Q)},t?{clipPath:t}:null);return this.includeDefaultValues?F:this._removeDefaultValues(F)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),s=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return Ji(e,(r,n)=>{if(n===J||n===Ne||n==="type")return!0;const o=s[n];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=re(e,pm),s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=s,n=re(s,fm);return Br(t,n).then(o=>r?(delete o[r],new this(t[r],o)):new this(o))}static fromObject(e,t){return this._fromObject(e,t)}};b(tt,"stateProperties",sm),b(tt,"cacheProperties",dt),b(tt,"ownDefaults",rm),b(tt,"type","FabricObject"),b(tt,"colorProperties",[ge,Oe,"backgroundColor"]),b(tt,"customProperties",[]),L.setClass(tt),L.setClass(tt,"object");const is=(i,e,t)=>(s,r,n,o)=>{const l=e(s,r,n,o);return l&&Wo(i,v(v({},Uo(s,r,n,o)),t)),l};function ns(i){return(e,t,s,r)=>{const{target:n,originX:o,originY:l}=t,c=n.getRelativeCenterPoint(),d=n.translateToOriginPoint(c,o,l),h=i(e,t,s,r);return n.setPositionByOrigin(d,t.originX,t.originY),h}}const ta=is(ms,ns((i,e,t,s)=>{const r=Zi(e,e.originX,e.originY,t,s);if(ue(e.originX)===ue(Y)||ue(e.originX)===ue(le)&&r.x<0||ue(e.originX)===ue(J)&&r.x>0){const{target:n}=e,o=n.strokeWidth/(n.strokeUniform?n.scaleX:1),l=Vo(e)?2:1,c=n.width,d=Math.abs(r.x*l/n.scaleX)-o;return n.set("width",Math.max(d,1)),c!==n.width}return!1}));function xm(i,e,t,s,r){s=s||{};const n=this.sizeX||s.cornerSize||r.cornerSize,o=this.sizeY||s.cornerSize||r.cornerSize,l=s.transparentCorners!==void 0?s.transparentCorners:r.transparentCorners,c=l?Oe:ge,d=!l&&(s.cornerStrokeColor||r.cornerStrokeColor);let h,u=e,g=t;i.save(),i.fillStyle=s.cornerColor||r.cornerColor||"",i.strokeStyle=s.cornerStrokeColor||r.cornerStrokeColor||"",n>o?(h=n,i.scale(1,o/n),g=t*n/o):o>n?(h=o,i.scale(n/o,1),u=e*o/n):h=n,i.beginPath(),i.arc(u,g,h/2,0,fr,!1),i[c](),d&&i.stroke(),i.restore()}function ym(i,e,t,s,r){s=s||{};const n=this.sizeX||s.cornerSize||r.cornerSize,o=this.sizeY||s.cornerSize||r.cornerSize,l=s.transparentCorners!==void 0?s.transparentCorners:r.transparentCorners,c=l?Oe:ge,d=!l&&(s.cornerStrokeColor||r.cornerStrokeColor),h=n/2,u=o/2;i.save(),i.fillStyle=s.cornerColor||r.cornerColor||"",i.strokeStyle=s.cornerStrokeColor||r.cornerStrokeColor||"",i.translate(e,t);const g=r.getTotalAngle();i.rotate(ce(g)),i["".concat(c,"Rect")](-h,-u,n,o),d&&i.strokeRect(-h,-u,n,o),i.restore()}class Re{constructor(e){b(this,"visible",!0),b(this,"actionName",Rr),b(this,"angle",0),b(this,"x",0),b(this,"y",0),b(this,"offsetX",0),b(this,"offsetY",0),b(this,"sizeX",0),b(this,"sizeY",0),b(this,"touchSizeX",0),b(this,"touchSizeY",0),b(this,"cursorStyle","crosshair"),b(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,s,r){var n;let{tl:o,tr:l,br:c,bl:d}=r;return((n=t.canvas)===null||n===void 0?void 0:n.getActiveObject())===t&&t.isControlVisible(e)&&ie.isPointInPolygon(s,[o,l,c,d])}getActionHandler(e,t,s){return this.actionHandler}getMouseDownHandler(e,t,s){return this.mouseDownHandler}getMouseUpHandler(e,t,s){return this.mouseUpHandler}cursorStyleHandler(e,t,s){return t.cursorStyle}getActionName(e,t,s){return t.actionName}getVisibility(e,t){var s,r;return(s=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&s!==void 0?s:this.visible}setVisibility(e,t,s){this.visible=e}positionHandler(e,t,s,r){return new _(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,s,r,n,o){const l=qi([ks(s,r),Ns({angle:e}),Ki((n?this.touchSizeX:this.sizeX)||t,(n?this.touchSizeY:this.sizeY)||t)]);return{tl:new _(-.5,-.5).transform(l),tr:new _(.5,-.5).transform(l),br:new _(.5,.5).transform(l),bl:new _(-.5,.5).transform(l)}}render(e,t,s,r,n){((r=r||{}).cornerStyle||n.cornerStyle)==="circle"?xm.call(this,e,t,s,r,n):ym.call(this,e,t,s,r,n)}}const bm=(i,e,t)=>t.lockRotation?_r:e.cursorStyle,vm=is(No,ns((i,e,t,s)=>{let{target:r,ex:n,ey:o,theta:l,originX:c,originY:d}=e;const h=r.translateToOriginPoint(r.getRelativeCenterPoint(),c,d);if(We(r,"lockRotation"))return!1;const u=Math.atan2(o-h.y,n-h.x),g=Math.atan2(s-h.y,t-h.x);let p=Mt(g-u+l);if(r.snapAngle&&r.snapAngle>0){const x=r.snapAngle,f=r.snapThreshold||x,y=Math.ceil(p/x)*x,w=Math.floor(p/x)*x;Math.abs(p-w)<f?p=w:Math.abs(p-y)<f&&(p=y)}p<0&&(p=360+p),p%=360;const m=r.angle!==p;return r.angle=p,m}));function Jo(i,e){const t=e.canvas,s=i[t.uniScaleKey];return t.uniformScaling&&!s||!t.uniformScaling&&s}function Qo(i,e,t){const s=We(i,"lockScalingX"),r=We(i,"lockScalingY");if(s&&r||!e&&(s||r)&&t||s&&e==="x"||r&&e==="y")return!0;const{width:n,height:o,strokeWidth:l}=i;return n===0&&l===0&&e!=="y"||o===0&&l===0&&e!=="x"}const wm=["e","se","s","sw","w","nw","n","ne","e"],ls=(i,e,t)=>{const s=Jo(i,t);if(Qo(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",s))return _r;const r=$o(t,e);return"".concat(wm[r],"-resize")};function sn(i,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const n=e.target,o=r.by,l=Jo(i,n);let c,d,h,u,g,p;if(Qo(n,o,l))return!1;if(e.gestureScale)d=e.scaleX*e.gestureScale,h=e.scaleY*e.gestureScale;else{if(c=Zi(e,e.originX,e.originY,t,s),g=o!=="y"?Math.sign(c.x||e.signX||1):1,p=o!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=g),e.signY||(e.signY=p),We(n,"lockScalingFlip")&&(e.signX!==g||e.signY!==p))return!1;if(u=n._getTransformedDimensions(),l&&!o){const f=Math.abs(c.x)+Math.abs(c.y),{original:y}=e,w=f/(Math.abs(u.x*y.scaleX/n.scaleX)+Math.abs(u.y*y.scaleY/n.scaleY));d=y.scaleX*w,h=y.scaleY*w}else d=Math.abs(c.x*n.scaleX/u.x),h=Math.abs(c.y*n.scaleY/u.y);Vo(e)&&(d*=2,h*=2),e.signX!==g&&o!=="y"&&(e.originX=qn(e.originX),d*=-1,e.signX=g),e.signY!==p&&o!=="x"&&(e.originY=qn(e.originY),h*=-1,e.signY=p)}const m=n.scaleX,x=n.scaleY;return o?(o==="x"&&n.set(Ee,d),o==="y"&&n.set(Fe,h)):(!We(n,"lockScalingX")&&n.set(Ee,d),!We(n,"lockScalingY")&&n.set(Fe,h)),m!==n.scaleX||x!==n.scaleY}const Ps=is(Lr,ns((i,e,t,s)=>sn(i,e,t,s))),jm=is(Lr,ns((i,e,t,s)=>sn(i,e,t,s,{by:"x"}))),_m=is(Lr,ns((i,e,t,s)=>sn(i,e,t,s,{by:"y"}))),Cm=["target","ex","ey","skewingSide"],ii={x:{counterAxis:"y",scale:Ee,skew:ts,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Fe,skew:ss,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},Sm=["ns","nesw","ew","nwse"],km=(i,e,t)=>{if(e.x!==0&&We(t,"lockSkewingY")||e.y!==0&&We(t,"lockSkewingX"))return _r;const s=$o(t,e)%4;return"".concat(Sm[s],"-resize")};function Zo(i,e,t,s,r){const{target:n}=t,{counterAxis:o,origin:l,lockSkewing:c,skew:d,flip:h}=ii[i];if(We(n,c))return!1;const{origin:u,flip:g}=ii[o],p=ue(t[u])*(n[g]?-1:1),m=-Math.sign(p)*(n[h]?-1:1),x=.5*-((n[d]===0&&Zi(t,Y,Y,s,r)[i]>0||n[d]>0?1:-1)*m)+.5;return is(To,ns((y,w,j,T)=>function(A,P,N){let{target:E,ex:D,ey:R,skewingSide:O}=P,W=re(P,Cm);const{skew:C}=ii[A],M=N.subtract(new _(D,R)).divide(new _(E.scaleX,E.scaleY))[A],U=E[C],$=W[C],Q=Math.tan(ce($)),H=A==="y"?E._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:E._getTransformedDimensions({scaleX:1,scaleY:1}).y,F=2*M*O/Math.max(H,1)+Q,V=Mt(Math.atan(F));E.set(C,V);const G=U!==E[C];if(G&&A==="y"){const{skewX:ee,scaleX:de}=E,se=E._getTransformedDimensions({skewY:U}),pe=E._getTransformedDimensions(),$e=ee!==0?se.x/pe.x:1;$e!==1&&E.set(Ee,$e*de)}return G}(i,w,new _(j,T))))(e,v(v({},t),{},{[l]:x,skewingSide:m}),s,r)}const Nm=(i,e,t,s)=>Zo("x",i,e,t,s),Tm=(i,e,t,s)=>Zo("y",i,e,t,s);function Wr(i,e){return i[e.canvas.altActionKey]}const Fs=(i,e,t)=>{const s=Wr(i,t);return e.x===0?s?ts:Fe:e.y===0?s?ss:Ee:""},zt=(i,e,t)=>Wr(i,t)?km(0,e,t):ls(i,e,t),sa=(i,e,t,s)=>Wr(i,e.target)?Tm(i,e,t,s):jm(i,e,t,s),ra=(i,e,t,s)=>Wr(i,e.target)?Nm(i,e,t,s):_m(i,e,t,s),el=()=>({ml:new Re({x:-.5,y:0,cursorStyleHandler:zt,actionHandler:sa,getActionName:Fs}),mr:new Re({x:.5,y:0,cursorStyleHandler:zt,actionHandler:sa,getActionName:Fs}),mb:new Re({x:0,y:.5,cursorStyleHandler:zt,actionHandler:ra,getActionName:Fs}),mt:new Re({x:0,y:-.5,cursorStyleHandler:zt,actionHandler:ra,getActionName:Fs}),tl:new Re({x:-.5,y:-.5,cursorStyleHandler:ls,actionHandler:Ps}),tr:new Re({x:.5,y:-.5,cursorStyleHandler:ls,actionHandler:Ps}),bl:new Re({x:-.5,y:.5,cursorStyleHandler:ls,actionHandler:Ps}),br:new Re({x:.5,y:.5,cursorStyleHandler:ls,actionHandler:Ps}),mtr:new Re({x:0,y:-.5,actionHandler:vm,cursorStyleHandler:bm,offsetY:-40,withConnection:!0,actionName:Xi})}),Om=()=>({mr:new Re({x:.5,y:0,actionHandler:ta,cursorStyleHandler:zt,actionName:ms}),ml:new Re({x:-.5,y:0,actionHandler:ta,cursorStyleHandler:zt,actionName:ms})}),Em=()=>v(v({},el()),Om());class xs extends tt{static getDefaults(){return v(v({},super.getDefaults()),xs.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),xs.ownDefaults),this.setOptions(e)}static createControls(){return{controls:el()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,s=t.target,r=t.action;if(this===s&&r&&r.startsWith(Rr))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const s=Object.entries(this.oCoords);for(let r=s.length-1;r>=0;r--){const[n,o]=s[r],l=this.controls[n];if(l.shouldActivate(n,this,e,t?o.touchCorner:o.corner))return this.__corner=n,{key:n,control:l,coord:this.oCoords[n]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),s=ks(t.x,t.y),r=Ns({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),n=fe(s,r),o=fe(e,n),l=fe(o,[1/e[0],0,0,1/e[3],0,0]),c=this.group?vr(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));const d=this._calculateCurrentDimensions(c),h={};return this.forEachControl((u,g)=>{const p=u.positionHandler(d,l,this,u);h[g]=Object.assign(p,this._calcCornerCoords(u,p))}),h}_calcCornerCoords(e,t){const s=this.getTotalAngle();return{corner:e.calcCornerCoords(s,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(s,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),s=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(ce(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-s.x/2,-s.y/2,s.x,s.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=v({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},s);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:s,hasControls:r}=this,n=v({hasBorders:s,hasControls:r},t),o=this.getViewportTransform(),l=n.hasBorders,c=n.hasControls,d=fe(o,this.calcTransformMatrix()),h=vr(d);e.save(),e.translate(h.translateX,h.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(h.angle-=180),e.rotate(ce(this.group?h.angle:this.angle)),l&&this.drawBorders(e,h,t),c&&this.drawControls(e,t),e.restore()}drawBorders(e,t,s){let r;if(s&&s.forActiveSelection||this.group){const n=Qi(this.width,this.height,Ir(t)),o=this.isStrokeAccountedForInDimensions()?Gi:(this.strokeUniform?new _().scalarAdd(this.canvas?this.canvas.getZoom():1):new _(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=n.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,s)}drawControlsConnectingLines(e,t){let s=!1;e.beginPath(),this.forEachControl((r,n)=>{r.withConnection&&r.getVisibility(this,n)&&(s=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))}),s&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const s=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:n,cornerColor:o}=this,l=v({cornerStrokeColor:r,cornerDashArray:n,cornerColor:o},t);e.setTransform(s,0,0,s,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray),this.forEachControl((c,d)=>{if(c.getVisibility(this,d)){const h=this.oCoords[d];c.render(e,h.x,h.y,l,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[s,r]=t;return this.setControlVisible(s,r)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const s=this.canvas.viewportTransform;t.save(),t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this.transform(t);const r=this.width+4,n=this.height+4;return t.clearRect(-r/2,-n/2,r,n),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function tl(i,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(s=>{s!=="constructor"&&Object.defineProperty(i.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s)||Object.create(null))})}),i}b(xs,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ve extends xs{}tl(ve,[Yo]),L.setClass(ve),L.setClass(ve,"object");const Dm=(i,e,t,s)=>{const r=2*(s=Math.round(s))+1,{data:n}=i.getImageData(e-s,t-s,r,r);for(let o=3;o<n.length;o+=4)if(n[o]>0)return!1;return!0};class sl{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new _(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new _(1/this.options.scaleX,1/this.options.scaleY):new _(1,1)}createSideVector(e,t){const s=ki(e,t);return this.options.strokeUniform?s.multiply(this.scale):s}projectOrthogonally(e,t,s){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,s)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new _(e);return t.y+=t.x*Math.tan(ce(this.options.skewY)),t.x+=t.y*Math.tan(ce(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const Am=new _;class Yt extends sl{static getOrthogonalRotationFactor(e,t){const s=t?Ti(e,t):em(e);return Math.abs(s)<Ss?-1:1}constructor(e,t,s,r){super(r),b(this,"AB",void 0),b(this,"AC",void 0),b(this,"alpha",void 0),b(this,"bisector",void 0),this.A=new _(e),this.B=new _(t),this.C=new _(s),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Ti(this.AB,this.AC),this.bisector=en(Go(this.AB.eq(Am)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t),n=qo(r),o=Yt.getOrthogonalRotationFactor(n,this.bisector);return this.scaleUnitVector(n,s*o)}projectBevel(){const e=[];return(this.alpha%fr==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),s=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*s),n=this.options.strokeUniform?Ni(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Ni(r)/this.strokeProjectionMagnitude<=n&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const s=[],r=new _(Yt.getOrthogonalRotationFactor(this.bisector),Yt.getOrthogonalRotationFactor(new _(this.bisector.y,this.bisector.x)));return[new _(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new _(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach(n=>{Qn(n,e,t)&&s.push(this.A.add(n))}),s}projectRoundWithSkew(e,t){const s=[],{skewX:r,skewY:n,scaleX:o,scaleY:l,strokeUniform:c}=this.options,d=new _(Math.tan(ce(r)),Math.tan(ce(n))),h=this.strokeProjectionMagnitude,u=c?h/l/Math.sqrt(1/l**2+1/o**2*d.y**2):h/Math.sqrt(1+d.y**2),g=new _(Math.sqrt(Math.max(h**2-u**2,0)),u),p=c?h/Math.sqrt(1+d.x**2*(1/l)**2/(1/o+1/o*d.x*d.y)**2):h/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),m=new _(p,Math.sqrt(Math.max(h**2-p**2,0)));return[m,m.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(x=>this.applySkew(c?x.multiply(this.strokeUniformScalar):x)).forEach(x=>{Qn(x,e,t)&&s.push(this.applySkew(this.A).add(x))}),s}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%fr==0,s=this.applySkew(this.A),r=e[t?0:2].subtract(s),n=e[t?1:0].subtract(s),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=hs(r,o)>0,c=l?r:n,d=l?n:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,d)):e.push(...this.projectRoundNoSkew(c,d)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class ia extends sl{constructor(e,t,s){super(s),this.A=new _(e),this.T=new _(t)}calcOrthogonalProjection(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t);return this.scaleUnitVector(qo(r),s)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new _(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Yt(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new _(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),s=this.scaleUnitVector(en(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(s);e.push(r.add(t),r.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const Mm=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const s=[];if(i.length===0)return s;const r=i.reduce((n,o)=>(n[n.length-1].eq(o)||n.push(new _(o)),n),[new _(i[0])]);if(r.length===1)t=!0;else if(!t){const n=r[0],o=((l,c)=>{for(let d=l.length-1;d>=0;d--)if(c(l[d],d,l))return d;return-1})(r,l=>!l.eq(n));r.splice(o+1)}return r.forEach((n,o,l)=>{let c,d;o===0?(d=l[1],c=t?n:l[l.length-1]):o===l.length-1?(c=l[o-1],d=t?n:l[0]):(c=l[o-1],d=l[o+1]),t&&l.length===1?s.push(...new ia(n,n,e).project()):!t||o!==0&&o!==l.length-1?s.push(...new Yt(n,c,d,e).project()):s.push(...new ia(n,o===0?d:c,e).project())}),s},rn=i=>{const e={};return Object.keys(i).forEach(t=>{e[t]={},Object.keys(i[t]).forEach(s=>{e[t][s]=v({},i[t][s])})}),e},Pm=i=>i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),nn=i=>{const e=[];for(let t,s=0;s<i.length;s++)(t=Fm(i,s))!==!1&&e.push(t);return e},Fm=(i,e)=>{const t=i.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return i.charAt(e);if(55296<=t&&t<=56319){if(i.length<=e+1)throw"High surrogate without following low surrogate";const r=i.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return i.charAt(e)+i.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const s=i.charCodeAt(e-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1},an=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return i.fill!==e.fill||i.stroke!==e.stroke||i.strokeWidth!==e.strokeWidth||i.fontSize!==e.fontSize||i.fontFamily!==e.fontFamily||i.fontWeight!==e.fontWeight||i.fontStyle!==e.fontStyle||i.textBackgroundColor!==e.textBackgroundColor||i.deltaY!==e.deltaY||t&&(i.overline!==e.overline||i.underline!==e.underline||i.linethrough!==e.linethrough)},Lm=(i,e)=>{const t=e.split(`
`),s=[];let r=-1,n={};i=rn(i);for(let o=0;o<t.length;o++){const l=nn(t[o]);if(i[o])for(let c=0;c<l.length;c++){r++;const d=i[o][c];d&&Object.keys(d).length>0&&(an(n,d,!0)?s.push({start:r,end:r+1,style:d}):s[s.length-1].end++),n=d||{}}else r+=l.length,n={}}return s},Rm=(i,e)=>{if(!Array.isArray(i))return rn(i);const t=e.split(Yi),s={};let r=-1,n=0;for(let o=0;o<t.length;o++){const l=nn(t[o]);for(let c=0;c<l.length;c++)r++,i[n]&&i[n].start<=r&&r<i[n].end&&(s[o]=s[o]||{},s[o][c]=v({},i[n].style),r===i[n].end-1&&n++)}return s},_t=["display","transform",ge,"fill-opacity","fill-rule","opacity",Oe,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function na(i,e){const t=i.nodeName,s=i.getAttribute("class"),r=i.getAttribute("id"),n="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+n,"i"),e=e.replace(o,"")),s&&e.length){const l=s.split(" ");for(let c=l.length;c--;)o=new RegExp("\\."+l[c]+n,"i"),e=e.replace(o,"")}return e.length===0}function Im(i,e){let t=!0;const s=na(i,e.pop());return s&&e.length&&(t=function(r,n){let o,l=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&n.length;)l&&(o=n.pop()),l=na(r=r.parentElement,o);return n.length===0}(i,e)),s&&t&&e.length===0}const Bm=i=>{var e;return(e=Qg[i])!==null&&e!==void 0?e:i},Hm=new RegExp("(".concat(Pt,")"),"gi"),zm=i=>i.replace(Hm," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var aa,oa,la,ca,ha,da,ua;const je="(".concat(Pt,")"),Wm=String.raw(aa||(aa=jt(["(skewX)(",")"],["(skewX)\\(","\\)"])),je),Vm=String.raw(oa||(oa=jt(["(skewY)(",")"],["(skewY)\\(","\\)"])),je),Um=String.raw(la||(la=jt(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),je,je,je),$m=String.raw(ca||(ca=jt(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),je,je),Ym=String.raw(ha||(ha=jt(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),je,je),Xm=String.raw(da||(da=jt(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),je,je,je,je,je,je),on="(?:".concat(Xm,"|").concat(Ym,"|").concat(Um,"|").concat($m,"|").concat(Wm,"|").concat(Vm,")"),Gm="(?:".concat(on,"*)"),qm=String.raw(ua||(ua=jt(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Gm),Km=new RegExp(qm),Jm=new RegExp(on),Qm=new RegExp(on,"g");function Oi(i){const e=[];if(!(i=zm(i).replace(/\s*([()])\s*/gi,"$1"))||i&&!Km.test(i))return[..._e];for(const t of i.matchAll(Qm)){const s=Jm.exec(t[0]);if(!s)continue;let r=_e;const n=s.filter(m=>!!m),[,o,...l]=n,[c,d,h,u,g,p]=l.map(m=>parseFloat(m));switch(o){case"translate":r=ks(c,d);break;case Xi:r=Ns({angle:c},{x:d,y:h});break;case Rr:r=Ki(c,d);break;case ts:r=Fo(c);break;case ss:r=Lo(c);break;case"matrix":r=[c,d,h,u,g,p]}e.push(r)}return qi(e)}function Zm(i,e,t,s){const r=Array.isArray(e);let n,o=e;if(i!==ge&&i!==Oe||e!==Te){if(i==="strokeUniform")return e==="non-scaling-stroke";if(i==="strokeDashArray")o=e===Te?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(i==="transformMatrix")o=t&&t.transformMatrix?fe(t.transformMatrix,Oi(e)):Oi(e);else if(i==="visible")o=e!==Te&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(i==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(i==="textAnchor")o=e==="start"?J:e==="end"?le:Y;else if(i==="charSpacing")n=Ut(e,s)/s*1e3;else if(i==="paintFirst"){const l=e.indexOf(ge),c=e.indexOf(Oe);o=ge,(l>-1&&c>-1&&c<l||l===-1&&c>-1)&&(o=Oe)}else{if(i==="href"||i==="xlink:href"||i==="font"||i==="id")return e;if(i==="imageSmoothing")return e==="optimizeQuality";n=r?e.map(Ut):Ut(e,s)}}else o="";return!r&&isNaN(n)?o:n}function ep(i,e){const t=i.match(Jg);if(!t)return;const s=t[1],r=t[3],n=t[4],o=t[5],l=t[6];s&&(e.fontStyle=s),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),n&&(e.fontSize=Ut(n)),l&&(e.fontFamily=l),o&&(e.lineHeight=o==="normal"?1:o)}function tp(i,e){i.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[s,r]=t.split(":");e[s.trim().toLowerCase()]=r.trim()})}function sp(i){const e={},t=i.getAttribute("style");return t&&(typeof t=="string"?tp(t,e):function(s,r){Object.entries(s).forEach(n=>{let[o,l]=n;l!==void 0&&(r[o.toLowerCase()]=l)})}(t,e)),e}const rp={stroke:"strokeOpacity",fill:"fillOpacity"};function ut(i,e,t){if(!i)return{};let s,r={},n=$i;i.parentNode&&Jn.test(i.parentNode.nodeName)&&(r=ut(i.parentElement,e,t),r.fontSize&&(s=n=Ut(r.fontSize)));const o=v(v(v({},e.reduce((d,h)=>{const u=i.getAttribute(h);return u&&(d[h]=u),d},{})),function(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u={};for(const g in h)Im(d,g.split(" "))&&(u=v(v({},u),h[g]));return u}(i,t)),sp(i));o[si]&&i.setAttribute(si,o[si]),o[ti]&&(s=Ut(o[ti],n),o[ti]="".concat(s));const l={};for(const d in o){const h=Bm(d),u=Zm(h,o[d],r,s);l[h]=u}l&&l.font&&ep(l.font,l);const c=v(v({},r),l);return Jn.test(i.nodeName)?c:function(d){const h=ve.getDefaults();return Object.entries(rp).forEach(u=>{let[g,p]=u;if(d[p]===void 0||d[g]==="")return;if(d[g]===void 0){if(!h[g])return;d[g]=h[g]}if(d[g].indexOf("url(")===0)return;const m=new Z(d[g]);d[g]=m.setAlpha(ae(m.getAlpha()*d[p],2)).toRgba()}),d}(c)}const ip=["left","top","width","height","visible"],rl=["rx","ry"];class Xe extends ve{static getDefaults(){return v(v({},super.getDefaults()),Xe.ownDefaults)}constructor(e){super(),Object.assign(this,Xe.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:s}=this,r=-t/2,n=-s/2,o=this.rx?Math.min(this.rx,t/2):0,l=this.ry?Math.min(this.ry,s/2):0,c=o!==0||l!==0;e.beginPath(),e.moveTo(r+o,n),e.lineTo(r+t-o,n),c&&e.bezierCurveTo(r+t-pt*o,n,r+t,n+pt*l,r+t,n+l),e.lineTo(r+t,n+s-l),c&&e.bezierCurveTo(r+t,n+s-pt*l,r+t-pt*o,n+s,r+t-o,n+s),e.lineTo(r+o,n+s),c&&e.bezierCurveTo(r+pt*o,n+s,r,n+s-pt*l,r,n+s-l),e.lineTo(r,n+l),c&&e.bezierCurveTo(r,n+pt*l,r+pt*o,n,r+o,n),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...rl,...e])}_toSVG(){const{width:e,height:t,rx:s,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(s,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,s){const r=ut(e,this.ATTRIBUTE_NAMES,s),{left:n=0,top:o=0,width:l=0,height:c=0,visible:d=!0}=r,h=re(r,ip);return new this(v(v(v({},t),h),{},{left:n,top:o,width:l,height:c,visible:!!(d&&l&&c)}))}}b(Xe,"type","Rect"),b(Xe,"cacheProperties",[...dt,...rl]),b(Xe,"ownDefaults",{rx:0,ry:0}),b(Xe,"ATTRIBUTE_NAMES",[..._t,"x","y","rx","ry","width","height"]),L.setClass(Xe),L.setSVGClass(Xe);const it="initialization",Cr="added",ln="removed",Sr="imperative",il=(i,e)=>{const{strokeUniform:t,strokeWidth:s,width:r,height:n,group:o}=e,l=o&&o!==i?Hr(o.calcTransformMatrix(),i.calcTransformMatrix()):null,c=l?e.getRelativeCenterPoint().transform(l):e.getRelativeCenterPoint(),d=!e.isStrokeAccountedForInDimensions(),h=t&&d?Xg(new _(s,s),void 0,i.calcTransformMatrix()):Gi,u=!t&&d?s:0,g=Qi(r+u,n+u,qi([l,e.calcOwnMatrix()],!0)).add(h).scalarDivide(2);return[c.subtract(g),c.add(g)]};class Vr{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:s,strategy:r}=e;return t===it||t===Sr||!!s&&r!==s}shouldLayoutClipPath(e){let{type:t,target:{clipPath:s}}=e;return t!==it&&s&&!s.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:s,target:r}=t;if(s===Sr&&t.overrides)return t.overrides;if(e.length===0)return;const{left:n,top:o,width:l,height:c}=ot(e.map(u=>il(r,u)).reduce((u,g)=>u.concat(g),[])),d=new _(l,c),h=new _(n,o).add(d.scalarDivide(2));if(s===it){const u=this.getInitialSize(t,{size:d,center:h});return{center:h,relativeCorrection:new _(0,0),size:u}}return{center:h.transform(r.calcOwnMatrix()),size:d}}}b(Vr,"type","strategy");class Ei extends Vr{shouldPerformLayout(e){return!0}}b(Ei,"type","fit-content"),L.setClass(Ei);const np=["strategy"],ap=["target","strategy","bubbles","prevStrategy"],nl="layoutManager";class ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Ei;b(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=v(v({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const s=this.getLayoutResult(t);s&&this.commitLayout(t,s),this.onAfterLayout(t,s),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:s}=t;return[yr,ko,ms,No,Lr,To,xr,Ag,Mg].map(r=>e.on(r,n=>this.performLayout(r===yr?{type:"object_modified",trigger:r,e:n,target:s}:{type:"object_modifying",trigger:r,e:n,target:s})))}subscribe(e,t){this.unsubscribe(e,t);const s=this.attachHandlers(e,t);this._subscriptions.set(e,s)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(s=>s()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:s}=e,{canvas:r}=t;if(s===it||s===Cr?this.subscribeTargets(e):s===ln&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),s===Sr&&e.deep){const n=re(e,np);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(v(v({},n),{},{bubbles:!1,target:o})))}}getLayoutResult(e){const{target:t,strategy:s,type:r}=e,n=s.calcLayoutResult(e,t.getObjects());if(!n)return;const o=r===it?new _:t.getRelativeCenterPoint(),{center:l,correction:c=new _,relativeCorrection:d=new _}=n,h=o.subtract(l).add(c).transform(r===it?_e:He(t.calcOwnMatrix()),!0).add(d);return{result:n,prevCenter:o,nextCenter:l,offset:h}}commitLayout(e,t){const{target:s}=e,{result:{size:r},nextCenter:n}=t;var o,l;s.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===it?s.set({left:(o=e.x)!==null&&o!==void 0?o:n.x+r.x*ue(s.originX),top:(l=e.y)!==null&&l!==void 0?l:n.y+r.y*ue(s.originY)}):(s.setPositionByOrigin(n,Y,Y),s.setCoords(),s.set("dirty",!0))}layoutObjects(e,t){const{target:s}=e;s.forEachObject(r=>{r.group===s&&this.layoutObject(e,t,r)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,s.clipPath)}layoutObject(e,t,s){let{offset:r}=t;s.set({left:s.left+r.x,top:s.top+r.y})}onAfterLayout(e,t){const{target:s,strategy:r,bubbles:n,prevStrategy:o}=e,l=re(e,ap),{canvas:c}=s;s.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:s});const d=s.parent;n&&d!=null&&d.layoutManager&&((l.path||(l.path=[])).push(s),d.layoutManager.performLayout(v(v({},l),{},{target:d}))),s.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(s=>s())),e.clear()}toObject(){return{type:nl,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}L.setClass(ys,nl);const op=["type","objects","layoutManager"];class lp extends ys{performLayout(){}}class Dt extends Oo(ve){static getDefaults(){return v(v({},super.getDefaults()),Dt.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),b(this,"_activeObjects",[]),b(this,"__objectSelectionTracker",void 0),b(this,"__objectSelectionDisposer",void 0),Object.assign(this,Dt.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var s;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(r=>{this.enterGroup(r,!1)}),this.layoutManager=(s=t.layoutManager)!==null&&s!==void 0?s:new ys,this.layoutManager.performLayout({type:it,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(bt("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(bt("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,s,r)=>this.canEnterGroup(t)&&r.indexOf(t)===s)}add(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];const r=this._filterObjectsBeforeEnteringGroup(t),n=super.add(...r);return this._onAfterObjectsChange(Cr,r),n}insertAt(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];const n=this._filterObjectsBeforeEnteringGroup(s),o=super.insertAt(e,...n);return this._onAfterObjectsChange(Cr,n),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(ln,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const s=this[e];return super._set(e,t),e==="canvas"&&s!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:s}=t;const r=this._activeObjects;if(e)r.push(s),this._set("dirty",!0);else if(r.length>0){const n=r.indexOf(s);n>-1&&(r.splice(n,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&jr(e,fe(He(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const s=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();s&&(s===e||e.isDescendantOf(s))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(jr(e,fe(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const s=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;s>-1&&this._activeObjects.splice(s,1)}shouldCache(){const e=ve.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,s){this._renderBackground(e);for(let n=0;n<this._objects.length;n++){var r;const o=this._objects[n];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...He(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,s)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(v({target:this,type:Sr},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const s=this.includeDefaultValues;return this._objects.filter(function(r){return!r.excludeFromExport}).map(function(r){const n=r.includeDefaultValues;r.includeDefaultValues=s;const o=r[e||"toObject"](t);return r.includeDefaultValues=n,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return v(v(v({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Xe.prototype._toSVG.call(this),s=t.indexOf("COMMON_PARTS");t[s]='for="group" ';const r=t.join("");return e?e(r):r}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],s=this._createSVGBgRect(e);s&&t.push("		",s);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],s=this._createSVGBgRect(e);s&&t.push("	",s);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:s,objects:r=[],layoutManager:n}=e,o=re(e,op);return Promise.all([ps(r,t),Br(o,t)]).then(l=>{let[c,d]=l;const h=new this(c,v(v(v({},o),d),{},{layoutManager:new lp}));if(n){const u=L.getClass(n.type),g=L.getClass(n.strategy);h.layoutManager=new u(new g)}else h.layoutManager=new ys;return h.layoutManager.subscribeTargets({type:it,target:h,targets:h.getObjects()}),h.setCoords(),h})}}b(Dt,"type","Group"),b(Dt,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),L.setClass(Dt);const cp=(i,e)=>Math.min(e.width/i.width,e.height/i.height),hp=(i,e)=>Math.max(e.width/i.width,e.height/i.height),Di="\\s*,?\\s*",os="".concat(Di,"(").concat(Pt,")"),dp="".concat(os).concat(os).concat(os).concat(Di,"([01])").concat(Di,"([01])").concat(os).concat(os),up={m:"l",M:"L"},gp=(i,e,t,s,r,n,o,l,c,d,h)=>{const u=ct(i),g=ht(i),p=ct(e),m=ht(e),x=t*r*p-s*n*m+o,f=s*r*p+t*n*m+l;return["C",d+c*(-t*r*g-s*n*u),h+c*(-s*r*g+t*n*u),x+c*(t*r*m+s*n*p),f+c*(s*r*m-t*n*p),x,f]},ga=(i,e,t,s)=>{const r=Math.atan2(e,i),n=Math.atan2(s,t);return n>=r?n-r:2*Math.PI-(r-n)};function ma(i,e,t,s,r,n,o,l){let c;if(q.cachesBoundsOfCurve&&(c=[...arguments].join(),cs.boundsOfCurveCache[c]))return cs.boundsOfCurveCache[c];const d=Math.sqrt,h=Math.abs,u=[],g=[[0,0],[0,0]];let p=6*i-12*t+6*r,m=-3*i+9*t-9*r+3*o,x=3*t-3*i;for(let T=0;T<2;++T){if(T>0&&(p=6*e-12*s+6*n,m=-3*e+9*s-9*n+3*l,x=3*s-3*e),h(m)<1e-12){if(h(p)<1e-12)continue;const D=-x/p;0<D&&D<1&&u.push(D);continue}const A=p*p-4*x*m;if(A<0)continue;const P=d(A),N=(-p+P)/(2*m);0<N&&N<1&&u.push(N);const E=(-p-P)/(2*m);0<E&&E<1&&u.push(E)}let f=u.length;const y=f,w=al(i,e,t,s,r,n,o,l);for(;f--;){const{x:T,y:A}=w(u[f]);g[0][f]=T,g[1][f]=A}g[0][y]=i,g[1][y]=e,g[0][y+1]=o,g[1][y+1]=l;const j=[new _(Math.min(...g[0]),Math.min(...g[1])),new _(Math.max(...g[0]),Math.max(...g[1]))];return q.cachesBoundsOfCurve&&(cs.boundsOfCurveCache[c]=j),j}const mp=(i,e,t)=>{let[s,r,n,o,l,c,d,h]=t;const u=((g,p,m,x,f,y,w)=>{if(m===0||x===0)return[];let j=0,T=0,A=0;const P=Math.PI,N=w*Ui,E=ht(N),D=ct(N),R=.5*(-D*g-E*p),O=.5*(-D*p+E*g),W=m**2,C=x**2,M=O**2,U=R**2,$=W*C-W*M-C*U;let Q=Math.abs(m),H=Math.abs(x);if($<0){const mt=Math.sqrt(1-$/(W*C));Q*=mt,H*=mt}else A=(f===y?-1:1)*Math.sqrt($/(W*M+C*U));const F=A*Q*O/H,V=-A*H*R/Q,G=D*F-E*V+.5*g,ee=E*F+D*V+.5*p;let de=ga(1,0,(R-F)/Q,(O-V)/H),se=ga((R-F)/Q,(O-V)/H,(-R-F)/Q,(-O-V)/H);y===0&&se>0?se-=2*P:y===1&&se<0&&(se+=2*P);const pe=Math.ceil(Math.abs(se/P*2)),$e=[],gt=se/pe,Ol=8/3*Math.sin(gt/4)*Math.sin(gt/4)/Math.sin(gt/2);let Yr=de+gt;for(let mt=0;mt<pe;mt++)$e[mt]=gp(de,Yr,D,E,Q,H,G,ee,Ol,j,T),j=$e[mt][5],T=$e[mt][6],de=Yr,Yr+=gt;return $e})(d-i,h-e,r,n,l,c,o);for(let g=0,p=u.length;g<p;g++)u[g][1]+=i,u[g][2]+=e,u[g][3]+=i,u[g][4]+=e,u[g][5]+=i,u[g][6]+=e;return u},pp=i=>{let e=0,t=0,s=0,r=0;const n=[];let o,l=0,c=0;for(const d of i){const h=[...d];let u;switch(h[0]){case"l":h[1]+=e,h[2]+=t;case"L":e=h[1],t=h[2],u=["L",e,t];break;case"h":h[1]+=e;case"H":e=h[1],u=["L",e,t];break;case"v":h[1]+=t;case"V":t=h[1],u=["L",e,t];break;case"m":h[1]+=e,h[2]+=t;case"M":e=h[1],t=h[2],s=h[1],r=h[2],u=["M",e,t];break;case"c":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t,h[5]+=e,h[6]+=t;case"C":l=h[3],c=h[4],e=h[5],t=h[6],u=["C",h[1],h[2],l,c,e,t];break;case"s":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t;case"S":o==="C"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=h[3],t=h[4],u=["C",l,c,h[1],h[2],e,t],l=u[3],c=u[4];break;case"q":h[1]+=e,h[2]+=t,h[3]+=e,h[4]+=t;case"Q":l=h[1],c=h[2],e=h[3],t=h[4],u=["Q",l,c,e,t];break;case"t":h[1]+=e,h[2]+=t;case"T":o==="Q"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=h[1],t=h[2],u=["Q",l,c,e,t];break;case"a":h[6]+=e,h[7]+=t;case"A":mp(e,t,h).forEach(g=>n.push(g)),e=h[6],t=h[7];break;case"z":case"Z":e=s,t=r,u=["Z"]}u?(n.push(u),o=u[0]):o=""}return n},kr=(i,e,t,s)=>Math.sqrt((t-i)**2+(s-e)**2),al=(i,e,t,s,r,n,o,l)=>c=>{const d=c**3,h=(p=>3*p**2*(1-p))(c),u=(p=>3*p*(1-p)**2)(c),g=(p=>(1-p)**3)(c);return new _(o*d+r*h+t*u+i*g,l*d+n*h+s*u+e*g)},ol=i=>i**2,ll=i=>2*i*(1-i),cl=i=>(1-i)**2,fp=(i,e,t,s,r,n,o,l)=>c=>{const d=ol(c),h=ll(c),u=cl(c),g=3*(u*(t-i)+h*(r-t)+d*(o-r)),p=3*(u*(s-e)+h*(n-s)+d*(l-n));return Math.atan2(p,g)},xp=(i,e,t,s,r,n)=>o=>{const l=ol(o),c=ll(o),d=cl(o);return new _(r*l+t*c+i*d,n*l+s*c+e*d)},yp=(i,e,t,s,r,n)=>o=>{const l=1-o,c=2*(l*(t-i)+o*(r-t)),d=2*(l*(s-e)+o*(n-s));return Math.atan2(d,c)},pa=(i,e,t)=>{let s=new _(e,t),r=0;for(let n=1;n<=100;n+=1){const o=i(n/100);r+=kr(s.x,s.y,o.x,o.y),s=o}return r},bp=(i,e)=>{let t,s=0,r=0,n={x:i.x,y:i.y},o=v({},n),l=.01,c=0;const d=i.iterator,h=i.angleFinder;for(;r<e&&l>1e-4;)o=d(s),c=s,t=kr(n.x,n.y,o.x,o.y),t+r>e?(s-=l,l/=2):(n=o,s+=l,r+=t);return v(v({},o),{},{angle:h(c)})},hl=i=>{let e,t,s=0,r=0,n=0,o=0,l=0;const c=[];for(const d of i){const h={x:r,y:n,command:d[0],length:0};switch(d[0]){case"M":t=h,t.x=o=r=d[1],t.y=l=n=d[2];break;case"L":t=h,t.length=kr(r,n,d[1],d[2]),r=d[1],n=d[2];break;case"C":e=al(r,n,d[1],d[2],d[3],d[4],d[5],d[6]),t=h,t.iterator=e,t.angleFinder=fp(r,n,d[1],d[2],d[3],d[4],d[5],d[6]),t.length=pa(e,r,n),r=d[5],n=d[6];break;case"Q":e=xp(r,n,d[1],d[2],d[3],d[4]),t=h,t.iterator=e,t.angleFinder=yp(r,n,d[1],d[2],d[3],d[4]),t.length=pa(e,r,n),r=d[3],n=d[4];break;case"Z":t=h,t.destX=o,t.destY=l,t.length=kr(r,n,o,l),r=o,n=l}s+=t.length,c.push(t)}return c.push({length:s,x:r,y:n}),c},vp=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hl(i),s=0;for(;e-t[s].length>0&&s<t.length-2;)e-=t[s].length,s++;const r=t[s],n=e/r.length,o=i[s];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return v(v({},new _(r.x,r.y).lerp(new _(r.destX,r.destY),n)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return v(v({},new _(r.x,r.y).lerp(new _(o[1],o[2]),n)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return bp(r,e)}},wp=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),fa=new RegExp(dp,"g"),jp=new RegExp(Pt,"gi"),_p={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Cp=i=>{var e;const t=[],s=(e=i.match(wp))!==null&&e!==void 0?e:[];for(const r of s){const n=r[0];if(n==="z"||n==="Z"){t.push([n]);continue}const o=_p[n.toLowerCase()];let l=[];if(n==="a"||n==="A"){fa.lastIndex=0;for(let c=null;c=fa.exec(r);)l.push(...c.slice(1))}else l=r.match(jp)||[];for(let c=0;c<l.length;c+=o){const d=new Array(o),h=up[n];d[0]=c>0&&h?h:n;for(let u=0;u<o;u++)d[u+1]=parseFloat(l[c+u]);t.push(d)}}return t},Sp=(i,e)=>i.map(t=>t.map((s,r)=>r===0||e===void 0?s:ae(s,e)).join(" ")).join(" ");function Ai(i,e){const t=i.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(s=>{let[r,n]=s;return t.setProperty(r,n)}))}class kp extends Ho{constructor(e){let{allowTouchScrolling:t=!1,containerClass:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),b(this,"upper",void 0),b(this,"container",void 0);const{el:r}=this.lower,n=this.createUpperCanvas();this.upper={el:n,ctx:n.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(n,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(s),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,n),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=Ve();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=es().createElement("div");return e.setAttribute("data-fabric","wrapper"),Ai(e,{position:"relative"}),Gn(e),e}applyCanvasStyle(e,t){const{styles:s,allowTouchScrolling:r}=t;Ai(e,v(v({},s),{},{"touch-action":r?"manipulation":Te})),Gn(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:s,ctx:r}=this.upper;Bo(s,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),_i(this.upper.el,e),_i(this.container,e)}cleanupDOM(e){const t=this.container,{el:s}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(s),t.parentNode&&t.parentNode.replaceChild(s,t)}dispose(){super.dispose(),Qe().dispose(this.upper.el),delete this.upper,delete this.container}}class Ur extends Ts{constructor(){super(...arguments),b(this,"targets",[]),b(this,"_hoveredTargets",[]),b(this,"_objectsToRender",void 0),b(this,"_currentTransform",null),b(this,"_groupSelector",null),b(this,"contextTopDirty",!1)}static getDefaults(){return v(v({},super.getDefaults()),Ur.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new kp(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),s=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=s,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,s){const r=this.targetFindTolerance,n=this.pixelFindContext;this.clearContext(n),n.save(),n.translate(-t+r,-s+r),n.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(n),e.selectionBackgroundColor=o,n.restore();const l=Math.round(r*this.getRetinaScaling());return Dm(n,l,l,l)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(s=>!!s&&e[s]===!0):e[t])}_shouldClearSelection(e,t){const s=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&s.length>1&&s.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,s){if(!e)return;let r;return t===Rr||t===Ee||t===Fe||t===ms?r=this.centeredScaling||e.centeredScaling:t===Xi&&(r=this.centeredRotation||e.centeredRotation),r?!s:s}_getOriginFromCorner(e,t){const s={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?s.x=le:["mr","tr","br"].includes(t)&&(s.x=J),["tl","mt","tr"].includes(t)?s.y=ji:["bl","mb","br"].includes(t)&&(s.y=Ne)),s}_setupCurrentTransform(e,t,s){var r;const n=t.group?$t(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:l}=t.getActiveControl()||{},c=s&&l?(r=l.getActionHandler(e,t,l))===null||r===void 0?void 0:r.bind(l):Kg,d=((p,m,x,f)=>{if(!m||!p)return"drag";const y=f.controls[m];return y.getActionName(x,y,f)})(s,o,e,t),h=e[this.centeredKey],u=this._shouldCenterTransform(t,d,h)?{x:Y,y:Y}:this._getOriginFromCorner(t,o),g={target:t,action:d,actionHandler:c,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:n.x-t.left,offsetY:n.y-t.top,originX:u.x,originY:u.y,ex:n.x,ey:n.y,lastX:n.x,lastY:n.y,theta:ce(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:h,original:v(v({},zo(t)),{},{originX:u.x,originY:u.y})};this._currentTransform=g,this.fire("before:transform",{e,transform:g})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:s,deltaX:r,deltaY:n}=this._groupSelector,o=new _(t,s).transform(this.viewportTransform),l=new _(t+r,s+n).transform(this.viewportTransform),c=this.selectionLineWidth/2;let d=Math.min(o.x,l.x),h=Math.min(o.y,l.y),u=Math.max(o.x,l.x),g=Math.max(o.y,l.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(d,h,u-d,g-h)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,d+=c,h+=c,u-=c,g-=c,ve.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(d,h,u-d,g-h))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),s=this._activeObject,r=this.getActiveObjects();if(this.targets=[],s&&r.length>=1){if(s.findControl(t,Ci(e))||r.length>1&&this.searchPossibleTargets([s],t))return s;if(s===this.searchPossibleTargets([s],t)){if(this.preserveObjectStacking){const n=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==s?(this.targets=n,s):o}return s}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let s=e.getCoords();const r=this.getZoom(),n=e.padding/r;if(n){const[o,l,c,d]=s,h=Math.atan2(l.y-o.y,l.x-o.x),u=ct(h)*n,g=ht(h)*n,p=u+g,m=u-g;s=[new _(o.x-m,o.y-p),new _(l.x+p,l.y-m),new _(c.x+m,c.y+p),new _(d.x-p,d.y+m)]}return ie.isPointInPolygon(t,s)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,$t(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let s=e.length;for(;s--;){const r=e[s];if(this._checkTarget(r,t)){if(hr(r)&&r.subTargetCheck){const n=this._searchPossibleTargets(r._objects,t);n&&this.targets.push(n)}return r}}}searchPossibleTargets(e,t){const s=this._searchPossibleTargets(e,t);if(s&&hr(s)&&s.interactive&&this.targets[0]){const r=this.targets;for(let n=r.length-1;n>0;n--){const o=r[n];if(!hr(o)||!o.interactive)return o}return r[0]}return s}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=this.upperCanvasEl,r=s.getBoundingClientRect();let n=Vg(e),o=r.width||0,l=r.height||0;o&&l||(Ne in r&&ji in r&&(l=Math.abs(r.top-r.bottom)),le in r&&J in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,t||(n=$t(n,void 0,this.viewportTransform));const c=this.getRetinaScaling();c!==1&&(n.x/=c,n.y/=c);const d=o===0||l===0?new _(1,1):new _(s.width/o,s.height/l);return n.multiply(d)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Ve(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Ct(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let s=!1,r=!1;const n=this.getActiveObjects(),o=[],l=[];e.forEach(c=>{n.includes(c)||(s=!0,c.fire("deselected",{e:t,target:c}),l.push(c))}),n.forEach(c=>{e.includes(c)||(s=!0,c.fire("selected",{e:t,target:c}),o.push(c))}),e.length>0&&n.length>0?(r=!0,s&&this.fire("selection:updated",{e:t,selected:o,deselected:l})):n.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:l})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){const s=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(s,t),r}_setActiveObject(e,t){const s=this._activeObject;return s!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Ct(e)&&s!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const s=this._activeObject;return!!s&&!s.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===s&&this.endCurrentTransform(e),Ct(s)&&s===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),s=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[s]});const r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,s=t.target,r={e,target:s,transform:t,action:t.action};s._scaling&&(s._scaling=!1),s.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),s.fire(yr,r))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Ct(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,s){const r=this._realizeGroupTransformOnObject(e),n=super._toObject(e,t,s);return e.set(r),n}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Ct(t)&&this._activeObject===t){const s=rs(e,["angle","flipX","flipY",J,Ee,Fe,ts,ss,Ne]);return $g(e,t.calcOwnMatrix()),s}return{}}_setSVGObject(e,t,s){const r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,s),t.set(r)}}b(Ur,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Np{constructor(e){b(this,"targets",[]),b(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},s=e.upperCanvasEl;s.addEventListener("click",t),this.__disposer=()=>s.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Bt(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Tp=["target","oldTarget","fireCanvas","e"],De={passive:!1},It=(i,e)=>{const t=i.getViewportPoint(e),s=i.getScenePoint(e);return{viewportPoint:t,scenePoint:s,pointer:t,absolutePointer:s}},ft=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return i.addEventListener(...t)},Ae=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return i.removeEventListener(...t)},Op={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Mi extends Ur{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),b(this,"_isClick",void 0),b(this,"textEditingManager",new Np(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(ft,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const s=this.upperCanvasEl,r=this._getEventPrefix();e(Io(s),"resize",this._onResize),e(s,r+"down",this._onMouseDown),e(s,"".concat(r,"move"),this._onMouseMove,De),e(s,"".concat(r,"out"),this._onMouseOut),e(s,"".concat(r,"enter"),this._onMouseEnter),e(s,"wheel",this._onMouseWheel),e(s,"contextmenu",this._onContextMenu),e(s,"dblclick",this._onDoubleClick),e(s,"dragstart",this._onDragStart),e(s,"dragend",this._onDragEnd),e(s,"dragover",this._onDragOver),e(s,"dragenter",this._onDragEnter),e(s,"dragleave",this._onDragLeave),e(s,"drop",this._onDrop),this.enablePointerEvents||e(s,"touchstart",this._onTouchStart,De)}removeListeners(){this.addOrRemove(Ae,"remove");const e=this._getEventPrefix(),t=Be(this.upperCanvasEl);Ae(t,"".concat(e,"up"),this._onMouseUp),Ae(t,"touchend",this._onTouchEnd,De),Ae(t,"".concat(e,"move"),this._onMouseMove,De),Ae(t,"touchmove",this._onMouseMove,De),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,s=v({e},It(this,e));this.fire("mouse:out",v(v({},s),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",v({},s)),this._hoveredTargets.forEach(r=>{this.fire("mouse:out",v(v({},s),{},{target:r})),r&&r.fire("mouseout",v({},s))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",v({e},It(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const s={e,target:t};return this.fire("dragstart",s),t.fire("dragstart",s),void ft(this.upperCanvasEl,"drag",this._onDragProgress)}Si(e)}_renderDragEffects(e,t,s){let r=!1;const n=this._dropTarget;n&&n!==t&&n!==s&&(n.clearContextTop(),r=!0),t==null||t.clearContextTop(),s!==t&&(s==null||s.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),s&&(o.save(),s.transform(o),s.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Te,s=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:s};Ae(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:s,targets:r}=this.findDragTargets(e),n=this._dragSource,o={e,target:s,subTargets:r,dragSource:n,canDrop:!1,dropTarget:void 0};let l;this.fire(t,o),this._fireEnterLeaveEvents(s,o),s&&(s.canDrop(e)&&(l=s),s.fire(t,o));for(let c=0;c<r.length;c++){const d=r[c];d.canDrop(e)&&(l=d),d.fire(t,o)}this._renderDragEffects(e,n,l),this._dropTarget=l}_onDragEnter(e){const{target:t,targets:s}=this.findDragTargets(e),r={e,target:t,subTargets:s,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:s}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",v({e,target:t,subTargets:s,dragSource:this._dragSource},It(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){const t=this.findTarget(e),s=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:s});return this.stopContextMenu&&Si(e),this._basicEventHandler("contextmenu",r),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const s=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||s&&this._target===s)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const r=this.upperCanvasEl,n=this._getEventPrefix(),o=Be(r);ft(o,"touchend",this._onTouchEnd,De),t&&ft(o,"touchmove",this._onMouseMove,De),Ae(r,"".concat(n,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,s=this._getEventPrefix();Ae(t,"".concat(s,"move"),this._onMouseMove,De);const r=Be(t);ft(r,"".concat(s,"up"),this._onMouseUp),ft(r,"".concat(s,"move"),this._onMouseMove,De)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),s=Be(this.upperCanvasEl);Ae(s,"touchend",this._onTouchEnd,De),Ae(s,"touchmove",this._onMouseMove,De),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{ft(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,s=this._getEventPrefix();if(this._isMainEvent(e)){const r=Be(this.upperCanvasEl);Ae(r,"".concat(s,"up"),this._onMouseUp),Ae(r,"".concat(s,"move"),this._onMouseMove,De),ft(t,"".concat(s,"move"),this._onMouseMove,De)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const s=this._currentTransform,r=this._isClick,n=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let l,c,d=!1;if(s&&(this._finalizeCurrentTransform(e),d=s.actionPerformed),!r){const h=n===this._activeObject;this.handleSelection(e),d||(d=this._shouldRender(n)||!h&&n===this._activeObject)}if(n){const h=n.findControl(this.getViewportPoint(e),Ci(e)),{key:u,control:g}=h||{};if(c=u,n.selectable&&n!==this._activeObject&&n.activeOn==="up")this.setActiveObject(n,e),d=!0;else if(g){const p=g.getMouseUpHandler(e,n,g);p&&(l=this.getScenePoint(e),p.call(g,e,s,l.x,l.y))}n.isMoving=!1}if(s&&(s.target!==n||s.corner!==c)){const h=s.target&&s.target.controls[s.corner],u=h&&h.getMouseUpHandler(e,s.target,h);l=l||this.getScenePoint(e),u&&u.call(h,e,s,l.x,l.y)}this._setCursorFromEvent(e,n),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,n&&(n.__corner=void 0),d?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:s,subTargets:r=[]}=t;this.fire(e,t),s&&s.fire(e,t);for(let n=0;n<r.length;n++)r[n]!==s&&r[n].fire(e,t);return t}_handleEvent(e,t){const s=this._target,r=this.targets||[],n=v(v({e,target:s,subTargets:r},It(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),n),s&&s.fire("mouse".concat(t),n);for(let o=0;o<r.length;o++)r[o]!==s&&r[o].fire("mouse".concat(t),n)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let r=this._shouldRender(t),n=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,n=!0,r=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const o=this.getScenePoint(e);this._groupSelector={x:o.x,y:o.y,deltaY:0,deltaX:0}}if(t){const o=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const l=t.findControl(this.getViewportPoint(e),Ci(e));if(t===this._activeObject&&(l||!n)){this._setupCurrentTransform(e,t,o);const c=l?l.control:void 0,d=this.getScenePoint(e),h=c&&c.getMouseDownHandler(e,t,c);h&&h.call(c,e,this._currentTransform,d.x,d.y)}}r&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),r&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=$t(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const s=this.getScenePoint(e);t.deltaX=s.x-t.x,t.deltaY=s.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const s=this.findTarget(e);this._setCursorFromEvent(e,s),this._fireOverOutEvents(e,s)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const s=this._hoveredTarget,r=this._hoveredTargets,n=this.targets,o=Math.max(r.length,n.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:s,fireCanvas:!0});for(let l=0;l<o;l++)this.fireSyntheticInOutEvents("mouse",{e,target:n[l],oldTarget:r[l]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const s=this._draggedoverTarget,r=this._hoveredTargets,n=this.targets,o=Math.max(r.length,n.length);this.fireSyntheticInOutEvents("drag",v(v({},t),{},{target:e,oldTarget:s,fireCanvas:!0}));for(let l=0;l<o;l++)this.fireSyntheticInOutEvents("drag",v(v({},t),{},{target:n[l],oldTarget:r[l]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:s,oldTarget:r,fireCanvas:n,e:o}=t,l=re(t,Tp);const{targetIn:c,targetOut:d,canvasIn:h,canvasOut:u}=Op[e],g=r!==s;if(r&&g){const p=v(v({},l),{},{e:o,target:r,nextTarget:s},It(this,o));n&&this.fire(u,p),r.fire(d,p)}if(s&&g){const p=v(v({},l),{},{e:o,target:s,previousTarget:r},It(this,o));n&&this.fire(h,p),s.fire(c,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),s=this._currentTransform,r=s.target,n=r.group?$t(t,void 0,r.group.calcTransformMatrix()):t;s.shiftKey=e.shiftKey,s.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,s,n),s.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,s){const{action:r,actionHandler:n,target:o}=t,l=!!n&&n(e,t,s.x,s.y);l&&o.setCoords(),r==="drag"&&l&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||l}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let s=t.hoverCursor||this.hoverCursor;const r=Ct(this._activeObject)?this._activeObject:null,n=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(n){const o=n.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{s=o.hoverCursor||s}),this.setCursor(s)}handleMultiSelection(e,t){const s=this._activeObject,r=Ct(s);if(s&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(s!==t||r)&&(r||!t.isDescendantOf(s)&&!s.isDescendantOf(t))&&!t.onSelect({e})&&!s.getActiveControl()){if(r){const n=s.getObjects();if(t===s){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(n,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===s?(s.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],s.size()===1&&this._setActiveObject(s.item(0),e)):(s.multiSelectAdd(t),this._hoveredTarget=s,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(n,e)}else{s.isEditing&&s.exitEditing();const n=new(L.getClass("ActiveSelection"))([],{canvas:this});n.multiSelectAdd(s,t),this._hoveredTarget=n,this._setActiveObject(n,e),this._fireSelectionEvents([s],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:s,deltaX:r,deltaY:n}=this._groupSelector,o=new _(t,s),l=o.add(new _(r,n)),c=o.min(l),d=o.max(l).subtract(c),h=this.collectObjects({left:c.x,top:c.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),u=o.eq(l)?h[0]?[h[0]]:[]:h.length>1?h.filter(g=>!g.onSelect({e})).reverse():h;if(u.length===1)this.setActiveObject(u[0],e);else if(u.length>1){const g=L.getClass("ActiveSelection");this.setActiveObject(new g(u,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const dl={x1:0,y1:0,x2:0,y2:0},Ep=v(v({},dl),{},{r1:0,r2:0}),Wt=(i,e)=>isNaN(i)&&typeof e=="number"?e:i,Dp=/^(\d+\.\d+)%|(\d+)%$/;function ul(i){return i&&Dp.test(i)}function gl(i,e){const t=typeof i=="number"?i:typeof i=="string"?parseFloat(i)/(ul(i)?100:1):NaN;return Jt(0,Wt(t,e),1)}const Ap=/\s*;\s*/,Mp=/\s*:\s*/;function Pp(i,e){let t,s;const r=i.getAttribute("style");if(r){const o=r.split(Ap);o[o.length-1]===""&&o.pop();for(let l=o.length;l--;){const[c,d]=o[l].split(Mp).map(h=>h.trim());c==="stop-color"?t=d:c==="stop-opacity"&&(s=d)}}const n=new Z(t||i.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:gl(i.getAttribute("offset"),0),color:n.toRgb(),opacity:Wt(parseFloat(s||i.getAttribute("stop-opacity")||""),1)*n.getAlpha()*e}}function Fp(i,e){const t=[],s=i.getElementsByTagName("stop"),r=gl(e,1);for(let n=s.length;n--;)t.push(Pp(s[n],r));return t}function ml(i){return i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?"linear":"radial"}function pl(i){return i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Le(i,e){return i.getAttribute(e)}function Lp(i,e){return function(t,s){let r,{width:n,height:o,gradientUnits:l}=s;return Object.keys(t).reduce((c,d)=>{const h=t[d];return h==="Infinity"?r=1:h==="-Infinity"?r=0:(r=typeof h=="string"?parseFloat(h):h,typeof h=="string"&&ul(h)&&(r*=.01,l==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(r*=n),d!=="y1"&&d!=="y2"||(r*=o)))),c[d]=r,c},{})}(ml(i)==="linear"?function(t){return{x1:Le(t,"x1")||0,y1:Le(t,"y1")||0,x2:Le(t,"x2")||"100%",y2:Le(t,"y2")||0}}(i):function(t){return{x1:Le(t,"fx")||Le(t,"cx")||"50%",y1:Le(t,"fy")||Le(t,"cy")||"50%",r1:0,x2:Le(t,"cx")||"50%",y2:Le(t,"cy")||"50%",r2:Le(t,"r")||"50%"}}(i),v(v({},e),{},{gradientUnits:pl(i)}))}class Ls{constructor(e){const{type:t="linear",gradientUnits:s="pixels",coords:r={},colorStops:n=[],offsetX:o=0,offsetY:l=0,gradientTransform:c,id:d}=e||{};Object.assign(this,{type:t,gradientUnits:s,coords:v(v({},t==="radial"?Ep:dl),r),colorStops:n,offsetX:o,offsetY:l,gradientTransform:c,id:d?"".concat(d,"_").concat(vt()):vt()})}addColorStop(e){for(const t in e){const s=new Z(e[t]);this.colorStops.push({offset:parseFloat(t),color:s.toRgb(),opacity:s.getAlpha()})}return this}toObject(e){return v(v({},rs(this,e)),{},{type:this.type,coords:v({},this.coords),colorStops:this.colorStops.map(t=>v({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[],r=this.gradientTransform?this.gradientTransform.concat():_e.concat(),n=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(u=>v({},u)).sort((u,g)=>u.offset-g.offset);let l=-this.offsetX,c=-this.offsetY;var d;n==="objectBoundingBox"?(l/=e.width,c/=e.height):(l+=e.width/2,c+=e.height/2),(d=e)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=l,r[5]-=c;const h=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(n,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(wr(r),'"'),""].join(" ");if(this.type==="linear"){const{x1:u,y1:g,x2:p,y2:m}=this.coords;s.push("<linearGradient ",h,' x1="',u,'" y1="',g,'" x2="',p,'" y2="',m,`">
`)}else if(this.type==="radial"){const{x1:u,y1:g,x2:p,y2:m,r1:x,r2:f}=this.coords,y=x>f;s.push("<radialGradient ",h,' cx="',y?u:p,'" cy="',y?g:m,'" r="',y?x:f,'" fx="',y?p:u,'" fy="',y?m:g,`">
`),y&&(o.reverse(),o.forEach(j=>{j.offset=1-j.offset}));const w=Math.min(x,f);if(w>0){const j=w/Math.max(x,f);o.forEach(T=>{T.offset+=j*(1-T.offset)})}}return o.forEach(u=>{let{color:g,offset:p,opacity:m}=u;s.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',g,m!==void 0?";stop-opacity: "+m:";",`"/>
`)}),s.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),s.join("")}toLive(e){const{x1:t,y1:s,x2:r,y2:n,r1:o,r2:l}=this.coords,c=this.type==="linear"?e.createLinearGradient(t,s,r,n):e.createRadialGradient(t,s,o,r,n,l);return this.colorStops.forEach(d=>{let{color:h,opacity:u,offset:g}=d;c.addColorStop(g,u!==void 0?new Z(h).setAlpha(u).toRgba():h)}),c}static async fromObject(e){const{colorStops:t,gradientTransform:s}=e;return new this(v(v({},e),{},{colorStops:t?t.map(r=>v({},r)):void 0,gradientTransform:s?[...s]:void 0}))}static fromElement(e,t,s){const r=pl(e),n=t._findCenterFromElement();return new this(v({id:e.getAttribute("id")||void 0,type:ml(e),coords:Lp(e,{width:s.viewBoxWidth||s.width,height:s.viewBoxHeight||s.height}),colorStops:Fp(e,s.opacity),gradientUnits:r,gradientTransform:Oi(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-n.x,offsetY:t.height/2-n.y}:{offsetX:0,offsetY:0}))}}b(Ls,"type","Gradient"),L.setClass(Ls,"gradient"),L.setClass(Ls,"linear"),L.setClass(Ls,"radial");const Rp=["type","source","patternTransform"];class ni{get type(){return"pattern"}set type(e){bt("warn","Setting type has no effect",e)}constructor(e){b(this,"repeat","repeat"),b(this,"offsetX",0),b(this,"offsetY",0),b(this,"crossOrigin",""),this.id=vt(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:s}=this;return v(v({},rs(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:s,offsetX:ae(this.offsetX,q.NUM_FRACTION_DIGITS),offsetY:ae(this.offsetY,q.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:s}=e;const{source:r,repeat:n,id:o}=this,l=Wt(this.offsetX/t,0),c=Wt(this.offsetY/s,0),d=n==="repeat-y"||n==="no-repeat"?1+Math.abs(l||0):Wt(r.width/t,0),h=n==="repeat-x"||n==="no-repeat"?1+Math.abs(c||0):Wt(r.height/s,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(l,'" y="').concat(c,'" width="').concat(d,'" height="').concat(h,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:s,source:r,patternTransform:n}=e,o=re(e,Rp);const l=await ur(r,v(v({},t),{},{crossOrigin:o.crossOrigin}));return new this(v(v({},o),{},{patternTransform:n&&n.slice(0),source:l}))}}b(ni,"type","Pattern"),L.setClass(ni),L.setClass(ni,"pattern");const Ip=["path","left","top"],Bp=["d"];class St extends ve{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:s,left:r,top:n}=t,o=re(t,Ip);super(),Object.assign(this,St.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof r=="number"&&this.set(J,r),typeof n=="number"&&this.set(Ne,n)}_setPath(e,t){this.path=pp(Array.isArray(e)?e:Cp(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new _(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,s=-this.pathOffset.y;e.beginPath();for(const r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+s);break;case"M":e.moveTo(r[1]+t,r[2]+s);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+s,r[3]+t,r[4]+s,r[5]+t,r[6]+s);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+s,r[3]+t,r[4]+s);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=Sp(this.path,q.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=q.NUM_FRACTION_DIGITS;return" translate(".concat(ae(-this.pathOffset.x,e),", ").concat(ae(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:s,pathOffset:r}=this._calcDimensions();this.set({width:t,height:s,pathOffset:r}),e&&this.setPositionByOrigin(r,Y,Y)}_calcBoundsFromPath(){const e=[];let t=0,s=0,r=0,n=0;for(const o of this.path)switch(o[0]){case"L":r=o[1],n=o[2],e.push({x:t,y:s},{x:r,y:n});break;case"M":r=o[1],n=o[2],t=r,s=n;break;case"C":e.push(...ma(r,n,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],n=o[6];break;case"Q":e.push(...ma(r,n,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],n=o[4];break;case"Z":r=t,n=s}return ot(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return v(v({},e),{},{pathOffset:new _(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,s){const r=ut(e,this.ATTRIBUTE_NAMES,s),{d:n}=r;return new this(n,v(v(v({},re(r,Bp)),t),{},{left:void 0,top:void 0}))}}b(St,"type","Path"),b(St,"cacheProperties",[...dt,"path","fillRule"]),b(St,"ATTRIBUTE_NAMES",[..._t,"d"]),L.setClass(St),L.setSVGClass(St);const Hp=["left","top","radius"],fl=["radius","startAngle","endAngle","counterClockwise"];class st extends ve{static getDefaults(){return v(v({},super.getDefaults()),st.ownDefaults)}constructor(e){super(),Object.assign(this,st.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,ce(this.startAngle),ce(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Ee)}getRadiusY(){return this.get("radius")*this.get(Fe)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...fl,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,s=ce(this.startAngle),r=ce(this.endAngle),n=ct(s)*t,o=ht(s)*t,l=ct(r)*t,c=ht(r)*t,d=e>180?1:0,h=this.counterClockwise?0:1;return['<path d="M '.concat(n," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(d," ").concat(h," ").concat(l," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,s){const r=ut(e,this.ATTRIBUTE_NAMES,s),{left:n=0,top:o=0,radius:l=0}=r;return new this(v(v({},re(r,Hp)),{},{radius:l,left:n-l,top:o-l}))}static fromObject(e){return super._fromObject(e)}}b(st,"type","Circle"),b(st,"cacheProperties",[...dt,...fl]),b(st,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),b(st,"ATTRIBUTE_NAMES",["cx","cy","r",..._t]),L.setClass(st),L.setSVGClass(st);const zp=["x1","y1","x2","y2"],Wp=["x1","y1","x2","y2"],Pi=["x1","x2","y1","y2"];class kt extends ve{constructor(){let[e,t,s,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,kt.ownDefaults),this.setOptions(n),this.x1=e,this.x2=s,this.y1=t,this.y2=r,this._setWidthHeight();const{left:o,top:l}=n;typeof o=="number"&&this.set(J,o),typeof l=="number"&&this.set(Ne,l)}_setWidthHeight(){const{x1:e,y1:t,x2:s,y2:r}=this;this.width=Math.abs(s-e),this.height=Math.abs(r-t);const{left:n,top:o,width:l,height:c}=ot([{x:e,y:t},{x:s,y:r}]),d=new _(n+l/2,o+c/2);this.setPositionByOrigin(d,Y,Y)}_set(e,t){return super._set(e,t),Pi.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const s=e.strokeStyle;var r;Me(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=s}_findCenterFromElement(){return new _((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:s,y2:r,width:n,height:o}=this,l=e<=t?-1:1,c=s<=r?-1:1;return{x1:l*n/2,x2:l*-n/2,y1:c*o/2,y2:c*-o/2}}_toSVG(){const{x1:e,x2:t,y1:s,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(s,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static async fromElement(e,t,s){const r=ut(e,this.ATTRIBUTE_NAMES,s),{x1:n=0,y1:o=0,x2:l=0,y2:c=0}=r;return new this([n,o,l,c],re(r,zp))}static fromObject(e){let{x1:t,y1:s,x2:r,y2:n}=e,o=re(e,Wp);return this._fromObject(v(v({},o),{},{points:[t,s,r,n]}),{extraParam:"points"})}}b(kt,"type","Line"),b(kt,"cacheProperties",[...dt,...Pi]),b(kt,"ATTRIBUTE_NAMES",_t.concat(Pi)),L.setClass(kt),L.setSVGClass(kt);class Tt extends ve{static getDefaults(){return v(v({},super.getDefaults()),Tt.ownDefaults)}constructor(e){super(),Object.assign(this,Tt.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,s=this.height/2;e.beginPath(),e.moveTo(-t,s),e.lineTo(0,-s),e.lineTo(t,s),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}b(Tt,"type","Triangle"),b(Tt,"ownDefaults",{width:100,height:100}),L.setClass(Tt),L.setSVGClass(Tt);const xl=["rx","ry"];class rt extends ve{static getDefaults(){return v(v({},super.getDefaults()),rt.ownDefaults)}constructor(e){super(),Object.assign(this,rt.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Ee)}getRy(){return this.get("ry")*this.get(Fe)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...xl,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,fr,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,s){const r=ut(e,this.ATTRIBUTE_NAMES,s);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}}function Vp(i){if(!i)return[];const e=i.replace(/,/g," ").trim().split(/\s+/),t=[];for(let s=0;s<e.length;s+=2)t.push({x:parseFloat(e[s]),y:parseFloat(e[s+1])});return t}b(rt,"type","Ellipse"),b(rt,"cacheProperties",[...dt,...xl]),b(rt,"ownDefaults",{rx:0,ry:0}),b(rt,"ATTRIBUTE_NAMES",[..._t,"cx","cy","rx","ry"]),L.setClass(rt),L.setSVGClass(rt);const Up=["left","top"],yl={exactBoundingBox:!1};class Ie extends ve{static getDefaults(){return v(v({},super.getDefaults()),Ie.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),b(this,"strokeDiff",void 0),Object.assign(this,Ie.ownDefaults),this.setOptions(t),this.points=e;const{left:s,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof s=="number"&&this.set(J,s),typeof r=="number"&&this.set(Ne,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return Mm(this.points,e,this.isOpen())}_calcDimensions(e){e=v({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(d=>d.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new _,strokeOffset:new _,strokeDiff:new _};const s=ot(t),r=Ir(v(v({},e),{},{scaleX:1,scaleY:1})),n=ot(this.points.map(d=>Ce(d,r,!0))),o=new _(this.scaleX,this.scaleY);let l=s.left+s.width/2,c=s.top+s.height/2;return this.exactBoundingBox&&(l-=c*Math.tan(ce(this.skewX)),c-=l*Math.tan(ce(this.skewY))),v(v({},s),{},{pathOffset:new _(l,c),strokeOffset:new _(n.left,n.top).subtract(new _(s.left,s.top)).multiply(o),strokeDiff:new _(s.width,s.height).subtract(new _(n.width,n.height)).multiply(o)})}_findCenterFromElement(){const e=ot(this.points);return new _(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:s,width:r,height:n,pathOffset:o,strokeOffset:l,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:n,pathOffset:o,strokeOffset:l,strokeDiff:c}),e&&this.setPositionByOrigin(new _(t+r/2,s+n/2),Y,Y)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new _(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var t,s;const{width:l,height:c}=this._calcDimensions(e);o=new _((t=e.width)!==null&&t!==void 0?t:l,(s=e.height)!==null&&s!==void 0?s:c)}else{var r,n;o=new _((r=e.width)!==null&&r!==void 0?r:this.width,(n=e.height)!==null&&n!==void 0?n:this.height)}return o.multiply(new _(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const s=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&s&&((e===Ee||e===Fe)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:s,y:r}=t;return{x:s,y:r}})})}_toSVG(){const e=[],t=this.pathOffset.x,s=this.pathOffset.y,r=q.NUM_FRACTION_DIGITS;for(let n=0,o=this.points.length;n<o;n++)e.push(ae(this.points[n].x-t,r),",",ae(this.points[n].y-s,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,s=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-s,this.points[0].y-r);for(let n=0;n<t;n++){const o=this.points[n];e.lineTo(o.x-s,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,s){return new this(Vp(e.getAttribute("points")),v(v({},re(ut(e,this.ATTRIBUTE_NAMES,s),Up)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}b(Ie,"ownDefaults",yl),b(Ie,"type","Polyline"),b(Ie,"layoutProperties",[ts,ss,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),b(Ie,"cacheProperties",[...dt,"points"]),b(Ie,"ATTRIBUTE_NAMES",[..._t]),L.setClass(Ie),L.setSVGClass(Ie);class Rs extends Ie{isOpen(){return!1}}b(Rs,"ownDefaults",yl),b(Rs,"type","Polygon"),L.setClass(Rs),L.setSVGClass(Rs);const bl=["fontSize","fontWeight","fontFamily","fontStyle"],vl=["underline","overline","linethrough"],wl=[...bl,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],jl=[...wl,...vl,"textBackgroundColor","direction"],$p=[...bl,...vl,Oe,"strokeWidth",ge,"deltaY","textBackgroundColor"],Yp={_reNewline:Yi,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:J,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:J,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Ge="justify",Nr="justify-left",ds="justify-right",us="justify-center";class _l extends ve{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const s in t)for(const r in t[s])for(const n in t[s][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const s=t===void 0?this.styles:{0:this.styles[t]};for(const r in s)for(const n in s[r])if(s[r][n][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let s,r,n=0,o=!0,l=0;for(const c in t){s=0;for(const d in t[c]){const h=t[c][d]||{};n++,h[e]!==void 0?(r?h[e]!==r&&(o=!1):r=h[e],h[e]===this[e]&&delete h[e]):o=!1,Object.keys(h).length!==0?s++:delete t[c][d]}s===0&&delete t[c]}for(let c=0;c<this._textLines.length;c++)l+=this._textLines[c].length;o&&n===l&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let s,r,n;for(r in t){for(n in s=t[r],s)delete s[n][e],Object.keys(s[n]).length===0&&delete s[n];Object.keys(s).length===0&&delete t[r]}}_extendStyles(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(s)||this._setLineStyle(s);const n=Ji(v(v({},this._getStyleDeclaration(s,r)),t),o=>o!==void 0);this._setStyleDeclaration(s,r,n)}getSelectionStyles(e,t,s){const r=[];for(let n=e;n<(t||e);n++)r.push(this.getStyleAtPosition(n,s));return r}getStyleAtPosition(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(s,r):this._getStyleDeclaration(s,r)}setSelectionStyles(e,t,s){for(let r=t;r<(s||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var s;const r=this.styles&&this.styles[e];return r&&(s=r[t])!==null&&s!==void 0?s:{}}getCompleteStyleDeclaration(e,t){return v(v({},rs(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,s){this.styles[e][t]=s}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}b(_l,"_styleProperties",$p);const Xp=/  +/g,Gp=/"/g;function ai(i,e,t,s,r){return"		".concat(function(n,o){let{left:l,top:c,width:d,height:h}=o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:q.NUM_FRACTION_DIGITS;const g=fs(ge,n,!1),[p,m,x,f]=[l,c,d,h].map(y=>ae(y,u));return"<rect ".concat(g,' x="').concat(p,'" y="').concat(m,'" width="').concat(x,'" height="').concat(f,'"></rect>')}(i,{left:e,top:t,width:s,height:r}),`
`)}const qp=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let oi;class we extends _l{static getDefaults(){return v(v({},super.getDefaults()),we.ownDefaults)}constructor(e,t){super(),b(this,"__charBounds",[]),Object.assign(this,we.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=hl(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Ge)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,s,r,n,o,l;for(let c=0,d=this._textLines.length;c<d;c++)if((this.textAlign===Ge||c!==d-1&&!this.isEndOfWrapping(c))&&(r=0,n=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(l=this.textLines[c].match(this._reSpacesAndTabs)))){s=l.length,e=(this.width-t)/s;for(let h=0;h<=n.length;h++)o=this.__charBounds[c][h],this._reSpaceAndTab.test(n[h])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const s=t?this._unwrappedTextLines:this._textLines;let r;for(r=0;r<s.length;r++){if(e<=s[r].length)return{lineIndex:r,charIndex:e};e-=s[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:s[r-1].length<e?s[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Oe?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,s){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Y:e.textBaseline="middle";break;case"ascender":e.textBaseline=Ne;break;case"descender":e.textBaseline=ji}e.font=this._getFontDeclaration(t,s)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,s=this._textLines.length;t<s;t++){const r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,s,r,n,o){this._renderChars(e,t,s,r,n,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,s=this._getLeftOffset();let r=this._getTopOffset();for(let n=0,o=this._textLines.length;n<o;n++){const l=this.getHeightOfLine(n);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",n)){r+=l;continue}const c=this._textLines[n].length,d=this._getLineLeftOffset(n);let h,u,g=0,p=0,m=this.getValueOfPropertyAt(n,0,"textBackgroundColor");for(let x=0;x<c;x++){const f=this.__charBounds[n][x];u=this.getValueOfPropertyAt(n,x,"textBackgroundColor"),this.path?(e.save(),e.translate(f.renderLeft,f.renderTop),e.rotate(f.angle),e.fillStyle=u,u&&e.fillRect(-f.width/2,-l/this.lineHeight*(1-this._fontSizeFraction),f.width,l/this.lineHeight),e.restore()):u!==m?(h=s+d+p,this.direction==="rtl"&&(h=this.width-h-g),e.fillStyle=m,m&&e.fillRect(h,r,g,l/this.lineHeight),p=f.left,g=f.width,m=u):g+=f.kernedWidth}u&&!this.path&&(h=s+d+p,this.direction==="rtl"&&(h=this.width-h-g),e.fillStyle=u,e.fillRect(h,r,g,l/this.lineHeight)),r+=l}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,s,r){const n=cs.getFontCache(t),o=this._getFontDeclaration(t),l=s+e,c=s&&o===this._getFontDeclaration(r),d=t.fontSize/this.CACHE_FONT_SIZE;let h,u,g,p;if(s&&n[s]!==void 0&&(g=n[s]),n[e]!==void 0&&(p=h=n[e]),c&&n[l]!==void 0&&(u=n[l],p=u-g),h===void 0||g===void 0||u===void 0){const m=function(){return oi||(oi=Ze({width:0,height:0}).getContext("2d")),oi}();this._setTextStyles(m,t,!0),h===void 0&&(p=h=m.measureText(e).width,n[e]=h),g===void 0&&c&&s&&(g=m.measureText(s).width,n[s]=g),c&&u===void 0&&(u=m.measureText(l).width,n[l]=u,p=u-g)}return{width:h*d,kernedWidth:p*d}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,s,r=0;const n=this.pathSide===le,o=this.path,l=this._textLines[e],c=l.length,d=new Array(c);this.__charBounds[e]=d;for(let h=0;h<c;h++){const u=l[h];s=this._getGraphemeBox(u,e,h,t),d[h]=s,r+=s.kernedWidth,t=u}if(d[c]={left:s?s.left+s.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let h=0;const u=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case J:h=n?u-r:0;break;case Y:h=(u-r)/2;break;case le:h=n?0:u-r}h+=this.pathStartOffset*(n?-1:1);for(let g=n?c-1:0;n?g>=0:g<c;n?g--:g++)s=d[g],h>u?h%=u:h<0&&(h+=u),this._setGraphemeOnPath(h,s),h+=s.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){const s=e+t.kernedWidth/2,r=this.path,n=vp(r.path,s,r.segmentsInfo);t.renderLeft=n.x-r.pathOffset.x,t.renderTop=n.y-r.pathOffset.y,t.angle=n.angle+(this.pathSide===le?Math.PI:0)}_getGraphemeBox(e,t,s,r,n){const o=this.getCompleteStyleDeclaration(t,s),l=r?this.getCompleteStyleDeclaration(t,s-1):{},c=this._measureChar(e,o,r,l);let d,h=c.kernedWidth,u=c.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),u+=d,h+=d);const g={width:u,left:0,height:o.fontSize,kernedWidth:h,deltaY:o.deltaY};if(s>0&&!n){const p=this.__charBounds[t][s-1];g.left=p.left+p.width+c.kernedWidth-c.width}return g}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let s=1,r=this._textLines[e].length;s<r;s++)t=Math.max(this.getHeightOfChar(e,s),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let s=0,r=this._textLines.length;s<r;s++)e=this.getHeightOfLine(s),t+=s===r-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let s=0;const r=this._getLeftOffset(),n=this._getTopOffset();for(let o=0,l=this._textLines.length;o<l;o++){const c=this.getHeightOfLine(o),d=c/this.lineHeight,h=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],r+h,n+s+d,o),s+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(ge))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,s,r,n,o){const l=this.getHeightOfLine(o),c=this.textAlign.includes(Ge),d=this.path,h=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!d,u=this.direction==="ltr",g=this.direction==="ltr"?1:-1,p=t.direction;let m,x,f,y,w,j="",T=0;if(t.save(),p!==this.direction&&(t.canvas.setAttribute("dir",u?"ltr":"rtl"),t.direction=u?"ltr":"rtl",t.textAlign=u?J:le),n-=l*this._fontSizeFraction/this.lineHeight,h)return this._renderChar(e,t,o,0,s.join(""),r,n),void t.restore();for(let A=0,P=s.length-1;A<=P;A++)y=A===P||this.charSpacing||d,j+=s[A],f=this.__charBounds[o][A],T===0?(r+=g*(f.kernedWidth-f.width),T+=f.width):T+=f.kernedWidth,c&&!y&&this._reSpaceAndTab.test(s[A])&&(y=!0),y||(m=m||this.getCompleteStyleDeclaration(o,A),x=this.getCompleteStyleDeclaration(o,A+1),y=an(m,x,!1)),y&&(d?(t.save(),t.translate(f.renderLeft,f.renderTop),t.rotate(f.angle),this._renderChar(e,t,o,A,j,-T/2,0),t.restore()):(w=r,this._renderChar(e,t,o,A,j,w,n)),j="",m=x,r+=g*T,T=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,s=this.height+this.strokeWidth,r=Ze({width:t,height:s}),n=r.getContext("2d");return r.width=t,r.height=s,n.beginPath(),n.moveTo(0,0),n.lineTo(t,0),n.lineTo(t,s),n.lineTo(0,s),n.closePath(),n.translate(t/2,s/2),n.fillStyle=e.toLive(n),this._applyPatternGradientTransform(n,e),n.fill(),n.createPattern(r,"no-repeat")}handleFiller(e,t,s){let r,n;return Me(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?(r=-this.width/2,n=-this.height/2,e.translate(r,n),e[t]=this._applyPatternGradientTransformText(s),{offsetX:r,offsetY:n}):(e[t]=s.toLive(e),this._applyPatternGradientTransform(e,s)):(e[t]=s,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:s,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",s)}_setFillStyles(e,t){let{fill:s}=t;return this.handleFiller(e,"fillStyle",s)}_renderChar(e,t,s,r,n,o,l){const c=this._getStyleDeclaration(s,r),d=this.getCompleteStyleDeclaration(s,r),h=e==="fillText"&&d.fill,u=e==="strokeText"&&d.stroke&&d.strokeWidth;if(u||h){if(t.save(),t.font=this._getFontDeclaration(d),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(l+=c.deltaY),h){const g=this._setFillStyles(t,d);t.fillText(n,o-g.offsetX,l-g.offsetY)}if(u){const g=this._setStrokeStyles(t,d);t.strokeText(n,o-g.offsetX,l-g.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,s){const r=this.get2DCursorLocation(e,!0),n=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),l={fontSize:n*s.size,deltaY:o+n*s.baseline};this.setSelectionStyles(l,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),s=this.width-t,r=this.textAlign,n=this.direction,o=this.isEndOfWrapping(e);let l=0;return r===Ge||r===us&&!o||r===ds&&!o||r===Nr&&!o?0:(r===Y&&(l=s/2),r===le&&(l=s),r===us&&(l=s/2),r===ds&&(l=s),n==="rtl"&&(r===le||r===Ge||r===ds?l=0:r===J||r===Nr?l=-s:r!==Y&&r!==us||(l=-s/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,s){var r;return(r=this._getStyleDeclaration(e,t)[s])!==null&&r!==void 0?r:this[s]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let s=this._getTopOffset();const r=this._getLeftOffset(),n=this.path,o=this._getWidthOfCharSpacing(),l=this.offsets[t];for(let c=0,d=this._textLines.length;c<d;c++){const h=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){s+=h;continue}const u=this._textLines[c],g=h/this.lineHeight,p=this._getLineLeftOffset(c);let m,x,f=0,y=0,w=this.getValueOfPropertyAt(c,0,t),j=this.getValueOfPropertyAt(c,0,ge);const T=s+g*(1-this._fontSizeFraction);let A=this.getHeightOfChar(c,0),P=this.getValueOfPropertyAt(c,0,"deltaY");for(let E=0,D=u.length;E<D;E++){const R=this.__charBounds[c][E];m=this.getValueOfPropertyAt(c,E,t),x=this.getValueOfPropertyAt(c,E,ge);const O=this.getHeightOfChar(c,E),W=this.getValueOfPropertyAt(c,E,"deltaY");if(n&&m&&x)e.save(),e.fillStyle=j,e.translate(R.renderLeft,R.renderTop),e.rotate(R.angle),e.fillRect(-R.kernedWidth/2,l*O+W,R.kernedWidth,this.fontSize/15),e.restore();else if((m!==w||x!==j||O!==A||W!==P)&&y>0){let C=r+p+f;this.direction==="rtl"&&(C=this.width-C-y),w&&j&&(e.fillStyle=j,e.fillRect(C,T+l*A+P,y,this.fontSize/15)),f=R.left,y=R.width,w=m,j=x,A=O,P=W}else y+=R.kernedWidth}let N=r+p+f;this.direction==="rtl"&&(N=this.width-N-y),e.fillStyle=x,m&&x&&e.fillRect(N,T+l*A+P,y-o,this.fontSize/15),s+=h}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:s=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||we.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,s,"".concat(n?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return nn(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),s=new Array(t.length),r=[`
`];let n=[];for(let o=0;o<t.length;o++)s[o]=this.graphemeSplit(t[o]),n=n.concat(s[o],r);return n.pop(),{_unwrappedLines:s,lines:t,graphemeText:n,graphemeLines:s}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject([...jl,...e])),{},{styles:Lm(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:s}=this.constructor;super.set(e,t);let r=!1,n=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),r=r||s.includes(o),n=n||o==="path";else r=s.includes(e),n=e==="path";return n&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,s){const r=ut(e,we.ATTRIBUTE_NAMES,s),n=v(v({},t),r),{textAnchor:o=J,textDecoration:l="",dx:c=0,dy:d=0,top:h=0,left:u=0,fontSize:g=$i,strokeWidth:p=1}=n,m=re(n,qp),x=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),v({left:u+c,top:h+d,underline:l.includes("underline"),overline:l.includes("overline"),linethrough:l.includes("line-through"),strokeWidth:0,fontSize:g},m)),f=x.getScaledHeight()/x.height,y=((x.height+x.strokeWidth)*x.lineHeight-x.height)*f,w=x.getScaledHeight()+y;let j=0;return o===Y&&(j=x.getScaledWidth()/2),o===le&&(j=x.getScaledWidth()),x.set({left:x.left-j,top:x.top-(w-x.fontSize*(.07+x._fontSizeFraction))/x.lineHeight,strokeWidth:p}),x}static fromObject(e){return this._fromObject(v(v({},e),{},{styles:Rm(e.styles||{},e.text)}),{extraParam:"text"})}}b(we,"textLayoutProperties",wl),b(we,"cacheProperties",[...dt,...jl]),b(we,"ownDefaults",Yp),b(we,"type","Text"),b(we,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),b(we,"ATTRIBUTE_NAMES",_t.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),tl(we,[class extends Yo{_toSVG(){const i=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(i){let{textBgRects:e,textSpans:t}=i;const s=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(Gp,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",s?'text-decoration="'.concat(s,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(i,e){const t=[],s=[];let r,n=i;this.backgroundColor&&s.push(...ai(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,l=this._textLines.length;o<l;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(s,o,e+r,n),this._setSVGTextLineText(t,o,e+r,n),n+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:s}}_createTextCharSpan(i,e,t,s){const r=this.getSvgSpanStyles(e,i!==i.trim()||!!i.match(Xp)),n=r?'style="'.concat(r,'"'):"",o=e.deltaY,l=o?' dy="'.concat(ae(o,q.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(ae(t,q.NUM_FRACTION_DIGITS),'" y="').concat(ae(s,q.NUM_FRACTION_DIGITS),'" ').concat(l).concat(n,">").concat(Pm(i),"</tspan>")}_setSVGTextLineText(i,e,t,s){const r=this.getHeightOfLine(e),n=this.textAlign.includes(Ge),o=this._textLines[e];let l,c,d,h,u,g="",p=0;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let m=0,x=o.length-1;m<=x;m++)u=m===x||this.charSpacing,g+=o[m],d=this.__charBounds[e][m],p===0?(t+=d.kernedWidth-d.width,p+=d.width):p+=d.kernedWidth,n&&!u&&this._reSpaceAndTab.test(o[m])&&(u=!0),u||(l=l||this.getCompleteStyleDeclaration(e,m),c=this.getCompleteStyleDeclaration(e,m+1),u=an(l,c,!0)),u&&(h=this._getStyleDeclaration(e,m),i.push(this._createTextCharSpan(g,h,t,s)),g="",l=c,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(i,e,t,s){const r=this._textLines[e],n=this.getHeightOfLine(e)/this.lineHeight;let o,l=0,c=0,d=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let h=0;h<r.length;h++){const{left:u,width:g,kernedWidth:p}=this.__charBounds[e][h];o=this.getValueOfPropertyAt(e,h,"textBackgroundColor"),o!==d?(d&&i.push(...ai(d,t+c,s,l,n)),c=u,l=g,d=o):l+=p}o&&i.push(...ai(d,t+c,s,l,n))}_getSVGLineTopOffset(i){let e,t=0;for(e=0;e<i;e++)t+=this.getHeightOfLine(e);const s=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*s/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(i){return"".concat(super.getSvgStyles(i)," white-space: pre;")}getSvgSpanStyles(i,e){const{fontFamily:t,strokeWidth:s,stroke:r,fill:n,fontSize:o,fontStyle:l,fontWeight:c,deltaY:d}=i,h=this.getSvgTextDecoration(i);return[r?fs(Oe,r):"",s?"stroke-width: ".concat(s,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",l?"font-style: ".concat(l,"; "):"",c?"font-weight: ".concat(c,"; "):"",h&&"text-decoration: ".concat(h,"; "),n?fs(ge,n):"",d?"baseline-shift: ".concat(-d,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(i){return["overline","underline","line-through"].filter(e=>i[e.replace("-","")]).join(" ")}}]),L.setClass(we),L.setSVGClass(we);class Kp{constructor(e){b(this,"target",void 0),b(this,"__mouseDownInPlace",!1),b(this,"__dragStartFired",!1),b(this,"__isDraggingOver",!1),b(this,"__dragStartSelection",void 0),b(this,"__dragImageDisposer",void 0),b(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(s=>s()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,s=t.getSelectionStartFromPointer(e);return t.isEditing&&s>=t.selectionStart&&s<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var s;let{selectionStart:r,selectionEnd:n}=t;const o=this.target,l=o.canvas,c=new _(o.flipX?-1:1,o.flipY?-1:1),d=o._getCursorBoundaries(r),h=new _(d.left+d.leftOffset,d.top+d.topOffset).multiply(c).transform(o.calcTransformMatrix()),u=l.getScenePoint(e).subtract(h),g=o.getCanvasRetinaScaling(),p=o.getBoundingRect(),m=h.subtract(new _(p.left,p.top)),x=l.viewportTransform,f=m.add(u).transform(x,!0),y=o.backgroundColor,w=rn(o.styles);o.backgroundColor="";const j={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(j,0,r),o.setSelectionStyles(j,n,o.text.length),o.dirty=!0;const T=o.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=y,o.styles=w,o.dirty=!0,Ai(T,{position:"fixed",left:"".concat(-T.width,"px"),border:Te,width:"".concat(T.width/g,"px"),height:"".concat(T.height/g,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{T.remove()},Be(e.target||this.target.hiddenTextarea).body.appendChild(T),(s=e.dataTransfer)===null||s===void 0||s.setDragImage(T,f.x,f.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,s=this.isActive();if(s&&e.dataTransfer){const r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},n=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=v({text:t.text,value:n},r);e.dataTransfer.setData("text/plain",n),e.dataTransfer.setData("application/fabric",JSON.stringify({value:n,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),s}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),s=this.__dragStartSelection;return t<s.selectionStart||t>s.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const s=this.targetCanDrop(t);!this.__isDraggingOver&&s&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,s=this.targetCanDrop(t);!this.__isDraggingOver&&s?this.__isDraggingOver=!0:this.__isDraggingOver&&!s&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:s}=e,r=s.defaultPrevented;this.__isDraggingOver=!1,s.preventDefault();let n=(t=s.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(n&&!r){const o=this.target,l=o.canvas;let c=o.getSelectionStartFromPointer(s);const{styles:d}=s.dataTransfer.types.includes("application/fabric")?JSON.parse(s.dataTransfer.getData("application/fabric")):{},h=n[Math.max(0,n.length-1)],u=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;c>g&&c<=p?c=g:c>p&&(c-=p-g),o.removeChars(g,p),delete this.__dragStartSelection}o._reNewline.test(h)&&(o._reNewline.test(o._text[c])||c===o._text.length)&&(n=n.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(n,d,c),l.setActiveObject(o),o.enterEditing(s),o.selectionStart=Math.min(c+u,o._text.length),o.selectionEnd=Math.min(o.selectionStart+n.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(xr,{index:c+u,action:"drop"}),l.fire("text:changed",{target:o}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var s;const r=this.target,n=this.target.canvas,{selectionStart:o,selectionEnd:l}=this.__dragStartSelection,c=((s=t.dataTransfer)===null||s===void 0?void 0:s.dropEffect)||Te;c===Te?(r.selectionStart=o,r.selectionEnd=l,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(o,l),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(xr,{index:o,action:"dragend"}),n.fire("text:changed",{target:r}),n.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const xa=/[ \n\.,;!\?\-]/;class Jp extends we{constructor(){super(...arguments),b(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:s,delay:r,onComplete:n}=e;return Ko({startValue:this._currentCursorOpacity,endValue:t,duration:s,delay:r,onComplete:n,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,s=e-1;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)t++,s--;for(;/\S/.test(this._text[s])&&s>-1;)t++,s--;return e-t}findWordBoundaryRight(e){let t=0,s=e;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)t++,s++;for(;/\S/.test(this._text[s])&&s<this._text.length;)t++,s++;return e+t}findLineBoundaryLeft(e){let t=0,s=e-1;for(;!/\n/.test(this._text[s])&&s>-1;)t++,s--;return e-t}findLineBoundaryRight(e){let t=0,s=e;for(;!/\n/.test(this._text[s])&&s<this._text.length;)t++,s++;return e+t}searchWordBoundary(e,t){const s=this._text;let r=e>0&&this._reSpace.test(s[e])&&(t===-1||!Yi.test(s[e-1]))?e-1:e,n=s[r];for(;r>0&&r<s.length&&!xa.test(n);)r+=t,n=s[r];return t===-1&&xa.test(n)&&r++,r}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),s=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Be(t).activeElement!==t&&t.focus();const s=this.getSelectionStartFromPointer(e),r=this.selectionStart,n=this.selectionEnd;(s===this.__selectionStartOnMouseDown&&r!==n||r!==s&&n!==s)&&(s>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=s):(this.selectionStart=s,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===n||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,s){const r=s.slice(0,e),n=this.graphemeSplit(r).length;if(e===t)return{selectionStart:n,selectionEnd:n};const o=s.slice(e,t);return{selectionStart:n,selectionEnd:n+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,s){const r=s.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+s.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),s=this.get2DCursorLocation(e),r=s.lineIndex,n=s.charIndex,o=this.getValueOfPropertyAt(r,n,"fontSize")*this.lineHeight,l=t.leftOffset,c=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,h=d.width/c,u=d.height/c,g=h-o,p=u-o,m=new _(t.left+l,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new _(d.clientWidth/h,d.clientHeight/u));return m.x<0&&(m.x=0),m.x>g&&(m.x=g),m.y<0&&(m.y=0),m.y>p&&(m.y=p),m.x+=this.canvas._offset.left,m.y+=this.canvas._offset.top,{left:"".concat(m.x,"px"),top:"".concat(m.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(yr),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:n,charIndex:o}=this.get2DCursorLocation(t,!0);if(s!==n){if(this.styles[s])for(let l=r;l<this._unwrappedTextLines[s].length;l++)delete this.styles[s][l];if(this.styles[n])for(let l=o;l<this._unwrappedTextLines[n].length;l++){const c=this.styles[n][l];c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+l-o]=c)}for(let l=s+1;l<=n;l++)delete this.styles[l];this.shiftLineStyles(n,s-n)}else if(this.styles[s]){const l=this.styles[s],c=o-r;for(let d=r;d<o;d++)delete l[d];for(const d in this.styles[s]){const h=parseInt(d,10);h>=o&&(l[h-c]=l[d],delete l[d])}}}shiftLineStyles(e,t){const s=Object.assign({},this.styles);for(const r in this.styles){const n=parseInt(r,10);n>e&&(this.styles[n+t]=s[n],s[n-t]||delete this.styles[n])}}insertNewlineStyleObject(e,t,s,r){const n={},o=this._unwrappedTextLines[e].length,l=o===t;let c=!1;s||(s=1),this.shiftLineStyles(e,s);const d=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const u in this.styles[e]){const g=parseInt(u,10);g>=t&&(c=!0,n[g-t]=this.styles[e][u],l&&t===0||delete this.styles[e][u])}let h=!1;for(c&&!l&&(this.styles[e+s]=n,h=!0),(h||o>t)&&s--;s>0;)r&&r[s-1]?this.styles[e+s]={0:v({},r[s-1])}:d?this.styles[e+s]={0:v({},d)}:delete this.styles[e+s],s--;this._forceClearCache=!0}insertCharStyleObject(e,t,s,r){this.styles||(this.styles={});const n=this.styles[e],o=n?v({},n):{};s||(s=1);for(const c in o){const d=parseInt(c,10);d>=t&&(n[d+s]=o[d],o[d-s]||delete n[d])}if(this._forceClearCache=!0,r){for(;s--;)Object.keys(r[s]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+s]=v({},r[s]));return}if(!n)return;const l=n[t?t-1:1];for(;l&&s--;)this.styles[e][t+s]=v({},l)}insertNewStyleBlock(e,t,s){const r=this.get2DCursorLocation(t,!0),n=[0];let o,l=0;for(let c=0;c<e.length;c++)e[c]===`
`?(l++,n[l]=0):n[l]++;for(n[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,n[0],s),s=s&&s.slice(n[0]+1)),l&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+n[0],l),o=1;o<l;o++)n[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,n[o],s):s&&this.styles[r.lineIndex+o]&&s[0]&&(this.styles[r.lineIndex+o][0]=s[0]),s=s&&s.slice(n[o]+1);n[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,n[o],s)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,s){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;r>s&&this.removeStyleFromTo(s,r);const n=this.graphemeSplit(e);this.insertNewStyleBlock(n,s,t),this._text=[...this._text.slice(0,s),...n,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,s){s<=e?(t===e?this._selectionDirection=J:this._selectionDirection===le&&(this._selectionDirection=J,this.selectionEnd=e),this.selectionStart=s):s>e&&s<t?this._selectionDirection===le?this.selectionEnd=s:this.selectionStart=s:(t===e?this._selectionDirection=le:this._selectionDirection===J&&(this._selectionDirection=le,this.selectionStart=t),this.selectionEnd=s)}}class Qp extends Jp{initHiddenTextarea(){const e=this.canvas&&Be(this.canvas.getElement())||es(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[l,c]=o;return t.setAttribute(l,c)});const{top:s,left:r,fontSize:n}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(s,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(n,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[l,c]=o;return t.addEventListener(l,this[c].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const s=()=>{this.updateFromTextArea(),this.fire(xr),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void s();const r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,n=this._text.length,o=r.length,l=this.selectionStart,c=this.selectionEnd,d=l!==c;let h,u,g,p,m=o-n;const x=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),f=l>x.selectionStart;d?(u=this._text.slice(l,c),m+=c-l):o<n&&(u=f?this._text.slice(c+m,c):this._text.slice(l,l-m));const y=r.slice(x.selectionEnd-m,x.selectionEnd);if(u&&u.length&&(y.length&&(h=this.getSelectionStyles(l,l+1,!1),h=y.map(()=>h[0])),d?(g=l,p=c):f?(g=c-u.length,p=c):(g=c,p=c+u.length),this.removeStyleFromTo(g,p)),y.length){const{copyPasteData:w}=Qe();t&&y.join("")===w.copiedText&&!q.disableStyleCopyPaste&&(h=w.copiedTextStyle),this.insertNewStyleBlock(y,l,h)}s()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:s,selectionEnd:r}=t;this.compositionStart=s,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Qe();e.copiedText=this.getSelectedText(),q.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let s,r=this._getLineLeftOffset(e);return t>0&&(s=this.__charBounds[e][t-1],r+=s.left+s.width),r}getDownCursorOffset(e,t){const s=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(s),n=r.lineIndex;if(n===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-s;const o=r.charIndex,l=this._getWidthBeforeCursor(n,o),c=this._getIndexOnLine(n+1,l);return this._textLines[n].slice(o).length+c+1+this.missingNewlineOffset(n)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const s=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(s),n=r.lineIndex;if(n===0||e.metaKey||e.keyCode===33)return-s;const o=r.charIndex,l=this._getWidthBeforeCursor(n,o),c=this._getIndexOnLine(n-1,l),d=this._textLines[n].slice(0,o),h=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+c-d.length+(1-h)}_getIndexOnLine(e,t){const s=this._textLines[e];let r,n,o=this._getLineLeftOffset(e),l=0;for(let c=0,d=s.length;c<d;c++)if(r=this.__charBounds[e][c].width,o+=r,o>t){n=!0;const h=o-r,u=o,g=Math.abs(h-t);l=Math.abs(u-t)<g?c:c-1;break}return n||(l=s.length-1),l}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const s=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===le);if(t.shiftKey?this.moveCursorWithShift(s):this.moveCursorWithoutShift(s),s!==0){const r=this.text.length;this.selectionStart=Jt(0,this.selectionStart,r),this.selectionEnd=Jt(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===J?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,s){let r;if(e.altKey)r=this["findWordBoundary".concat(s)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=s==="Left"?-1:1,!0;r=this["findLineBoundary".concat(s)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=J,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===le&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=J,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const s="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[s](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===J&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=le,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=le,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const li=i=>!!i.button;class Zp extends Qp{constructor(){super(...arguments),b(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new Kp(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),Si(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!li(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!li(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:s}=e;const r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const n=this.canvas._activeObject;if(n&&n!==this)return}!this.editable||this.group&&!this.group.interactive||s&&s.actionPerformed||li(t)||r||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),s=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(s,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(He(this.calcTransformMatrix())).add(new _(-this._getLeftOffset(),-this._getTopOffset()));let s=0,r=0,n=0;for(let d=0;d<this._textLines.length&&s<=t.y;d++)s+=this.getHeightOfLine(d),n=d,d>0&&(r+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let o=Math.abs(this._getLineLeftOffset(n));const l=this._textLines[n].length,c=this.__charBounds[n];for(let d=0;d<l;d++){const h=o+c[d].kernedWidth;if(t.x<=h){Math.abs(t.x-h)<=Math.abs(t.x-o)&&r++;break}o=h,r++}return Math.min(this.flipX?l-r:r,this._text.length)}}const Is="moveCursorUp",Bs="moveCursorDown",Hs="moveCursorLeft",zs="moveCursorRight",Ws="exitEditing",ef=v({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Ws,27:Ws,33:Is,34:Bs,35:zs,36:Hs,37:Hs,38:Is,39:zs,40:Bs},keysMapRtl:{9:Ws,27:Ws,33:Is,34:Bs,35:Hs,36:zs,37:zs,38:Is,39:Hs,40:Bs},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class nt extends Zp{static getDefaults(){return v(v({},super.getDefaults()),nt.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,v(v({},nt.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Mi&&this.canvas.textEditingManager.remove(this),t instanceof Mi&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,s=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,s)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,s)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const s=super.toCanvasElement(e);return this.isEditing=t,s}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const s=this._getLeftOffset(),r=this._getTopOffset(),n=this._getCursorBoundariesOffsets(e,t);return{left:s,top:r,leftOffset:n.left,topOffset:n.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,s=0;const{charIndex:r,lineIndex:n}=this.get2DCursorLocation(e);for(let d=0;d<n;d++)t+=this.getHeightOfLine(d);const o=this._getLineLeftOffset(n),l=this.__charBounds[n][r];l&&(s=l.left),this.charSpacing!==0&&r===this._textLines[n].length&&(s-=this._getWidthOfCharSpacing());const c={top:t,left:o+(s>0?s:0)};return this.direction==="rtl"&&(this.textAlign===le||this.textAlign===Ge||this.textAlign===ds?c.left*=-1:this.textAlign===J||this.textAlign===Nr?c.left=o-(s>0?s:0):this.textAlign!==Y&&this.textAlign!==us||(c.left=o-(s>0?s:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const s=this.get2DCursorLocation(e),r=s.lineIndex,n=s.charIndex>0?s.charIndex-1:0,o=this.getValueOfPropertyAt(r,n,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,d=this.getValueOfPropertyAt(r,n,"deltaY"),h=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,n,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-c/2,top:h+t.top+d,width:c,height:o}}_renderCursor(e,t,s){const{color:r,opacity:n,left:o,top:l,width:c,height:d}=this.getCursorRenderingData(s,t);e.fillStyle=r,e.globalAlpha=n,e.fillRect(o,l,c,d)}renderSelection(e,t){const s={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,s,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,s){const r=t.selectionStart,n=t.selectionEnd,o=this.textAlign.includes(Ge),l=this.get2DCursorLocation(r),c=this.get2DCursorLocation(n),d=l.lineIndex,h=c.lineIndex,u=l.charIndex<0?0:l.charIndex,g=c.charIndex<0?0:c.charIndex;for(let p=d;p<=h;p++){const m=this._getLineLeftOffset(p)||0;let x=this.getHeightOfLine(p),f=0,y=0,w=0;if(p===d&&(y=this.__charBounds[d][u].left),p>=d&&p<h)w=o&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===h)if(g===0)w=this.__charBounds[h][g].left;else{const N=this._getWidthOfCharSpacing();w=this.__charBounds[h][g-1].left+this.__charBounds[h][g-1].width-N}f=x,(this.lineHeight<1||p===h&&this.lineHeight>1)&&(x/=this.lineHeight);let j=s.left+m+y,T=x,A=0;const P=w-y;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",T=1,A=x):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===le||this.textAlign===Ge||this.textAlign===ds?j=this.width-j-P:this.textAlign===J||this.textAlign===Nr?j=s.left+m-w:this.textAlign!==Y&&this.textAlign!==us||(j=s.left+m-w)),e.fillRect(j,s.top+s.topOffset+A,P,T),s.topOffset+=f}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,ge)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}b(nt,"ownDefaults",ef),b(nt,"type","IText"),L.setClass(nt),L.setClass(nt,"i-text");class ze extends nt{static getDefaults(){return v(v({},super.getDefaults()),ze.ownDefaults)}constructor(e,t){super(e,v(v({},ze.ownDefaults),t))}static createControls(){return{controls:Em()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Ge)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,s=0,r=0;const n={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(s=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(s++,r++),n[o]={line:t,offset:s},r+=e.graphemeLines[o].length,s+=e.graphemeLines[o].length;return n}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[t];s&&(t=s.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,s=0,r=e+1,n=!1;const o=this._styleMap[e],l=this._styleMap[e+1];o&&(e=o.line,s=o.offset),l&&(r=l.line,n=r===e,t=l.offset);const c=e===void 0?this.styles:{line:this.styles[e]};for(const d in c)for(const h in c[d]){const u=parseInt(h,10);if(u>=s&&(!n||u<t))for(const g in c[d][h])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[e];if(!s)return{};e=s.line,t=s.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,s){const r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,s)}_deleteStyleDeclaration(e,t){const s=this._styleMap[e];super._deleteStyleDeclaration(s.line,s.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const s=this.getGraphemeDataForRender(e),r=[];for(let n=0;n<s.wordsData.length;n++)r.push(...this._wrapLine(n,t,s));return this.isWrapping=!1,r}getGraphemeDataForRender(e){const t=this.splitByGrapheme,s=t?"":" ";let r=0;return{wordsData:e.map((n,o)=>{let l=0;const c=t?this.graphemeSplit(n):this.wordSplit(n);return c.length===0?[{word:[],width:0}]:c.map(d=>{const h=t?[d]:this.graphemeSplit(d),u=this._measureWord(h,o,l);return r=Math.max(u,r),l+=h.length+s.length,{word:h,width:u}})}),largestWordWidth:r}}_measureWord(e,t){let s,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=0;for(let o=0,l=e.length;o<l;o++)n+=this._getGraphemeBox(e[o],t,o+r,s,!0).kernedWidth,s=e[o];return n}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,s){let{largestWordWidth:r,wordsData:n}=s,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const l=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,d=[],h=c?"":" ";let u=0,g=[],p=0,m=0,x=!0;t-=o;const f=Math.max(t,r,this.dynamicMinWidth),y=n[e];let w;for(p=0,w=0;w<y.length;w++){const{word:j,width:T}=y[w];p+=j.length,u+=m+T-l,u>f&&!x?(d.push(g),g=[],u=T,x=!0):u+=l,x||c||g.push(h),g=g.concat(j),m=c?0:this._measureWord([h],e,p),p++,x=!1}return w&&d.push(g),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-l+o),d}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),s=this._wrapText(t.lines,this.width),r=new Array(s.length);for(let n=0;n<s.length;n++)r[n]=s[n].join("");return t.lines=r,t.graphemeLines=s,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const s=parseInt(t,10);if(this._textLines[s]){const r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}b(ze,"type","Textbox"),b(ze,"textLayoutProperties",[...nt.textLayoutProperties,"width"]),b(ze,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),L.setClass(ze);class ya extends Vr{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:s}=e,{clipPath:r,group:n}=s;if(!r||!this.shouldPerformLayout(e))return;const{width:o,height:l}=ot(il(s,r)),c=new _(o,l);if(r.absolutePositioned)return{center:$t(r.getRelativeCenterPoint(),void 0,n?n.calcTransformMatrix():void 0),size:c};{const d=r.getRelativeCenterPoint().transform(s.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:h=new _,correction:u=new _}=this.calcBoundingBox(t,e)||{};return{center:h.add(d),correction:u.subtract(d),size:c}}return{center:s.getRelativeCenterPoint().add(d),size:c}}}}b(ya,"type","clip-path"),L.setClass(ya);class ba extends Vr{getInitialSize(e,t){let{target:s}=e,{size:r}=t;return new _(s.width||r.x,s.height||r.y)}}b(ba,"type","fixed"),L.setClass(ba);class tf extends ys{subscribeTargets(e){const t=e.target;e.targets.reduce((s,r)=>(r.parent&&s.add(r.parent),s),new Set).forEach(s=>{s.layoutManager.subscribeTargets({target:s,targets:[t]})})}unsubscribeTargets(e){const t=e.target,s=t.getObjects();e.targets.reduce((r,n)=>(n.parent&&r.add(n.parent),r),new Set).forEach(r=>{!s.some(n=>n.parent===r)&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})})}}class Ot extends Dt{static getDefaults(){return v(v({},super.getDefaults()),Ot.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ot.ownDefaults),this.setOptions(t);const{left:s,top:r,layoutManager:n}=t;this.groupInit(e,{left:s,top:r,layoutManager:n??new tf})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(r=>{const n=this._objects.findIndex(l=>l.isInFrontOf(r)),o=n===-1?this.size():n;this.insertAt(o,r)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(bt("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const s=new Set;t.forEach(r=>{const{parent:n}=r;n&&s.add(n)}),e===ln?s.forEach(r=>{r._onAfterObjectsChange(Cr,t)}):s.forEach(r=>{r._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,s){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const r=v(v({hasControls:!1},s),{},{forActiveSelection:!0});for(let n=0;n<this._objects.length;n++)this._objects[n]._renderControls(e,r);super._renderControls(e,t),e.restore()}}b(Ot,"type","ActiveSelection"),b(Ot,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),L.setClass(Ot),L.setClass(Ot,"activeSelection");class sf{constructor(){b(this,"resources",{})}applyFilters(e,t,s,r,n){const o=n.getContext("2d");if(!o)return;o.drawImage(t,0,0,s,r);const l={sourceWidth:s,sourceHeight:r,imageData:o.getImageData(0,0,s,r),originalEl:t,originalImageData:o.getImageData(0,0,s,r),canvasEl:n,ctx:o,filterBackend:this};e.forEach(d=>{d.applyTo(l)});const{imageData:c}=l;return c.width===s&&c.height===r||(n.width=c.width,n.height=c.height),o.putImageData(c,0,0),l}}class Cl{constructor(){let{tileSize:e=q.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};b(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),b(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const s=Ze({width:e,height:t}),r=s.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=s,this.gl=r)}applyFilters(e,t,s,r,n,o){const l=this.gl,c=n.getContext("2d");if(!l||!c)return;let d;o&&(d=this.getCachedTexture(o,t));const h={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:s,sourceHeight:r,destinationWidth:s,destinationHeight:r,context:l,sourceTexture:this.createTexture(l,s,r,d?void 0:t),targetTexture:this.createTexture(l,s,r),originalTexture:d||this.createTexture(l,s,r,d?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},u=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,u),e.forEach(g=>{g&&g.applyTo(h)}),function(g){const p=g.targetCanvas,m=p.width,x=p.height,f=g.destinationWidth,y=g.destinationHeight;m===f&&x===y||(p.width=f,p.height=y)}(h),this.copyGLTo2D(l,h),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(h.sourceTexture),l.deleteTexture(h.targetTexture),l.deleteFramebuffer(u),c.setTransform(1,0,0,1,0,0),h}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,s,r,n){const{NEAREST:o,TEXTURE_2D:l,RGBA:c,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:h,TEXTURE_MAG_FILTER:u,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:m}=e,x=e.createTexture();return e.bindTexture(l,x),e.texParameteri(l,u,n||o),e.texParameteri(l,g,n||o),e.texParameteri(l,p,h),e.texParameteri(l,m,h),r?e.texImage2D(l,0,c,c,d,r):e.texImage2D(l,0,c,t,s,0,c,d,null),x}getCachedTexture(e,t,s){const{textureCache:r}=this;if(r[e])return r[e];{const n=this.createTexture(this.gl,t.width,t.height,t,s);return n&&(r[e]=n),n}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const s=e.canvas,r=t.targetCanvas,n=r.getContext("2d");if(!n)return;n.translate(0,r.height),n.scale(1,-1);const o=s.height-r.height;n.drawImage(s,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){const s=t.targetCanvas.getContext("2d"),r=t.destinationWidth,n=t.destinationHeight,o=r*n*4;if(!s)return;const l=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,n,e.RGBA,e.UNSIGNED_BYTE,l);const d=new ImageData(c,r,n);s.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const s=e.getExtension("WEBGL_debug_renderer_info");if(s){const r=e.getParameter(s.UNMASKED_RENDERER_WEBGL),n=e.getParameter(s.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),n&&(t.vendor=n.toLowerCase())}return this.gpuInfo=t,t}}let ci;function rf(){const{WebGLProbe:i}=Qe();return i.queryWebGL(Ve()),q.enableGLFiltering&&i.isSupported(q.textureSize)?new Cl({tileSize:q.textureSize}):new sf}function hi(){return!ci&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(ci=rf()),ci}const nf=["filters","resizeFilter","src","crossOrigin","type"],Sl=["cropX","cropY"];class ye extends ve{static getDefaults(){return v(v({},super.getDefaults()),ye.ownDefaults)}constructor(e,t){super(),b(this,"_lastScaleX",1),b(this,"_lastScaleY",1),b(this,"_filterScalingX",1),b(this,"_filterScalingY",1),this.filters=[],Object.assign(this,ye.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(vt()),this.setElement(typeof e=="string"?(this.canvas&&Be(this.canvas.getElement())||es()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(s),(t=e.classList)===null||t===void 0||t.add(ye.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=hi(!1);t instanceof Cl&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&Qe().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,s=this.height/2;e.beginPath(),e.moveTo(-t,-s),e.lineTo(t,-s),e.lineTo(t,s),e.lineTo(-t,s),e.lineTo(-t,-s),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(s=>{s&&t.push(s.toObject())}),v(v({},super.toObject([...Sl,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,s=-this.width/2,r=-this.height/2;let n=[],o=[],l="",c="";if(!t)return[];if(this.hasCrop()){const d=vt();n.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+s+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(s-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(c).concat(l,`></image>
`)),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,o=['	<rect x="'.concat(s,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=d}return n=this.paintFirst!==ge?n.concat(o,e):n.concat(e,o),n}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ur(e,{crossOrigin:t,signal:s}).then(r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,s=this.getTotalObjectScaling(),r=s.x,n=s.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&n>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=n);const l=Ze(o),{width:c,height:d}=o;this._element=l,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=n,hi().applyFilters([e],o,c,d,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(n=>n&&!n.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,s=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){const n=Ze({width:s,height:r});this._element=n,this._filteredEl=n}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,s,r),this._lastScaleX=1,this._lastScaleY=1);hi().applyFilters(e,this._originalElement,s,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const s=this._filterScalingX,r=this._filterScalingY,n=this.width,o=this.height,l=Math.max(this.cropX,0),c=Math.max(this.cropY,0),d=t.naturalWidth||t.width,h=t.naturalHeight||t.height,u=l*s,g=c*r,p=Math.min(n*s,d-u),m=Math.min(o*r,h-g),x=-n/2,f=-o/2,y=Math.min(n,d/s-l),w=Math.min(o,h/r-c);t&&e.drawImage(t,u,g,p,m,x,f,y,w)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=this.getOriginalSize();this.width=e||s.width,this.height=t||s.height}parsePreserveAspectRatioAttribute(){const e=Hg(this.preserveAspectRatio||""),t=this.width,s=this.height,r={width:t,height:s};let n,o=this._element.width,l=this._element.height,c=1,d=1,h=0,u=0,g=0,p=0;return!e||e.alignX===Te&&e.alignY===Te?(c=t/o,d=s/l):(e.meetOrSlice==="meet"&&(c=d=cp(this._element,r),n=(t-o*c)/2,e.alignX==="Min"&&(h=-n),e.alignX==="Max"&&(h=n),n=(s-l*d)/2,e.alignY==="Min"&&(u=-n),e.alignY==="Max"&&(u=n)),e.meetOrSlice==="slice"&&(c=d=hp(this._element,r),n=o-t/c,e.alignX==="Mid"&&(g=n/2),e.alignX==="Max"&&(g=n),n=l-s/d,e.alignY==="Mid"&&(p=n/2),e.alignY==="Max"&&(p=n),o=t/c,l=s/d)),{width:o,height:l,scaleX:c,scaleY:d,offsetLeft:h,offsetTop:u,cropX:g,cropY:p}}static fromObject(e,t){let{filters:s,resizeFilter:r,src:n,crossOrigin:o,type:l}=e,c=re(e,nf);return Promise.all([ur(n,v(v({},t),{},{crossOrigin:o})),s&&ps(s,t),r&&ps([r],t),Br(c,t)]).then(d=>{let[h,u=[],[g]=[],p={}]=d;return new this(h,v(v({},c),{},{src:n,filters:u,resizeFilter:g},p))})}static fromURL(e){let{crossOrigin:t=null,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return ur(e,{crossOrigin:t,signal:s}).then(n=>new this(n,r))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;const r=ut(e,this.ATTRIBUTE_NAMES,s);return this.fromURL(r["xlink:href"],t,r).catch(n=>(bt("log","Unable to parse Image",n),null))}}b(ye,"type","Image"),b(ye,"cacheProperties",[...dt,...Sl]),b(ye,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),b(ye,"CSS_CANVAS","canvas-img"),b(ye,"ATTRIBUTE_NAMES",[..._t,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),L.setClass(ye),L.setSVGClass(ye);zr(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const $r=i=>i.webgl!==void 0,cn="precision highp float",af=`
    `.concat(cn,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),of=["type"],lf=["type"],cf=new RegExp(cn,"g");class me{get type(){return this.constructor.type}constructor(){let e=re(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},of);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return af}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:r="highp"}}=Qe();r!=="highp"&&(t=t.replace(cf,cn.replace("highp",r)));const n=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),l=e.createProgram();if(!n||!o||!l)throw new Ke("Vertex, fragment shader or program creation error");if(e.shaderSource(n,s),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Ke("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(n)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Ke("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(l,n),e.attachShader(l,o),e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))throw new Ke('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(l)));const c=this.getUniformLocations(e,l)||{};return c.uStepW=e.getUniformLocation(l,"uStepW"),c.uStepH=e.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(e,l),uniformLocations:c}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const s=this.constructor.uniformLocations,r={};for(let n=0;n<s.length;n++)r[s[n]]=e.getUniformLocation(t,s[n]);return r}sendAttributeData(e,t,s){const r=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const s=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===s&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,s,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){$r(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,s=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(s.program),this.sendAttributeData(t,s.attributeLocations,e.aPosition),t.uniform1f(s.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(s.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,s.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,s){e.activeTexture(s),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:s}=e,r=Ze({width:t,height:s});e.helpLayer=r}}toObject(){const e=Object.keys(this.constructor.defaults||{});return v({type:this.type},e.reduce((t,s)=>(t[s]=this[s],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(re(e,lf))}}b(me,"type","BaseFilter"),b(me,"uniformLocations",[]);const hf={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Vs extends me{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(hf[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const s=new Z(this.color).getSource(),r=this.alpha,n=s[0]*r,o=s[1]*r,l=s[2]*r,c=1-r;for(let d=0;d<t.length;d+=4){const h=t[d],u=t[d+1],g=t[d+2];let p,m,x;switch(this.mode){case"multiply":p=h*n/255,m=u*o/255,x=g*l/255;break;case"screen":p=255-(255-h)*(255-n)/255,m=255-(255-u)*(255-o)/255,x=255-(255-g)*(255-l)/255;break;case"add":p=h+n,m=u+o,x=g+l;break;case"difference":p=Math.abs(h-n),m=Math.abs(u-o),x=Math.abs(g-l);break;case"subtract":p=h-n,m=u-o,x=g-l;break;case"darken":p=Math.min(h,n),m=Math.min(u,o),x=Math.min(g,l);break;case"lighten":p=Math.max(h,n),m=Math.max(u,o),x=Math.max(g,l);break;case"overlay":p=n<128?2*h*n/255:255-2*(255-h)*(255-n)/255,m=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,x=l<128?2*g*l/255:255-2*(255-g)*(255-l)/255;break;case"exclusion":p=n+h-2*n*h/255,m=o+u-2*o*u/255,x=l+g-2*l*g/255;break;case"tint":p=n+h*c,m=o+u*c,x=l+g*c}t[d]=p,t[d+1]=m,t[d+2]=x}}sendUniformData(e,t){const s=new Z(this.color).getSource();s[0]=this.alpha*s[0]/255,s[1]=this.alpha*s[1]/255,s[2]=this.alpha*s[2]/255,s[3]=this.alpha,e.uniform4fv(t.uColor,s)}}b(Vs,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),b(Vs,"type","BlendColor"),b(Vs,"uniformLocations",["uColor"]),L.setClass(Vs);const df={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},uf=["type","image"];class Us extends me{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return df[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,s=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,s,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:s}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/s,1]}applyTo2d(e){let{imageData:{data:t,width:s,height:r},filterBackend:{resources:n}}=e;const o=this.image;n.blendImage||(n.blendImage=Ve());const l=n.blendImage,c=l.getContext("2d");l.width!==s||l.height!==r?(l.width=s,l.height=r):c.clearRect(0,0,s,r),c.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),c.drawImage(o.getElement(),0,0,s,r);const d=c.getImageData(0,0,s,r).data;for(let h=0;h<t.length;h+=4){const u=t[h],g=t[h+1],p=t[h+2],m=t[h+3],x=d[h],f=d[h+1],y=d[h+2],w=d[h+3];switch(this.mode){case"multiply":t[h]=u*x/255,t[h+1]=g*f/255,t[h+2]=p*y/255,t[h+3]=m*w/255;break;case"mask":t[h+3]=w}}}sendUniformData(e,t){const s=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,s)}toObject(){return v(v({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:s,image:r}=e,n=re(e,uf);return ye.fromObject(r,t).then(o=>new this(v(v({},n),{},{image:o})))}}b(Us,"type","BlendImage"),b(Us,"defaults",{mode:"multiply",alpha:1}),b(Us,"uniformLocations",["uTransformMatrix","uImage"]),L.setClass(Us);class $s extends me{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){$r(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:s,filterBackend:{resources:r}}=e;const{width:n,height:o}=s;r.blurLayer1||(r.blurLayer1=Ve(),r.blurLayer2=Ve());const l=r.blurLayer1,c=r.blurLayer2;l.width===n&&l.height===o||(c.width=l.width=n,c.height=l.height=o);const d=l.getContext("2d"),h=c.getContext("2d"),u=15,g=.06*this.blur*.5;let p,m,x,f;for(d.putImageData(s,0,0),h.clearRect(0,0,n,o),f=-15;f<=u;f++)p=(Math.random()-.5)/4,m=f/u,x=g*m*n+p,h.globalAlpha=1-Math.abs(m),h.drawImage(l,x,p),d.drawImage(c,0,0),h.globalAlpha=1,h.clearRect(0,0,c.width,c.height);for(f=-15;f<=u;f++)p=(Math.random()-.5)/4,m=f/u,x=g*m*o+p,h.globalAlpha=1-Math.abs(m),h.drawImage(l,p,x),d.drawImage(c,0,0),h.globalAlpha=1,h.clearRect(0,0,c.width,c.height);t.drawImage(l,0,0);const y=t.getImageData(0,0,l.width,l.height);return d.globalAlpha=1,d.clearRect(0,0,l.width,l.height),y}sendUniformData(e,t){const s=this.chooseRightDelta();e.uniform2fv(t.uDelta,s)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const s=e*this.blur*.12;return this.horizontal?t[0]=s:t[1]=s,t}}b($s,"type","Blur"),b($s,"defaults",{blur:0}),b($s,"uniformLocations",["uDelta"]),L.setClass($s);class Ys extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=s,t[r+1]+=s,t[r+2]+=s}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}b(Ys,"type","Brightness"),b(Ys,"defaults",{brightness:0}),b(Ys,"uniformLocations",["uBrightness"]),L.setClass(Ys);const kl={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Vt extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,s=this.matrix,r=this.colorsOnly;for(let n=0;n<t.length;n+=4){const o=t[n],l=t[n+1],c=t[n+2];if(t[n]=o*s[0]+l*s[1]+c*s[2]+255*s[4],t[n+1]=o*s[5]+l*s[6]+c*s[7]+255*s[9],t[n+2]=o*s[10]+l*s[11]+c*s[12]+255*s[14],!r){const d=t[n+3];t[n]+=d*s[3],t[n+1]+=d*s[8],t[n+2]+=d*s[13],t[n+3]=o*s[15]+l*s[16]+c*s[17]+d*s[18]+255*s[19]}}}sendUniformData(e,t){const s=this.matrix,r=[s[0],s[1],s[2],s[3],s[5],s[6],s[7],s[8],s[10],s[11],s[12],s[13],s[15],s[16],s[17],s[18]],n=[s[4],s[9],s[14],s[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,n)}toObject(){return v(v({},super.toObject()),{},{matrix:[...this.matrix]})}}function Lt(i,e){var t;const s=(b(t=class extends Vt{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",i),b(t,"defaults",{colorsOnly:!1,matrix:e}),t);return L.setClass(s,i),s}b(Vt,"type","ColorMatrix"),b(Vt,"defaults",kl),b(Vt,"uniformLocations",["uColorMatrix","uConstants"]),L.setClass(Vt);Lt("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Lt("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Lt("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Lt("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Lt("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Lt("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Lt("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class va extends me{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){$r(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(s=>L.getClass(s.type).fromObject(s,t))).then(s=>new this({subFilters:s}))}}b(va,"type","Composed"),L.setClass(va);class Xs extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const s=Math.floor(255*this.contrast),r=259*(s+255)/(255*(259-s));for(let n=0;n<t.length;n+=4)t[n]=r*(t[n]-128)+128,t[n+1]=r*(t[n+1]-128)+128,t[n+2]=r*(t[n+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}b(Xs,"type","Contrast"),b(Xs,"defaults",{contrast:0}),b(Xs,"uniformLocations",["uContrast"]),L.setClass(Xs);const gf={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Gs extends me{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return gf[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,s=t.data,r=this.matrix,n=Math.round(Math.sqrt(r.length)),o=Math.floor(n/2),l=t.width,c=t.height,d=e.ctx.createImageData(l,c),h=d.data,u=this.opaque?1:0;let g,p,m,x,f,y,w,j,T,A,P,N,E;for(P=0;P<c;P++)for(A=0;A<l;A++){for(f=4*(P*l+A),g=0,p=0,m=0,x=0,E=0;E<n;E++)for(N=0;N<n;N++)w=P+E-o,y=A+N-o,w<0||w>=c||y<0||y>=l||(j=4*(w*l+y),T=r[E*n+N],g+=s[j]*T,p+=s[j+1]*T,m+=s[j+2]*T,u||(x+=s[j+3]*T));h[f]=g,h[f+1]=p,h[f+2]=m,h[f+3]=u?s[f+3]:x}e.imageData=d}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return v(v({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}b(Gs,"type","Convolute"),b(Gs,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),b(Gs,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),L.setClass(Gs);const Nl="Gamma";class qs extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const s=this.gamma,r=1/s[0],n=1/s[1],o=1/s[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const l=this.rgbValues;for(let c=0;c<256;c++)l.r[c]=255*Math.pow(c/255,r),l.g[c]=255*Math.pow(c/255,n),l.b[c]=255*Math.pow(c/255,o);for(let c=0;c<t.length;c+=4)t[c]=l.r[t[c]],t[c+1]=l.g[t[c+1]],t[c+2]=l.b[t[c+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:Nl,gamma:this.gamma.concat()}}}b(qs,"type",Nl),b(qs,"defaults",{gamma:[1,1,1]}),b(qs,"uniformLocations",["uGamma"]),L.setClass(qs);const mf={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Ks extends me{applyTo2d(e){let{imageData:{data:t}}=e;for(let s,r=0;r<t.length;r+=4){const n=t[r],o=t[r+1],l=t[r+2];switch(this.mode){case"average":s=(n+o+l)/3;break;case"lightness":s=(Math.min(n,o,l)+Math.max(n,o,l))/2;break;case"luminosity":s=.21*n+.72*o+.07*l}t[r+2]=t[r+1]=t[r]=s}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return mf[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}b(Ks,"type","Grayscale"),b(Ks,"defaults",{mode:"average"}),b(Ks,"uniformLocations",["uMode"]),L.setClass(Ks);const pf=v(v({},kl),{},{rotation:0});class di extends Vt{calculateMatrix(){const e=this.rotation*Math.PI,t=ct(e),s=ht(e),r=1/3,n=Math.sqrt(r)*s,o=1-t;this.matrix=[t+o/3,r*o-n,r*o+n,0,0,r*o+n,t+r*o,r*o-n,0,0,r*o-n,r*o+n,t+r*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}b(di,"type","HueRotation"),b(di,"defaults",pf),L.setClass(di);class Js extends me{applyTo2d(e){let{imageData:{data:t}}=e;for(let s=0;s<t.length;s+=4)t[s]=255-t[s],t[s+1]=255-t[s+1],t[s+2]=255-t[s+2],this.alpha&&(t[s+3]=255-t[s+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}b(Js,"type","Invert"),b(Js,"defaults",{alpha:!1,invert:!0}),b(Js,"uniformLocations",["uInvert","uAlpha"]),L.setClass(Js);class Qs extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=this.noise;for(let r=0;r<t.length;r+=4){const n=(.5-Math.random())*s;t[r]+=n,t[r+1]+=n,t[r+2]+=n}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}b(Qs,"type","Noise"),b(Qs,"defaults",{noise:0}),b(Qs,"uniformLocations",["uNoise","uSeed"]),L.setClass(Qs);class Zs extends me{applyTo2d(e){let{imageData:{data:t,width:s,height:r}}=e;for(let n=0;n<r;n+=this.blocksize)for(let o=0;o<s;o+=this.blocksize){const l=4*n*s+4*o,c=t[l],d=t[l+1],h=t[l+2],u=t[l+3];for(let g=n;g<Math.min(n+this.blocksize,r);g++)for(let p=o;p<Math.min(o+this.blocksize,s);p++){const m=4*g*s+4*p;t[m]=c,t[m+1]=d,t[m+2]=h,t[m+3]=u}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}b(Zs,"type","Pixelate"),b(Zs,"defaults",{blocksize:4}),b(Zs,"uniformLocations",["uBlocksize"]),L.setClass(Zs);class er extends me{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=255*this.distance,r=new Z(this.color).getSource(),n=[r[0]-s,r[1]-s,r[2]-s],o=[r[0]+s,r[1]+s,r[2]+s];for(let l=0;l<t.length;l+=4){const c=t[l],d=t[l+1],h=t[l+2];c>n[0]&&d>n[1]&&h>n[2]&&c<o[0]&&d<o[1]&&h<o[2]&&(t[l+3]=0)}}sendUniformData(e,t){const s=new Z(this.color).getSource(),r=this.distance,n=[0+s[0]/255-r,0+s[1]/255-r,0+s[2]/255-r,1],o=[s[0]/255+r,s[1]/255+r,s[2]/255+r,1];e.uniform4fv(t.uLow,n),e.uniform4fv(t.uHigh,o)}}b(er,"type","RemoveColor"),b(er,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),b(er,"uniformLocations",["uLow","uHigh"]),L.setClass(er);class tr extends me{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,s=this.getFilterWindow(),r=new Array(s);for(let n=1;n<=s;n++)r[n-1]=e(n*t);return r}generateShader(e){const t=new Array(e);for(let s=1;s<=e;s++)t[s-1]="".concat(s,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((s,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(s,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(s,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){$r(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const s=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(s)/s}}applyTo2d(e){const t=e.imageData,s=this.scaleX,r=this.scaleY;this.rcpScaleX=1/s,this.rcpScaleY=1/r;const n=t.width,o=t.height,l=Math.round(n*s),c=Math.round(o*r);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(e,n,o,l,c):this.resizeType==="hermite"?this.hermiteFastResize(e,n,o,l,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,n,o,l,c):this.resizeType==="lanczos"?this.lanczosResize(e,n,o,l,c):new ImageData(l,c),e.imageData=d}sliceByTwo(e,t,s,r,n){const o=e.imageData,l=.5;let c=!1,d=!1,h=t*l,u=s*l;const g=e.filterBackend.resources;let p=0,m=0;const x=t;let f=0;g.sliceByTwo||(g.sliceByTwo=Ve());const y=g.sliceByTwo;(y.width<1.5*t||y.height<s)&&(y.width=1.5*t,y.height=s);const w=y.getContext("2d");for(w.clearRect(0,0,1.5*t,s),w.putImageData(o,0,0),r=Math.floor(r),n=Math.floor(n);!c||!d;)t=h,s=u,r<Math.floor(h*l)?h=Math.floor(h*l):(h=r,c=!0),n<Math.floor(u*l)?u=Math.floor(u*l):(u=n,d=!0),w.drawImage(y,p,m,t,s,x,f,h,u),p=x,m=f,f+=u;return w.getImageData(p,m,r,n)}lanczosResize(e,t,s,r,n){const o=e.imageData.data,l=e.ctx.createImageData(r,n),c=l.data,d=this.lanczosCreate(this.lanczosLobes),h=this.rcpScaleX,u=this.rcpScaleY,g=2/this.rcpScaleX,p=2/this.rcpScaleY,m=Math.ceil(h*this.lanczosLobes/2),x=Math.ceil(u*this.lanczosLobes/2),f={},y={x:0,y:0},w={x:0,y:0};return function j(T){let A,P,N,E,D,R,O,W,C,M,U;for(y.x=(T+.5)*h,w.x=Math.floor(y.x),A=0;A<n;A++){for(y.y=(A+.5)*u,w.y=Math.floor(y.y),D=0,R=0,O=0,W=0,C=0,P=w.x-m;P<=w.x+m;P++)if(!(P<0||P>=t)){M=Math.floor(1e3*Math.abs(P-y.x)),f[M]||(f[M]={});for(let $=w.y-x;$<=w.y+x;$++)$<0||$>=s||(U=Math.floor(1e3*Math.abs($-y.y)),f[M][U]||(f[M][U]=d(Math.sqrt(Math.pow(M*g,2)+Math.pow(U*p,2))/1e3)),N=f[M][U],N>0&&(E=4*($*t+P),D+=N,R+=N*o[E],O+=N*o[E+1],W+=N*o[E+2],C+=N*o[E+3]))}E=4*(A*r+T),c[E]=R/D,c[E+1]=O/D,c[E+2]=W/D,c[E+3]=C/D}return++T<r?j(T):l}(0)}bilinearFiltering(e,t,s,r,n){let o,l,c,d,h,u,g,p,m,x,f,y,w,j=0;const T=this.rcpScaleX,A=this.rcpScaleY,P=4*(t-1),N=e.imageData.data,E=e.ctx.createImageData(r,n),D=E.data;for(g=0;g<n;g++)for(p=0;p<r;p++)for(h=Math.floor(T*p),u=Math.floor(A*g),m=T*p-h,x=A*g-u,w=4*(u*t+h),f=0;f<4;f++)o=N[w+f],l=N[w+4+f],c=N[w+P+f],d=N[w+P+4+f],y=o*(1-m)*(1-x)+l*m*(1-x)+c*x*(1-m)+d*m*x,D[j++]=y;return E}hermiteFastResize(e,t,s,r,n){const o=this.rcpScaleX,l=this.rcpScaleY,c=Math.ceil(o/2),d=Math.ceil(l/2),h=e.imageData.data,u=e.ctx.createImageData(r,n),g=u.data;for(let p=0;p<n;p++)for(let m=0;m<r;m++){const x=4*(m+p*r);let f=0,y=0,w=0,j=0,T=0,A=0,P=0;const N=(p+.5)*l;for(let E=Math.floor(p*l);E<(p+1)*l;E++){const D=Math.abs(N-(E+.5))/d,R=(m+.5)*o,O=D*D;for(let W=Math.floor(m*o);W<(m+1)*o;W++){let C=Math.abs(R-(W+.5))/c;const M=Math.sqrt(O+C*C);M>1&&M<-1||(f=2*M*M*M-3*M*M+1,f>0&&(C=4*(W+E*t),P+=f*h[C+3],w+=f,h[C+3]<255&&(f=f*h[C+3]/250),j+=f*h[C],T+=f*h[C+1],A+=f*h[C+2],y+=f))}}g[x]=j/y,g[x+1]=T/y,g[x+2]=A/y,g[x+3]=P/w}return u}}b(tr,"type","Resize"),b(tr,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),b(tr,"uniformLocations",["uDelta","uTaps"]),L.setClass(tr);class sr extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=-this.saturation;for(let r=0;r<t.length;r+=4){const n=t[r],o=t[r+1],l=t[r+2],c=Math.max(n,o,l);t[r]+=c!==n?(c-n)*s:0,t[r+1]+=c!==o?(c-o)*s:0,t[r+2]+=c!==l?(c-l)*s:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}b(sr,"type","Saturation"),b(sr,"defaults",{saturation:0}),b(sr,"uniformLocations",["uSaturation"]),L.setClass(sr);class rr extends me{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=-this.vibrance;for(let r=0;r<t.length;r+=4){const n=t[r],o=t[r+1],l=t[r+2],c=Math.max(n,o,l),d=(n+o+l)/3,h=2*Math.abs(c-d)/255*s;t[r]+=c!==n?(c-n)*h:0,t[r+1]+=c!==o?(c-o)*h:0,t[r+2]+=c!==l?(c-l)*h:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}b(rr,"type","Vibrance"),b(rr,"defaults",{vibrance:0}),b(rr,"uniformLocations",["uVibrance"]),L.setClass(rr);const Tl=k.forwardRef(({width:i,height:e,backgroundColor:t,onSelectionChange:s},r)=>{const n=k.useRef(null),o=k.useRef(null),l=k.useRef(null),[c,d]=k.useState(1);return k.useEffect(()=>{const h=()=>{if(!l.current)return;const u=l.current.clientWidth,g=Math.min(u/i,1);d(g)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[i]),k.useEffect(()=>{if(!n.current)return;const h=new Mi(n.current,{width:i,height:e,backgroundColor:t,preserveObjectStacking:!0,selection:!0});return o.current=h,h.on("selection:created",u=>{var g;s==null||s(((g=u.selected)==null?void 0:g[0])??null)}),h.on("selection:updated",u=>{var g;s==null||s(((g=u.selected)==null?void 0:g[0])??null)}),h.on("selection:cleared",()=>{s==null||s(null)}),()=>{h.dispose(),o.current=null}},[i,e]),k.useEffect(()=>{const h=o.current;h&&(h.backgroundColor=t,h.renderAll())},[t]),k.useImperativeHandle(r,()=>({addImage:async h=>{const u=o.current;if(!u)return;const g=await ye.fromURL(h,{crossOrigin:"anonymous"}),p=i*.8,m=e*.8,x=Math.min(p/(g.width??1),m/(g.height??1),1);g.scale(x),g.set({left:20,top:20}),u.add(g),u.setActiveObject(g),u.renderAll()},addText:(h,u)=>{const g=o.current;if(!g)return;const p=new ze(h,{left:40,top:e/2-40,width:i*.6,fontSize:72,fontFamily:"Poppins, Noto Sans Devanagari, sans-serif",fill:"#FFFFFF",stroke:"#000000",strokeWidth:3,paintFirst:"stroke",textAlign:"left",fontWeight:"bold",shadow:new Je({color:"#000000",blur:6,offsetX:3,offsetY:3}),...u});g.add(p),g.setActiveObject(p),g.renderAll()},addEmoji:(h,u=.8,g=.1,p=80)=>{const m=o.current;if(!m)return;const x=new ze(h,{left:u*i,top:g*e,fontSize:p,fontFamily:"Apple Color Emoji, Noto Color Emoji, sans-serif",editable:!1});x.__layerType="emoji",x.__emoji=h,m.add(x),m.setActiveObject(x),m.renderAll()},setBackgroundColor:h=>{const u=o.current;u&&(u.backgroundColor=h,u.renderAll())},setBackgroundImage:async h=>{const u=o.current;if(!u)return;const g=await ye.fromURL(h,{crossOrigin:"anonymous"}),p=i/(g.width??1),m=e/(g.height??1),x=Math.max(p,m);g.scale(x),g.set({left:(i-(g.width??0)*x)/2,top:(e-(g.height??0)*x)/2,selectable:!1,evented:!1}),g.__isBackground=!0;const f=u.getObjects();for(const y of f)y.__isBackground&&u.remove(y);u.insertAt(0,g),u.renderAll()},deleteSelected:()=>{const h=o.current;if(!h)return;const u=h.getActiveObject();u&&(h.remove(u),h.discardActiveObject(),h.renderAll())},bringForward:()=>{const h=o.current;if(!h)return;const u=h.getActiveObject();u&&(h.bringObjectForward(u),h.renderAll())},sendBackward:()=>{const h=o.current;if(!h)return;const u=h.getActiveObject();u&&(h.sendObjectBackwards(u),h.renderAll())},updateSelectedText:h=>{const u=o.current;if(!u)return;const g=u.getActiveObject();!g||!(g instanceof ze)||(h.text!==void 0&&g.set("text",h.text),h.fontFamily&&g.set("fontFamily",h.fontFamily),h.fontSize&&g.set("fontSize",h.fontSize),h.fill&&g.set("fill",h.fill),h.stroke&&g.set("stroke",h.stroke),h.strokeWidth!==void 0&&g.set("strokeWidth",h.strokeWidth),u.renderAll())},getCanvasState:()=>{var g,p,m,x;const h=o.current;if(!h)return{width:i,height:e,backgroundColor:t,layers:[]};const u=[];for(const f of h.getObjects()){if(f.__isBackground){if(f instanceof ye){const y=((g=f._element)==null?void 0:g.src)||((p=f.getSrc)==null?void 0:p.call(f))||"";u.push({type:"image",src:y,x:f.left??0,y:f.top??0,width:(f.width??0)*(f.scaleX??1),height:(f.height??0)*(f.scaleY??1),opacity:f.opacity??1})}continue}if(f.__layerType==="emoji")u.push({type:"emoji",emoji:f.__emoji||f.text||"",x:f.left??0,y:f.top??0,size:f.fontSize??64});else if(f instanceof ze)u.push({type:"text",text:f.text??"",x:f.left??0,y:f.top??0,fontSize:f.fontSize??48,fontFamily:f.fontFamily??"Poppins",fill:f.fill??"#FFFFFF",stroke:f.stroke??"#000000",strokeWidth:f.strokeWidth??3});else if(f instanceof ye){const y=((m=f._element)==null?void 0:m.src)||((x=f.getSrc)==null?void 0:x.call(f))||"";u.push({type:"image",src:y,x:f.left??0,y:f.top??0,width:(f.width??0)*(f.scaleX??1),height:(f.height??0)*(f.scaleY??1),opacity:f.opacity??1})}}return{width:i,height:e,backgroundColor:h.backgroundColor||t,layers:u}},toDataURL:()=>{const h=o.current;return h?h.toDataURL({format:"png",multiplier:1}):""},clear:()=>{const h=o.current;h&&(h.clear(),h.backgroundColor=t,h.renderAll())}}),[i,e,t]),a.jsxs("div",{ref:l,className:"w-full",children:[a.jsx("div",{style:{transform:`scale(${c})`,transformOrigin:"top left",width:i,height:e},children:a.jsx("canvas",{ref:n})}),a.jsx("div",{style:{height:e*c-e*(c<1?1:0)}})]})});Tl.displayName="ThumbnailCanvas";const ff=[{value:"general",label:"General"},{value:"tech",label:" Tech"},{value:"food",label:" Food"},{value:"fitness",label:" Fitness"},{value:"education",label:" Education"},{value:"motivation",label:" Motivation"},{value:"beauty",label:" Beauty"},{value:"finance",label:" Finance"},{value:"vlog",label:" Vlog"},{value:"gaming",label:" Gaming"},{value:"reaction",label:" Reaction"}],wa=["","","","","","","","","","","","","","","","","","","","","","","",""];function xf({onEmojiClick:i}){var o,l;const[e,t]=k.useState("general"),{data:s}=xe({queryKey:["sticker-suggestions",e],queryFn:()=>qt.stickerSuggestions(e),staleTime:5*60*1e3}),r=((o=s==null?void 0:s.data)==null?void 0:o.emojis)||wa.slice(0,8),n=((l=s==null?void 0:s.data)==null?void 0:l.sticker_packs)||[];return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Content Niche"}),a.jsx("select",{value:e,onChange:c=>t(c.target.value),className:"input-field text-sm",children:ff.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-2",children:"Suggested"}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((c,d)=>a.jsx(B.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:()=>i(c),className:"text-2xl p-2 rounded-lg hover:bg-gray-100 transition-colors text-center",title:`Add ${c}`,children:c},`${c}-${d}`))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-2",children:"All Emojis"}),a.jsx("div",{className:"grid grid-cols-6 gap-1",children:wa.map((c,d)=>a.jsx("button",{onClick:()=>i(c),className:"text-xl p-1.5 rounded hover:bg-gray-100 transition-colors text-center",children:c},`quick-${c}-${d}`))})]}),n.map(c=>a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-2",children:c.name}),a.jsx("div",{className:"grid grid-cols-6 gap-1",children:c.items.map((d,h)=>a.jsx("button",{onClick:()=>i(d),className:"text-xl p-1.5 rounded hover:bg-gray-100 transition-colors text-center",children:d},`${c.name}-${d}-${h}`))})]},c.name))]})}const ja={devanagari:{label:"",color:"bg-orange-100 text-orange-700"},latin:{label:"ENG",color:"bg-blue-100 text-blue-700"},both:{label:"Both",color:"bg-purple-100 text-purple-700"}},yf=[{id:"poppins-extrabold",name:"Poppins ExtraBold",family:"Poppins",script:"latin",style:"extrabold",weight:800,preview_text:"BOLD TEXT",available:!0},{id:"noto-sans-devanagari-bold",name:"Noto Sans Devanagari Bold",family:"Noto Sans Devanagari",script:"devanagari",style:"bold",weight:700,preview_text:" ",available:!0},{id:"mukta-bold",name:"Mukta Bold",family:"Mukta",script:"both",style:"bold",weight:700,preview_text:"Mukta ",available:!0},{id:"bebas-neue",name:"Bebas Neue",family:"Bebas Neue",script:"latin",style:"regular",weight:400,preview_text:"BEBAS NEUE",available:!0},{id:"montserrat-extrabold",name:"Montserrat ExtraBold",family:"Montserrat",script:"latin",style:"extrabold",weight:800,preview_text:"MONTSERRAT",available:!0},{id:"poppins-black",name:"Poppins Black",family:"Poppins",script:"latin",style:"bold",weight:900,preview_text:"IMPACT TEXT",available:!0},{id:"oswald-bold",name:"Oswald Bold",family:"Oswald",script:"latin",style:"bold",weight:700,preview_text:"OSWALD BOLD",available:!0},{id:"baloo2-extrabold",name:"Baloo 2 ExtraBold",family:"Baloo 2",script:"both",style:"extrabold",weight:800,preview_text:"Baloo ",available:!0},{id:"tiro-devanagari-hindi",name:"Tiro Devanagari Hindi",family:"Tiro Devanagari Hindi",script:"devanagari",style:"regular",weight:400,preview_text:" ",available:!0},{id:"noto-sans-devanagari-regular",name:"Noto Sans Devanagari Regular",family:"Noto Sans Devanagari",script:"devanagari",style:"regular",weight:400,preview_text:" ",available:!0}];function _a({value:i,onChange:e,scriptFilter:t}){const{data:s}=xe({queryKey:["fonts",t],queryFn:()=>qt.fonts(t),staleTime:6e5}),r=(s==null?void 0:s.data)||yf;return a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Font"}),a.jsx("select",{value:i,onChange:n=>{const o=r.find(l=>l.id===n.target.value);e(n.target.value,(o==null?void 0:o.family)||"Poppins")},className:"input-field text-sm",children:r.map(n=>{const o=ja[n.script];return a.jsxs("option",{value:n.id,children:[n.name," ",o?`[${o.label}]`:""," ",n.available?"":"(download needed)"]},n.id)})}),(()=>{const n=r.find(l=>l.id===i);if(!n)return null;const o=ja[n.script];return a.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[o&&a.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full font-medium ${o.color}`,children:o.label}),a.jsxs("span",{className:"text-xs text-gray-400",children:[n.style,"  ",n.weight]})]})})()]})}const bf={tech:"bg-blue-100 text-blue-700",reaction:"bg-red-100 text-red-700",unboxing:"bg-purple-100 text-purple-700",vlog:"bg-pink-100 text-pink-700",fitness:"bg-green-100 text-green-700",beauty:"bg-rose-100 text-rose-700",home:"bg-amber-100 text-amber-700",transformation:"bg-teal-100 text-teal-700",education:"bg-indigo-100 text-indigo-700",finance:"bg-emerald-100 text-emerald-700",business:"bg-slate-100 text-slate-700",tips:"bg-cyan-100 text-cyan-700",motivation:"bg-violet-100 text-violet-700",poetry:"bg-fuchsia-100 text-fuchsia-700",quotes:"bg-yellow-100 text-yellow-700",podcast:"bg-orange-100 text-orange-700",food:"bg-red-100 text-red-700",street_food:"bg-orange-100 text-orange-700",restaurant:"bg-amber-100 text-amber-700",recipe:"bg-lime-100 text-lime-700"},vf={shocked_face_arrow:"",before_after_split:"",text_heavy_listicle:"",minimal_gradient:"",food_closeup_badge:""};function wf({selected:i,onSelect:e}){const{data:t,isLoading:s}=xe({queryKey:["thumbnail-formulas"],queryFn:()=>qt.formulas(),staleTime:6e5}),r=(t==null?void 0:t.data)||[];return s?a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[1,2,3].map(n=>a.jsx("div",{className:"h-32 rounded-xl bg-gray-100 animate-pulse"},n))}):a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:r.map(n=>{const o=i===n.id;return a.jsxs(B.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e(n),className:`text-left p-4 rounded-xl border-2 transition-all ${o?"border-primary-500 bg-primary-50 shadow-md":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[a.jsx("span",{className:"text-2xl",children:vf[n.id]||""}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h4",{className:"font-semibold text-gray-900 text-sm leading-tight",children:n.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:n.name_hi})]})]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-2",children:n.description}),a.jsxs("div",{className:"bg-gray-50 rounded-lg px-2 py-1.5 mb-2",children:[a.jsxs("p",{className:"text-xs font-medium text-gray-800 hindi-text",children:['"',n.example_text,'"']}),a.jsx("p",{className:"text-[10px] text-gray-400",children:n.example_text_en})]}),a.jsx("div",{className:"flex flex-wrap gap-1 mb-1.5",children:n.niche.map(l=>a.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full font-medium ${bf[l]||"bg-gray-100 text-gray-600"}`,children:l},l))}),a.jsx("div",{className:"flex gap-1",children:n.suggested_emojis.map((l,c)=>a.jsx("span",{className:"text-sm",children:l},c))})]},n.id)})})}const Ca=[{key:"youtube",label:"YouTube (1280720)",w:1280,h:720},{key:"instagram",label:"Instagram (10801080)",w:1080,h:1080},{key:"story",label:"Story / Reel (10801920)",w:1080,h:1920}],jf=[{value:"youtube_standard",label:"YouTube Standard"},{value:"clickbait",label:"Clickbait"},{value:"youtube_minimal",label:"Minimal"},{value:"professional",label:"Professional"},{value:"educational",label:"Educational"},{value:"entertainment",label:"Entertainment"},{value:"instagram_reel",label:"Instagram Reel"}];function _f(){const i=Ft(),[e]=Rl(),t=k.useRef(null),[s,r]=k.useState("formula"),[n,o]=k.useState({w:1280,h:720,key:"youtube"}),[l,c]=k.useState("#1a1a2e"),[d,h]=k.useState(null),[u,g]=k.useState(!1),[p,m]=k.useState(null),[x,f]=k.useState("text"),[y,w]=k.useState({title:"",primary_text:"",secondary_text:"",style:e.get("style")||"youtube_standard",font_family:"poppins-extrabold",primary_color:"#FFFFFF",secondary_color:"#FFD700",background_color:"#1a1a2e",width:1280,height:720,generate_variants:3,output_sizes:["youtube","instagram"],enhance:!1}),j=Pe({mutationFn:C=>qt.generate(C),onSuccess:()=>{X.success(" 3 thumbnail variations submitted! Check back in ~30s."),i("/thumbnails")},onError:()=>{X.error("Failed to generate. Is the backend running?")}}),T=Pe({mutationFn:C=>qt.editorRender(C),onSuccess:C=>{var U;const M=C.data.outputs;X.success(` Rendered ${M.length} size(s)!`),(U=M[0])!=null&&U.url&&window.open(M[0].url,"_blank")},onError:()=>{X.error("Render failed. Check backend logs.")}}),A=k.useCallback(()=>{var C;(C=t.current)==null||C.addText("Your Text Here",{fontSize:72,fill:"#FFFFFF",stroke:"#000000",strokeWidth:3})},[]),P=k.useCallback(C=>{var M;(M=t.current)==null||M.addEmoji(C,.75,.1,80)},[]),N=k.useCallback(async C=>{var $,Q;const M=($=C.target.files)==null?void 0:$[0];if(!M)return;const U=URL.createObjectURL(M);await((Q=t.current)==null?void 0:Q.addImage(U))},[]),E=k.useCallback(async C=>{var $,Q;const M=($=C.target.files)==null?void 0:$[0];if(!M)return;const U=URL.createObjectURL(M);await((Q=t.current)==null?void 0:Q.setBackgroundImage(U))},[]),D=k.useCallback(()=>{const C=window.prompt('Describe your background (e.g., "neon city lights, dark gradient")');C&&(w(M=>({...M,ai_background_prompt:C})),r("quick"),X.success("AI prompt set! Switch to Quick Generate to create."))},[]),R=k.useCallback(C=>{if(h(C.id),w(M=>({...M,formula_id:C.id,primary_text:C.example_text,secondary_text:C.example_text_en})),t.current){const M=C.layout;M.gradient_colors&&c(M.gradient_colors[0]),t.current.addText(C.example_text,{fontSize:72,fill:"#FFFFFF",stroke:"#000000",strokeWidth:3})}X.success(`Applied "${C.name}" formula`)},[]),O=k.useCallback(()=>{var M;const C=(M=t.current)==null?void 0:M.getCanvasState();if(!C||C.layers.length===0){X.error("Canvas is empty  add some layers first");return}T.mutate({canvas_json:C,output_sizes:["youtube","instagram"],enhance:u})},[u,T]),W=k.useCallback(C=>{var M,U;if(C.preventDefault(),!y.title.trim()){X.error("Please enter a title/topic");return}j.mutate({...y,primary_text:((M=y.primary_text)==null?void 0:M.trim())||void 0,secondary_text:((U=y.secondary_text)==null?void 0:U.trim())||void 0,enhance:u})},[y,u,j]);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI Thumbnail Generator"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Create eye-catching thumbnails for YouTube & Instagram with Hindi text support"})]}),a.jsx(te,{to:"/thumbnails",className:"btn-secondary whitespace-nowrap",children:" Back"})]}),a.jsx("div",{className:"flex gap-2 border-b border-gray-200 pb-1",children:[{key:"formula",label:" Formula Picker",desc:"5 proven Indian formulas"},{key:"editor",label:" Canvas Editor",desc:"Drag & drop layers"},{key:"quick",label:" Quick Generate",desc:"AI-powered one-click"}].map(C=>a.jsxs("button",{onClick:()=>r(C.key),className:`px-4 py-2.5 rounded-t-lg text-sm font-medium transition-colors ${s===C.key?"bg-white border border-b-white border-gray-200 text-primary-600 -mb-[1px]":"text-gray-500 hover:text-gray-700"}`,children:[C.label,a.jsxs("span",{className:"hidden sm:inline text-xs text-gray-400 ml-1.5",children:[" ",C.desc]})]},C.key))}),a.jsxs(Qt,{mode:"wait",children:[s==="formula"&&a.jsxs(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"space-y-4",children:[a.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-xl p-4",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"5 Thumbnail Formulas That Work for Indian Niches"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Click a formula to auto-fill text & layout. Then switch to Canvas Editor or Quick Generate."})]}),a.jsx(wf,{selected:d,onSelect:R}),d&&a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>r("editor"),className:"btn-primary",children:"Open in Canvas Editor "}),a.jsx("button",{onClick:()=>r("quick"),className:"btn-secondary",children:"Quick Generate (3 AI variations)"})]})]},"formula"),s==="editor"&&a.jsx(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex gap-2 mb-3",children:Ca.map(C=>a.jsx("button",{onClick:()=>o({w:C.w,h:C.h,key:C.key}),className:`text-xs px-3 py-1.5 rounded-full border transition-colors ${n.key===C.key?"bg-primary-500 text-white border-primary-500":"border-gray-300 text-gray-600 hover:border-gray-400"}`,children:C.label},C.key))}),a.jsx("div",{className:"bg-gray-100 rounded-xl p-4 border border-gray-200",children:a.jsx(Tl,{ref:t,width:n.w,height:n.h,backgroundColor:l,onSelectionChange:m})}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[a.jsx("button",{onClick:A,className:"btn-secondary text-sm",children:"+ Text"}),a.jsxs("label",{className:"btn-secondary text-sm cursor-pointer",children:["+ Image",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:N})]}),a.jsxs("label",{className:"btn-secondary text-sm cursor-pointer",children:[" Background",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:E})]}),a.jsx("button",{onClick:D,className:"btn-secondary text-sm",children:" AI Background"}),a.jsx("div",{className:"flex-1"}),a.jsx("button",{onClick:()=>{var C;return(C=t.current)==null?void 0:C.deleteSelected()},className:"btn-secondary text-sm text-red-600 hover:text-red-700",disabled:!p,children:" Delete"}),a.jsx("button",{onClick:()=>{var C;return(C=t.current)==null?void 0:C.bringForward()},className:"btn-secondary text-sm",disabled:!p,children:""}),a.jsx("button",{onClick:()=>{var C;return(C=t.current)==null?void 0:C.sendBackward()},className:"btn-secondary text-sm",disabled:!p,children:""})]})]}),a.jsxs("div",{className:"w-full lg:w-72 space-y-4",children:[a.jsx("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[{key:"text",label:"Text"},{key:"stickers",label:"Stickers"},{key:"font",label:"Font"}].map(C=>a.jsx("button",{onClick:()=>f(C.key),className:`flex-1 text-xs py-1.5 rounded-md transition-colors ${x===C.key?"bg-white shadow-sm font-medium text-gray-900":"text-gray-500"}`,children:C.label},C.key))}),x==="text"&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Background Color"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{type:"color",value:l,onChange:C=>{var M;c(C.target.value),(M=t.current)==null||M.setBackgroundColor(C.target.value)},className:"w-10 h-8 rounded border border-gray-300 cursor-pointer"}),a.jsx("input",{type:"text",value:l,onChange:C=>{var M;c(C.target.value),(M=t.current)==null||M.setBackgroundColor(C.target.value)},className:"input-field text-xs flex-1"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Quick Colors"}),a.jsx("div",{className:"flex gap-1.5 flex-wrap",children:["#FFFFFF","#FFD700","#FF0000","#00FF00","#00BFFF","#FF6B35","#FF1493","#000000"].map(C=>a.jsx("button",{onClick:()=>{var M;return(M=t.current)==null?void 0:M.updateSelectedText({fill:C})},className:"w-7 h-7 rounded-full border-2 border-gray-200 hover:border-gray-400 transition-colors",style:{backgroundColor:C},title:C},C))})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"text-xs font-medium text-gray-500",children:" One-Click Enhance"}),a.jsx("button",{onClick:()=>g(!u),className:`relative w-10 h-5 rounded-full transition-colors ${u?"bg-primary-500":"bg-gray-300"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${u?"translate-x-5":"translate-x-0.5"}`})})]})]}),x==="stickers"&&a.jsx(xf,{onEmojiClick:P}),x==="font"&&a.jsx(_a,{value:y.font_family||"poppins-extrabold",onChange:(C,M)=>{var U;w($=>({...$,font_family:C})),(U=t.current)==null||U.updateSelectedText({fontFamily:`${M}, Noto Sans Devanagari, sans-serif`})}}),a.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[a.jsx("button",{onClick:O,disabled:T.isPending,className:"btn-primary w-full",children:T.isPending?"Rendering":" Render (YouTube + Instagram)"}),a.jsx("p",{className:"text-[10px] text-gray-400 text-center",children:"Server-side render at both 1280720 + 10801080"})]})]})]})},"editor"),s==="quick"&&a.jsx(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:a.jsx("form",{onSubmit:W,className:"space-y-6 max-w-3xl",children:a.jsxs(B.div,{className:"bg-white rounded-xl border border-gray-200 p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Video Title / Topic ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{value:y.title,onChange:C=>w({...y,title:C.target.value}),placeholder:"e.g., 5 Tips for Better Thumbnails",className:"input-field",required:!0})]}),a.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Text (Hindi/English)"}),a.jsx("input",{value:y.primary_text||"",onChange:C=>w({...y,primary_text:C.target.value}),placeholder:"e.g., 999  iPhone?!",className:"input-field hindi-text"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Text"}),a.jsx("input",{value:y.secondary_text||"",onChange:C=>w({...y,secondary_text:C.target.value}),placeholder:"e.g., Flipkart Sale LIVE",className:"input-field"})]})]}),a.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Style"}),a.jsx("select",{value:y.style||"youtube_standard",onChange:C=>w({...y,style:C.target.value}),className:"input-field",children:jf.map(C=>a.jsx("option",{value:C.value,children:C.label},C.value))})]}),a.jsx("div",{children:a.jsx(_a,{value:y.font_family||"poppins-extrabold",onChange:C=>w({...y,font_family:C})})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Variants"}),a.jsx("input",{type:"number",min:1,max:5,value:y.generate_variants??3,onChange:C=>w({...y,generate_variants:Number(C.target.value||3)}),className:"input-field"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Primary Color"}),a.jsx("input",{type:"color",value:y.primary_color||"#FFFFFF",onChange:C=>w({...y,primary_color:C.target.value}),className:"w-full h-9 rounded border border-gray-300 cursor-pointer"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Secondary Color"}),a.jsx("input",{type:"color",value:y.secondary_color||"#FFD700",onChange:C=>w({...y,secondary_color:C.target.value}),className:"w-full h-9 rounded border border-gray-300 cursor-pointer"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Background Color"}),a.jsx("input",{type:"color",value:y.background_color||"#1a1a2e",onChange:C=>w({...y,background_color:C.target.value}),className:"w-full h-9 rounded border border-gray-300 cursor-pointer"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" AI Background Prompt (DALL-E 3)"}),a.jsx("input",{value:y.ai_background_prompt||"",onChange:C=>w({...y,ai_background_prompt:C.target.value}),placeholder:"e.g., neon cyber city, dark gradient with orange accents",className:"input-field"}),a.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:"Leave blank to use solid/gradient background color"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Output Sizes"}),a.jsx("div",{className:"flex gap-3",children:Ca.map(C=>{const M=(y.output_sizes||[]).includes(C.key);return a.jsxs("label",{className:"flex items-center gap-1.5 text-sm",children:[a.jsx("input",{type:"checkbox",checked:M,onChange:()=>{const U=y.output_sizes||[],$=M?U.filter(Q=>Q!==C.key):[...U,C.key];w({...y,output_sizes:$})},className:"rounded border-gray-300"}),C.label]},C.key)})})]}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:()=>g(!u),className:"rounded border-gray-300"})," One-click enhance (auto-contrast + face brightening)"]}),d&&a.jsxs("span",{className:"text-xs text-primary-600 bg-primary-50 px-2 py-1 rounded-full",children:["Formula: ",d]})]}),a.jsx("div",{className:"flex items-center justify-end gap-3 pt-2",children:a.jsx("button",{type:"submit",className:"btn-primary",disabled:j.isPending,children:j.isPending?"Generating 3 variations":" Generate 3 Thumbnail Variations"})}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Generates ",y.generate_variants||3," variations at"," ",(y.output_sizes||["youtube","instagram"]).join(" + ")," sizes.",y.ai_background_prompt&&" Using DALL-E 3 for background."]})]})})},"quick")]})]})}const Sa={curiosity_gap:{bg:"bg-purple-100",text:"text-purple-700",icon:""},contrarian:{bg:"bg-red-100",text:"text-red-700",icon:""},relatable_struggle:{bg:"bg-blue-100",text:"text-blue-700",icon:""},numbers_list:{bg:"bg-green-100",text:"text-green-700",icon:""},direct_address:{bg:"bg-orange-100",text:"text-orange-700",icon:""}};function Cf(i){return i>=90?"#22c55e":i>=75?"#f59e0b":i>=60?"#f97316":"#ef4444"}function Sf({hook:i,index:e,onVote:t,onCopy:s,showABControls:r=!0}){const[n,o]=k.useState(!1),[l,c]=k.useState(null),[d,h]=k.useState(!1),u=Dl(0),g=ir(u,[-200,0,200],[-15,0,15]),p=ir(u,[-200,-50,0],[1,.5,0]),m=ir(u,[0,50,200],[0,.5,1]),x=Sa[i.hook_type]||Sa.curiosity_gap,f=Cf(i.predicted_score),y=2*Math.PI*22,w=y-i.predicted_score/100*y,j=()=>{const N=n&&i.text_hindi?i.text_hindi:i.text;navigator.clipboard.writeText(N),X.success("Copied to clipboard! "),s==null||s(N),i.id&&Kt.trackUsage(i.id).catch(()=>{})},T=async N=>{if(!(!i.id||l)){c(N),t==null||t(i.id,N);try{await Kt.vote(i.id,{result:N}),X.success(N==="worked"?" Marked as worked!":" Marked as failed")}catch{X.error("Could not record vote")}}},A=(N,E)=>{if(Math.abs(E.offset.x)>120){const D=E.offset.x>0?"worked":"failed";h(!0),T(D)}},P=n&&i.text_hindi?i.text_hindi:i.text;return a.jsx(Qt,{children:!d&&a.jsxs(B.div,{initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,x:l==="worked"?300:-300,rotate:l==="worked"?20:-20},transition:{delay:e*.08,type:"spring",stiffness:300,damping:25},style:{x:u,rotate:g},drag:r?"x":!1,dragConstraints:{left:0,right:0},dragElastic:.7,onDragEnd:A,className:"relative select-none",children:[r&&a.jsxs(a.Fragment,{children:[a.jsx(B.div,{style:{opacity:m},className:"absolute inset-0 bg-green-100 rounded-xl z-0 pointer-events-none flex items-center justify-end pr-6",children:a.jsx("span",{className:"text-green-600 font-bold text-lg",children:" Worked"})}),a.jsx(B.div,{style:{opacity:p},className:"absolute inset-0 bg-red-100 rounded-xl z-0 pointer-events-none flex items-center pl-6",children:a.jsx("span",{className:"text-red-600 font-bold text-lg",children:" Failed"})})]}),a.jsxs("div",{className:"relative z-10 bg-white rounded-xl border border-gray-200 p-5 shadow-sm hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:"flex-shrink-0 relative w-14 h-14",children:[a.jsxs("svg",{className:"w-14 h-14 -rotate-90",viewBox:"0 0 50 50",children:[a.jsx("circle",{cx:"25",cy:"25",r:"22",fill:"none",stroke:"#e5e7eb",strokeWidth:"3"}),a.jsx("circle",{cx:"25",cy:"25",r:"22",fill:"none",stroke:f,strokeWidth:"3",strokeLinecap:"round",strokeDasharray:y,strokeDashoffset:w})]}),a.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-sm font-bold",style:{color:f},children:Math.round(i.predicted_score)})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-gray-900 font-medium text-lg leading-snug",children:P}),i.text_english&&i.text!==i.text_english&&a.jsx("p",{className:"text-sm text-gray-400 mt-1 italic",children:n?i.text:i.text_english}),a.jsxs("p",{className:"text-xs text-gray-400 mt-2 leading-relaxed",children:[" ",i.predicted_reasoning]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:[a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium ${x.bg} ${x.text}`,children:[x.icon," ",i.hook_type_label||i.hook_type.replace("_"," ")]}),a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 text-xs rounded-full",children:i.platform==="reel"?" Reel":i.platform==="short"?" Short":" Both"}),i.times_tested>0&&a.jsxs("span",{className:"px-2 py-1 bg-amber-50 text-amber-700 text-xs rounded-full",children:[i.ab_score!=null?`${i.ab_score}% win`:"","  ",i.times_tested," tested"]})]})]}),a.jsxs("div",{className:"flex flex-col gap-1.5",children:[a.jsx("button",{onClick:j,className:"p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Copy hook",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),i.text_hindi&&a.jsx("button",{onClick:()=>o(!n),className:"p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors text-xs font-bold",title:"Toggle Hindi/English",children:n?"EN":""})]})]}),r&&!l&&i.id&&a.jsxs("div",{className:"flex gap-2 mt-4 pt-3 border-t border-gray-100",children:[a.jsx("button",{onClick:()=>T("worked"),className:"flex-1 py-2 text-sm font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:" Worked"}),a.jsx("button",{onClick:()=>T("failed"),className:"flex-1 py-2 text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:" Didn't Work"})]}),l&&a.jsxs("div",{className:`mt-4 pt-3 border-t border-gray-100 text-center text-sm font-medium ${l==="worked"?"text-green-600":"text-red-600"}`,children:[l==="worked"?" Marked as worked!":" Marked as failed","  Thanks for voting!"]}),r&&!l&&i.id&&a.jsx("p",{className:"text-[10px] text-gray-300 text-center mt-2",children:" Swipe left = failed  Swipe right = worked "})]})]})})}const kf={curiosity_gap:"",contrarian:"",relatable_struggle:"",numbers_list:"",direct_address:""};function Nf({score:i,tested:e}){return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:a.jsx(B.div,{initial:{width:0},animate:{width:`${i}%`},transition:{duration:.6,ease:"easeOut"},className:`h-full rounded-full ${i>=75?"bg-green-500":i>=50?"bg-amber-500":"bg-red-400"}`})}),a.jsxs("span",{className:"text-xs font-mono text-gray-500 w-16 text-right",children:[i,"% (",e,")"]})]})}function Tf(){var r,n;const{data:i,isLoading:e}=xe({queryKey:["hook-leaderboard"],queryFn:()=>Kt.leaderboard(20)}),t=((r=i==null?void 0:i.data)==null?void 0:r.entries)||[],s=((n=i==null?void 0:i.data)==null?void 0:n.total_votes)||0;return e?a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:a.jsx("div",{className:"animate-pulse space-y-3",children:[...Array(5)].map((o,l)=>a.jsx("div",{className:"h-16 bg-gray-100 rounded-lg"},l))})}):a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:" Community Leaderboard"}),a.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Hooks ranked by real creator results"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:"text-2xl font-bold text-amber-600",children:s.toLocaleString()}),a.jsx("p",{className:"text-xs text-gray-400",children:"total votes"})]})]})}),t.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-400",children:[a.jsx("p",{className:"text-4xl mb-2",children:""}),a.jsx("p",{className:"font-medium",children:"No votes yet"}),a.jsx("p",{className:"text-sm mt-1",children:"Generate hooks and mark which ones worked to build the leaderboard!"})]}):a.jsx("div",{className:"divide-y divide-gray-100",children:t.map((o,l)=>a.jsx(B.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:l*.05},className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:`flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold ${l===0?"bg-amber-400 text-white":l===1?"bg-gray-300 text-white":l===2?"bg-amber-600 text-white":"bg-gray-100 text-gray-500"}`,children:l+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-gray-900 font-medium text-sm leading-snug truncate",children:o.text}),a.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[a.jsxs("span",{className:"text-xs text-gray-400",children:[kf[o.hook_type]||""," ",o.hook_type.replace("_"," ")]}),a.jsx("span",{className:"text-gray-300",children:""}),a.jsx("span",{className:"text-xs text-gray-400",children:o.category})]}),a.jsx("div",{className:"mt-2",children:a.jsx(Nf,{score:o.ab_score,tested:o.times_tested})})]})]})},o.id))})]})}const Of=[{id:"all",label:"All Templates",icon:""},{id:"curiosity_gap",label:"Curiosity Gap",icon:""},{id:"contrarian",label:"Contrarian",icon:""},{id:"relatable_struggle",label:"Relatable",icon:""},{id:"numbers_list",label:"Numbers / Lists",icon:""},{id:"direct_address",label:"Direct Address",icon:""}];function Ef({onUseTemplate:i}){var l;const[e,t]=k.useState("all"),{data:s,isLoading:r}=xe({queryKey:["hook-templates",e],queryFn:()=>Kt.templates(e==="all"?{}:{hook_type:e})}),n=((l=s==null?void 0:s.data)==null?void 0:l.items)||[],o=c=>{navigator.clipboard.writeText(c),X.success("Template copied!"),i==null||i(c)};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:Of.map(c=>a.jsxs("button",{onClick:()=>t(c.id),className:`flex-shrink-0 px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${e===c.id?"bg-primary-500 text-white border-primary-500":"border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[c.icon," ",c.label]},c.id))}),r?a.jsx("div",{className:"grid gap-3",children:[...Array(4)].map((c,d)=>a.jsx("div",{className:"h-20 bg-gray-100 animate-pulse rounded-lg"},d))}):n.length===0?a.jsx("p",{className:"text-center text-gray-400 py-8",children:"No templates match filter"}):a.jsx("div",{className:"grid gap-3",children:n.map((c,d)=>a.jsx(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:d*.04},className:"bg-gray-50 rounded-lg p-4 group hover:bg-gray-100 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-gray-900 font-medium text-sm",children:c.text}),c.text_hindi&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c.text_hindi}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white border border-gray-200 text-gray-500",children:c.hook_type_label}),a.jsx("span",{className:"text-[10px] text-gray-400",children:c.category}),a.jsx("span",{className:"text-[10px] text-gray-400",children:c.platform==="reel"?"":c.platform==="short"?"":""})]})]}),a.jsx("button",{onClick:()=>o(c.text),className:"p-2 text-gray-300 group-hover:text-primary-500 transition-colors",title:"Copy template",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})},c.id))}),a.jsx("p",{className:"text-[10px] text-gray-300 text-center",children:"20 templates based on top 100 Indian creators' viral patterns"})]})}const Df=[{value:"lifestyle",label:"Lifestyle",icon:""},{value:"education",label:"Education",icon:""},{value:"entertainment",label:"Entertainment",icon:""},{value:"motivation",label:"Motivation",icon:""},{value:"business",label:"Business",icon:""},{value:"food",label:"Food",icon:""},{value:"fitness",label:"Fitness",icon:""},{value:"tech",label:"Tech",icon:""},{value:"finance",label:"Finance",icon:""},{value:"travel",label:"Travel",icon:""}];function Af(){var g;const[i,e]=k.useState("generate"),[t,s]=k.useState({topic:"",target_audience:"",platform:"reel",language:"hinglish",category:"lifestyle",count:5}),[r,n]=k.useState([]),{data:o}=xe({queryKey:["hook-types"],queryFn:()=>Kt.types()}),l=((g=o==null?void 0:o.data)==null?void 0:g.types)||[],c=Pe({mutationFn:p=>Kt.generate(p),onSuccess:p=>{const m=p.data;n(m.hooks),X.success(` ${m.hooks.length} hooks generated!`)},onError:()=>{X.error("Failed to generate hooks. Is the backend running?")}}),d=p=>{if(p.preventDefault(),!t.topic.trim()){X.error("Enter a topic first!");return}c.mutate(t)},h=(p,m)=>{n(x=>x.map(f=>{if(f.id===p){const y=f.times_tested+1,w=f.times_worked+(m==="worked"?1:0),j=f.times_failed+(m==="failed"?1:0);return{...f,times_tested:y,times_worked:w,times_failed:j,ab_score:y>0?Math.round(w/y*100):null}}return f}))},u=r.length>0?Math.round(r.reduce((p,m)=>p+m.predicted_score,0)/r.length):0;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Hook Generator"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"The most critical 3 seconds of any reel. Generate scroll-stopping hooks for Indian audiences."})]}),a.jsx("div",{className:"flex gap-1 bg-gray-100 rounded-xl p-1 max-w-lg",children:[{key:"generate",label:" Generate",desc:"AI-powered hooks"},{key:"templates",label:" Templates",desc:"20 proven formulas"},{key:"leaderboard",label:" Leaderboard",desc:"Community votes"}].map(p=>a.jsx("button",{onClick:()=>e(p.key),className:`flex-1 py-2.5 px-3 rounded-lg text-sm font-medium transition-all ${i===p.key?"bg-white shadow-sm text-gray-900":"text-gray-500 hover:text-gray-700"}`,children:p.label},p.key))}),a.jsxs(Qt,{mode:"wait",children:[i==="generate"&&a.jsx(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:a.jsxs("div",{className:"grid lg:grid-cols-5 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[a.jsxs("form",{onSubmit:d,className:"space-y-4",children:[a.jsxs(B.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-5",children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["What's your reel about? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:t.topic,onChange:p=>s({...t,topic:p.target.value}),placeholder:"e.g., Morning routine tips for students, Best street food in Delhi under 100",className:"input-field min-h-[90px] text-sm",required:!0})]}),a.jsxs(B.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.05},className:"bg-white rounded-xl border border-gray-200 p-5",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Target Audience"}),a.jsx("input",{value:t.target_audience,onChange:p=>s({...t,target_audience:p.target.value}),placeholder:"e.g., Delhi college students, small business owners, homemakers 30-45",className:"input-field text-sm"})]}),a.jsxs(B.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl border border-gray-200 p-5",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Category"}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:Df.map(p=>a.jsxs("button",{type:"button",onClick:()=>s({...t,category:p.value}),className:`p-2 rounded-lg border text-center transition-all text-xs ${t.category===p.value?"border-primary-500 bg-primary-50 text-primary-700 font-medium":"border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[a.jsx("span",{className:"block text-base",children:p.icon}),p.label]},p.value))})]}),a.jsx(B.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.15},className:"bg-white rounded-xl border border-gray-200 p-5",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5",children:"Platform"}),a.jsx("div",{className:"flex gap-2",children:[{value:"reel",label:" Reel"},{value:"short",label:" Short"}].map(p=>a.jsx("button",{type:"button",onClick:()=>s({...t,platform:p.value}),className:`flex-1 py-2 rounded-lg text-xs font-medium border transition-colors ${t.platform===p.value?"bg-primary-500 text-white border-primary-500":"border-gray-200 text-gray-600"}`,children:p.label},p.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5",children:"Language"}),a.jsxs("select",{value:t.language,onChange:p=>s({...t,language:p.target.value}),className:"input-field text-sm",children:[a.jsx("option",{value:"hinglish",children:"Hinglish"}),a.jsx("option",{value:"hi",children:""}),a.jsx("option",{value:"en",children:"English"})]})]})]})}),a.jsx("button",{type:"submit",disabled:!t.topic.trim()||c.isPending,className:"btn-primary w-full py-3 text-base disabled:opacity-50",children:c.isPending?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating 5 Hooks..."]}):" Generate 5 Hook Variations"})]}),l.length>0&&a.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border border-gray-200 p-5",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"5 Hook Types That Work"}),a.jsx("div",{className:"space-y-2.5",children:l.map(p=>a.jsxs("div",{className:"text-xs",children:[a.jsx("span",{className:"font-medium text-gray-700",children:p.label_en}),a.jsxs("span",{className:"text-gray-400 ml-1",children:["(",p.label_hi,")"]}),a.jsx("p",{className:"text-gray-400 mt-0.5 italic",children:p.description})]},p.id))})]})]}),a.jsx("div",{className:"lg:col-span-3 space-y-4",children:r.length>0?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-gradient-to-r from-primary-50 to-accent-50 rounded-xl border border-primary-200 p-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:[r.length," Hooks Generated"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Swipe right = worked, left = didn't work"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:"text-2xl font-bold text-primary-600",children:u}),a.jsx("p",{className:"text-xs text-gray-400",children:"avg score"})]})]}),a.jsx("div",{className:"space-y-4",children:r.map((p,m)=>a.jsx(Sf,{hook:p,index:m,onVote:h,showABControls:!0},p.id||`hook-${m}`))})]}):a.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[a.jsx("p",{className:"text-6xl mb-4",children:""}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Generate your first hooks"}),a.jsx("p",{className:"text-gray-500 mt-2 max-w-sm mx-auto",children:"Enter a topic on the left, pick your audience & platform, and we'll create 5 scroll-stopping hooks with AI performance predictions."}),a.jsx("div",{className:"mt-6 flex flex-wrap justify-center gap-2",children:["Curiosity Gap","Contrarian","Relatable","Numbers","Direct Address"].map(p=>a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-500 text-xs rounded-full",children:p},p))})]})})]})},"generate"),i==="templates"&&a.jsxs(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"max-w-3xl",children:[a.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-xl p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"20 Proven Hook Templates for Indian Audiences"}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Analysed from top 100 Indian creators  Dhruv Rathee, Kusha Kapila, Warikoo, Beer Biceps, Technical Guruji, and more. Copy any template and fill in the ","{placeholders}","."]})]}),a.jsx(Ef,{onUseTemplate:p=>{s({...t,topic:p}),e("generate")}})]},"templates"),i==="leaderboard"&&a.jsx(B.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"max-w-3xl",children:a.jsx(Tf,{})},"leaderboard")]}),a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gradient-to-r from-accent-500 to-accent-600 rounded-xl p-6 text-white",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:" The First 3 Seconds Rule"}),a.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium",children:"Create a Gap"}),a.jsx("p",{className:"text-sm text-accent-100 mt-1",children:"Make them NEED to know what comes next"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium",children:"Be Specific"}),a.jsxs("p",{className:"text-sm text-accent-100 mt-1",children:["500, 3 tips, Delhi  specifics ",">"," generic"]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium",children:"Speak Their Language"}),a.jsx("p",{className:"text-sm text-accent-100 mt-1",children:"Hinglish converts 2x better than pure English"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium",children:"Test & Track"}),a.jsx("p",{className:"text-sm text-accent-100 mt-1",children:"Use A/B voting to learn what actually works"})]})]})]})]})}function Mf(){const[i,e]=k.useState({status:"",search:"",page:1}),[t,s]=k.useState(!1),r=Na(),{data:n,isLoading:o,error:l}=xe({queryKey:["projects",i],queryFn:()=>Dn.list(i)}),c=Pe({mutationFn:h=>Dn.create(h),onSuccess:()=>{X.success("Project created!"),s(!1),r.invalidateQueries({queryKey:["projects"]})},onError:()=>{X.error("Failed to create project")}}),d=(n==null?void 0:n.data)||[];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Projects"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Organize your content in projects"})]}),a.jsxs("button",{onClick:()=>s(!0),className:"btn-primary whitespace-nowrap",children:[a.jsx("span",{className:"mr-2",children:"+"}),"New Project"]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:a.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),a.jsx("input",{type:"text",value:i.search,onChange:h=>e({...i,search:h.target.value,page:1}),placeholder:"Search projects...",className:"input-field"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:i.status,onChange:h=>e({...i,status:h.target.value,page:1}),className:"input-field",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"archived",children:"Archived"})]})]})]})}),o?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"}),a.jsx("p",{className:"text-gray-500 mt-4",children:"Loading projects..."})]}):l?a.jsx("div",{className:"text-center py-12 bg-white rounded-xl border border-red-200",children:a.jsx("p",{className:"text-red-600",children:"Failed to load projects. Please try again."})}):d.length===0?a.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[a.jsx("div",{className:"text-5xl mb-4",children:""}),a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No projects yet"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Create your first project to organize your content"}),a.jsx("button",{onClick:()=>s(!0),className:"btn-primary inline-block mt-4",children:"Create Project"})]}):a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map((h,u)=>a.jsx(Pf,{project:h,index:u},h.id))}),t&&a.jsx(Ff,{onClose:()=>s(!1),onCreate:h=>c.mutate(h),isLoading:c.isPending})]})}function Pf({project:i,index:e}){const t={active:"bg-green-100 text-green-700",completed:"bg-blue-100 text-blue-700",archived:"bg-gray-100 text-gray-700"};return a.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.05},children:a.jsxs(te,{to:`/projects/${i.id}`,className:"block bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"aspect-video bg-gradient-to-br from-primary-100 to-secondary-100 rounded-lg mb-4 flex items-center justify-center",children:i.cover_image_url?a.jsx("img",{src:i.cover_image_url,alt:i.name,className:"w-full h-full object-cover rounded-lg"}):a.jsx("span",{className:"text-4xl",children:""})}),a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:i.name}),a.jsx("span",{className:`px-2 py-1 text-xs rounded-full capitalize ${t[i.status]||"bg-gray-100 text-gray-700"}`,children:i.status})]}),i.description&&a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:i.description}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.scripts_count," scripts"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),i.captions_count," captions"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),i.thumbnails_count]})]}),i.tags&&i.tags.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 mt-3",children:[i.tags.slice(0,3).map((s,r)=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:s},r)),i.tags.length>3&&a.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",i.tags.length-3]})]})]})})}function Ff({onClose:i,onCreate:e,isLoading:t}){const[s,r]=k.useState(""),[n,o]=k.useState(""),[l,c]=k.useState(""),d=h=>{if(h.preventDefault(),!s.trim()){X.error("Please enter a project name");return}e({name:s,description:n||void 0,category:l||void 0})};return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:i}),a.jsxs(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Create New Project"}),a.jsxs("form",{onSubmit:d,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:s,onChange:h=>r(h.target.value),placeholder:"My Awesome Project",className:"input-field",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:n,onChange:h=>o(h.target.value),placeholder:"Brief description of your project...",className:"input-field",rows:3})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:l,onChange:h=>c(h.target.value),className:"input-field",children:[a.jsx("option",{value:"",children:"Select a category"}),a.jsx("option",{value:"entertainment",children:"Entertainment"}),a.jsx("option",{value:"education",children:"Education"}),a.jsx("option",{value:"business",children:"Business"}),a.jsx("option",{value:"lifestyle",children:"Lifestyle"}),a.jsx("option",{value:"food",children:"Food"}),a.jsx("option",{value:"fitness",children:"Fitness"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:t,className:"btn-primary disabled:opacity-50",children:t?"Creating...":"Create Project"})]})]})]})]})}function Lf(){const i=Ft(),e=at(r=>r.user),t=at(r=>r.logout),s=()=>{t(),X.success("Logged out"),i("/login")};return a.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account details"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Name"}),a.jsx("span",{className:"font-medium text-gray-900",children:e.full_name})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Email"}),a.jsx("span",{className:"font-medium text-gray-900",children:e.email})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Language"}),a.jsx("span",{className:"font-medium text-gray-900 capitalize",children:e.preferred_language})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Plan"}),a.jsx("span",{className:"font-medium text-gray-900 capitalize",children:e.subscription_tier})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Credits"}),a.jsx("span",{className:"font-medium text-gray-900",children:e.credits_remaining})]})]}):a.jsx("div",{className:"text-gray-600",children:"Profile details will appear here after you log in."}),a.jsx("div",{className:"flex items-center justify-end pt-6",children:a.jsx("button",{type:"button",onClick:s,className:"btn-secondary",children:"Logout"})})]})]})}const ka=[{value:"hi",label:"Hindi",labelNative:"",example:" !    ..."},{value:"en",label:"English",labelNative:"English",example:"Hey everyone! Today we're talking about..."},{value:"hinglish",label:"Hinglish",labelNative:"",example:"Aaj main aapko bataunga ek amazing trick..."}],Rf=[{value:"reel",label:"Instagram Reel",icon:"",description:"Vertical video, 15-90 sec"},{value:"short",label:"YouTube Short",icon:"",description:"Vertical video, up to 60 sec"},{value:"ad",label:"Product Promo",icon:"",description:"Promotional content"},{value:"educational",label:"Educational",icon:"",description:"Teach something valuable"}],If=[{value:"funny",label:"Funny",labelHi:"",emoji:""},{value:"professional",label:"Professional",labelHi:"",emoji:""},{value:"trendy",label:"Trendy",labelHi:"",emoji:""}],Bf=[{value:15,label:"15 sec"},{value:30,label:"30 sec"},{value:60,label:"60 sec"}],Hf=[{topic:"Cafe promotion for a new coffee shop in Mumbai",category:"business"},{topic:"Fitness tips for busy office workers",category:"fitness"},{topic:"Diwali sale announcement for clothing brand",category:"festival"},{topic:"How to make perfect butter chicken at home",category:"food"},{topic:"Morning routine for students preparing for exams",category:"education"}];function zf(){var P;const[i,e]=k.useState(""),[t,s]=k.useState("hinglish"),[r,n]=k.useState("reel"),[o,l]=k.useState("trendy"),[c,d]=k.useState(30),[h,u]=k.useState(""),[g,p]=k.useState(!1),[m,x]=k.useState(null),[f,y]=k.useState("full"),w=Pe({mutationFn:N=>Rd.generate(N),onSuccess:N=>{X.success("Script generated successfully! ");const E=N.data;x({title:E.title,hook:E.hook||"",main_script:E.main_script||E.full_script,cta:E.cta||"",full_script:E.full_script,hooks:E.alternative_hooks||[],hashtags:E.hashtags||[],audio_suggestions:E.audio_suggestions||[],timing_breakdown:E.timing_breakdown||{}}),p(!0)},onError:()=>{X.error("Failed to generate script. Please try again.")}}),j=N=>{if(N.preventDefault(),!i.trim()){X.error("Please enter a topic");return}const E={topic:i,language:t,content_type:r,tone:o,duration_seconds:c,include_cultural_refs:!0,additional_instructions:h||void 0};w.mutate(E)},T=(N,E)=>{navigator.clipboard.writeText(N),X.success(`${E} copied!`)},A=N=>{e(N.topic)};return a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs(B.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"AI Script Generator"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Create viral scripts in Hindi, English, or Hinglish"}),a.jsx("p",{className:"text-sm text-primary-600 hindi-text mt-1",children:"    "})]}),a.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[a.jsx(B.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"space-y-6",children:a.jsxs("form",{onSubmit:j,className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:"Choose Language"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:ka.map(N=>a.jsxs("button",{type:"button",onClick:()=>s(N.value),className:`relative p-4 rounded-xl border-2 transition-all duration-200 ${t===N.value?"border-primary-500 bg-primary-50 ring-2 ring-primary-200":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[t===N.value&&a.jsx(B.div,{layoutId:"language-indicator",className:"absolute -top-2 -right-2 w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),a.jsx("div",{className:"text-xl font-bold text-gray-900 hindi-text",children:N.labelNative}),a.jsx("div",{className:"text-sm text-gray-500 mt-1",children:N.label})]},N.value))}),a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Example output:"}),a.jsxs("p",{className:`text-sm text-gray-700 mt-1 ${t==="hi"?"hindi-text":""}`,children:['"',(P=ka.find(N=>N.value===t))==null?void 0:P.example,'"']})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsxs("label",{className:"block text-lg font-semibold text-gray-900 mb-2",children:["What's your video about? ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:i,onChange:N=>e(N.target.value),placeholder:"e.g., New cafe promotion in Koramangala with Instagram-worthy ambience",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",rows:3,required:!0}),a.jsxs("div",{className:"mt-3",children:[a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Try an example:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Hf.slice(0,3).map((N,E)=>a.jsxs("button",{type:"button",onClick:()=>A(N),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-full transition-colors",children:[N.topic.slice(0,30),"..."]},E))})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:"Content Type"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:Rf.map(N=>a.jsxs("button",{type:"button",onClick:()=>n(N.value),className:`p-4 rounded-xl border-2 text-left transition-all ${r===N.value?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("span",{className:"text-2xl",children:N.icon}),a.jsx("div",{className:"font-medium text-gray-900 mt-2",children:N.label}),a.jsx("div",{className:"text-xs text-gray-500",children:N.description})]},N.value))})]}),a.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:"Tone"}),a.jsx("div",{className:"space-y-2",children:If.map(N=>a.jsxs("button",{type:"button",onClick:()=>l(N.value),className:`w-full p-3 rounded-lg border-2 flex items-center justify-between transition-all ${o===N.value?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-xl",children:N.emoji}),a.jsx("span",{className:"font-medium text-gray-900",children:N.label})]}),a.jsx("span",{className:"text-sm text-gray-500 hindi-text",children:N.labelHi})]},N.value))})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-4",children:"Duration"}),a.jsx("div",{className:"space-y-2",children:Bf.map(N=>a.jsx("button",{type:"button",onClick:()=>d(N.value),className:`w-full p-3 rounded-lg border-2 flex items-center justify-center transition-all ${c===N.value?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:a.jsx("span",{className:`font-bold text-xl ${c===N.value?"text-primary-600":"text-gray-700"}`,children:N.label})},N.value))}),a.jsxs("p",{className:"text-xs text-gray-500 mt-3 text-center",children:["~",Math.round(c*2.5)," words for natural speaking pace"]})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:[a.jsx("label",{className:"block text-lg font-semibold text-gray-900 mb-2",children:"Additional Instructions (Optional)"}),a.jsx("textarea",{value:h,onChange:N=>u(N.target.value),placeholder:"Any specific requirements like brand mentions, target audience details, or style preferences...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",rows:2})]}),a.jsx(B.button,{type:"submit",disabled:w.isPending,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-4 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:w.isPending?a.jsxs("span",{className:"flex items-center justify-center gap-3",children:[a.jsxs("svg",{className:"animate-spin h-6 w-6",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating your viral script..."]}):a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx("span",{children:""}),"Generate Script",a.jsx("span",{children:""})]})})]})}),a.jsx(B.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"lg:sticky lg:top-8 lg:self-start",children:a.jsx(Qt,{mode:"wait",children:g&&m?a.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-2xl border border-gray-200 shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-500 p-4",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:m.title}),a.jsxs("p",{className:"text-primary-100 text-sm mt-1",children:[t==="hi"?"":t==="hinglish"?"Hinglish":"English","  ",c,"s  ",o]})]}),a.jsx("div",{className:"flex border-b border-gray-200",children:["full","sections","extras"].map(N=>a.jsx("button",{onClick:()=>y(N),className:`flex-1 py-3 text-sm font-medium transition-colors ${f===N?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-700"}`,children:N==="full"?"Full Script":N==="sections"?"By Section":"Extras"},N))}),a.jsxs("div",{className:"p-5 max-h-[600px] overflow-y-auto",children:[f==="full"&&a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"relative",children:[a.jsx("pre",{className:`whitespace-pre-wrap text-gray-700 leading-relaxed ${t==="hi"?"hindi-text":""}`,children:m.full_script}),a.jsx("button",{onClick:()=>T(m.full_script,"Full script"),className:"absolute top-0 right-0 p-2 text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})}),f==="sections"&&a.jsxs("div",{className:"space-y-5",children:[a.jsx(ui,{title:" Hook (First 3 seconds)",content:m.hook,onCopy:()=>T(m.hook,"Hook"),highlight:"bg-yellow-50 border-yellow-200",language:t}),a.jsx(ui,{title:" Main Script",content:m.main_script,onCopy:()=>T(m.main_script,"Main script"),language:t}),a.jsx(ui,{title:" Call-to-Action",content:m.cta,onCopy:()=>T(m.cta,"CTA"),highlight:"bg-green-50 border-green-200",language:t})]}),f==="extras"&&a.jsxs("div",{className:"space-y-5",children:[m.hooks.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Alternative Hooks"}),a.jsx("div",{className:"space-y-2",children:m.hooks.map((N,E)=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex justify-between items-start gap-2",children:[a.jsxs("span",{className:`text-sm text-gray-700 ${t==="hi"?"hindi-text":""}`,children:[E+1,". ",N]}),a.jsx("button",{onClick:()=>T(N,"Hook"),className:"text-gray-400 hover:text-gray-600 flex-shrink-0",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]},E))})]}),m.hashtags.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"# Hashtags"}),a.jsx("button",{onClick:()=>T(m.hashtags.join(" "),"Hashtags"),className:"text-sm text-primary-600 hover:text-primary-700",children:"Copy all"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:m.hashtags.map((N,E)=>a.jsx("span",{className:"px-3 py-1 bg-primary-50 text-primary-700 text-sm rounded-full",children:N.startsWith("#")?N:`#${N}`},E))})]}),m.audio_suggestions.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Suggested Audio"}),a.jsx("div",{className:"space-y-2",children:m.audio_suggestions.map((N,E)=>a.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg flex items-center gap-3",children:[a.jsx("span",{className:"text-xl",children:""}),a.jsx("span",{className:"text-sm text-gray-700",children:N})]},E))})]}),Object.keys(m.timing_breakdown).length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Timing Guide"}),a.jsx("div",{className:"space-y-2",children:Object.entries(m.timing_breakdown).map(([N,E],D)=>a.jsxs("div",{className:"flex gap-3 text-sm",children:[a.jsx("span",{className:"font-mono text-primary-600 min-w-[60px]",children:N}),a.jsx("span",{className:"text-gray-600",children:E})]},D))})]})]})]}),a.jsxs("div",{className:"border-t border-gray-200 p-4 flex gap-3",children:[a.jsx("button",{onClick:()=>{p(!1),x(null)},className:"flex-1 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Generate Another"}),a.jsx("button",{onClick:()=>T(m.full_script,"Script"),className:"flex-1 py-2.5 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Copy Script"})]})]},"preview"):a.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300 p-12 text-center",children:[a.jsx("div",{className:"text-6xl mb-4",children:""}),a.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Your script will appear here"}),a.jsx("p",{className:"text-gray-500",children:"Fill out the form and click generate to create your viral script"}),a.jsxs("div",{className:"mt-8 grid gap-3 text-left",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-primary-600 font-medium",children:[a.jsx("span",{children:""})," Hook Example"]}),a.jsx("p",{className:"text-gray-700 mt-1 text-sm",children:'"Ye galti mat karna warna pura investment doob jayega!"'})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 font-medium",children:[a.jsx("span",{children:""})," CTA Example"]}),a.jsx("p",{className:"text-gray-700 mt-1 text-sm",children:'"Follow for more tips aur comment mein batao aapka favorite!"'})]})]})]},"placeholder")})})]})]})})}function ui({title:i,content:e,onCopy:t,highlight:s="",language:r}){return a.jsxs("div",{className:`p-4 rounded-lg border ${s||"bg-gray-50 border-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:i}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),a.jsx("p",{className:`text-gray-700 whitespace-pre-wrap ${r==="hi"?"hindi-text":""}`,children:e})]})}function Wf({children:i}){return at(t=>t.isAuthenticated)?a.jsx(a.Fragment,{children:i}):a.jsx(Aa,{to:"/login",replace:!0})}function Vf(){const i=Oa();return a.jsx(Qt,{mode:"wait",children:a.jsxs(Il,{location:i,children:[a.jsx(oe,{path:"/",element:a.jsx(Xu,{})}),a.jsx(oe,{path:"/home",element:a.jsx(Ju,{})}),a.jsxs(oe,{element:a.jsx(Yu,{}),children:[a.jsx(oe,{path:"/login",element:a.jsx(Qu,{})}),a.jsx(oe,{path:"/register",element:a.jsx(Zu,{})})]}),a.jsxs(oe,{element:a.jsx(Wf,{children:a.jsx($u,{})}),children:[a.jsx(oe,{path:"/dashboard",element:a.jsx(ag,{})}),a.jsx(oe,{path:"/scripts",element:a.jsx(ug,{})}),a.jsx(oe,{path:"/scripts/new",element:a.jsx(Ln,{})}),a.jsx(oe,{path:"/scripts/enhanced",element:a.jsx(zf,{})}),a.jsx(oe,{path:"/scripts/:id",element:a.jsx(Ln,{})}),a.jsx(oe,{path:"/captions",element:a.jsx(pg,{})}),a.jsx(oe,{path:"/captions/:id",element:a.jsx(fg,{})}),a.jsx(oe,{path:"/templates",element:a.jsx(yg,{})}),a.jsx(oe,{path:"/templates/:id",element:a.jsx(Cg,{})}),a.jsx(oe,{path:"/thumbnails",element:a.jsx(kg,{})}),a.jsx(oe,{path:"/thumbnails/new",element:a.jsx(_f,{})}),a.jsx(oe,{path:"/hooks",element:a.jsx(Af,{})}),a.jsx(oe,{path:"/projects",element:a.jsx(Mf,{})}),a.jsx(oe,{path:"/profile",element:a.jsx(Lf,{})})]}),a.jsx(oe,{path:"*",element:a.jsx(Aa,{to:"/",replace:!0})})]},i.pathname)})}const Uf=new Al({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});gi.createRoot(document.getElementById("root")).render(a.jsx(Ta.StrictMode,{children:a.jsx(Ml,{client:Uf,children:a.jsxs(Bl,{children:[a.jsx(Vf,{}),a.jsx(Nc,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1e293b",color:"#f1f5f9",border:"1px solid #334155"},success:{iconTheme:{primary:"#10b981",secondary:"#f1f5f9"}},error:{iconTheme:{primary:"#ef4444",secondary:"#f1f5f9"}}}})]})})}));
//# sourceMappingURL=index-D639Fbux.js.map
